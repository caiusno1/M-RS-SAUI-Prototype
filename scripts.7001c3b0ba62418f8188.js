!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){return i(e[s][1][t]||t)},u,u.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){(function(){"use strict";var e=t("../");"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="".__proto__===String.prototype?function(t){return t.__proto__}:function(t){return t.constructor.prototype}),"function"==typeof this.define&&this.define.amd?define([],function(){return e}):this.nools=e}).call("undefined"!=typeof window?window:this)},{"../":2}],2:[function(t,e,n){e.exports=t("./lib")},{"./lib":15}],3:[function(t,e,n){"use strict";var r=t("./extended"),i=r.declare,o=r.AVLTree,s=r.LinkedList,a=r.isPromiseLike,c=t("events").EventEmitter,u=i({instance:{constructor:function(){this.memory={},this.memoryValues=new s},clear:function(){this.memoryValues.clear(),this.memory={}},remove:function(t){var e=t.hashCode,n=this.memory,r=n[e];return r&&(this.memoryValues.remove(r),delete n[e]),r},insert:function(t){var e=t.hashCode;if(e in this.memory)throw new Error("Activation already in agenda "+t.rule.name+" agenda");this.memoryValues.push(this.memory[e]=t)}}}),h="main";e.exports=i(c,{instance:{constructor:function(t,e){this.agendaGroups={},this.agendaGroupStack=[h],this.rules={},this.flow=t,this.comparator=e,this.setFocus(h).addAgendaGroup(h)},addAgendaGroup:function(t){r.has(this.agendaGroups,t)||(this.agendaGroups[t]=new o({compare:this.comparator}))},getAgendaGroup:function(t){return this.agendaGroups[t||h]},setFocus:function(t){return t!==this.getFocused()&&this.agendaGroups[t]&&(this.agendaGroupStack.push(t),this.emit("focused",t)),this},getFocused:function(){var t=this.agendaGroupStack;return t[t.length-1]},getFocusedAgenda:function(){return this.agendaGroups[this.getFocused()]},register:function(t){var e=t.rule.agendaGroup;this.rules[t.name]={tree:new o({compare:this.comparator}),factTable:new u},e&&this.addAgendaGroup(e)},isEmpty:function(){for(var t=this.agendaGroupStack,e=!1;this.getFocusedAgenda().isEmpty()&&this.getFocused()!==h;)t.pop(),e=!0;return e&&this.emit("focused",this.getFocused()),this.getFocusedAgenda().isEmpty()},fireNext:function(){for(var t=this.agendaGroupStack,e=!1;this.getFocusedAgenda().isEmpty()&&this.getFocused()!==h;)t.pop();if(!this.getFocusedAgenda().isEmpty()){var n=this.pop();this.emit("fire",n.rule.name,n.match.factHash);var r=n.rule.fire(this.flow,n.match);e=!a(r)||r.then(function(){return!0})}return e},pop:function(){for(var t=this.getFocusedAgenda(),e=t.__root;e.right;)e=e.right;var n=e.data;t.remove(n);var r=this.rules[n.name];return r.tree.remove(n),r.factTable.remove(n),n},peek:function(){for(var t=this.getFocusedAgenda().__root;t.right;)t=t.right;return t.data},modify:function(t,e){this.retract(t,e),this.insert(t,e)},retract:function(t,e){var n=this.rules[t.name];e.rule=t;var r=n.factTable.remove(e);r&&(this.getAgendaGroup(t.rule.agendaGroup).remove(r),n.tree.remove(r))},insert:function(t,e){var n=this.rules[t.name],r=t.rule,i=r.agendaGroup;n.tree.insert(e),this.getAgendaGroup(i).insert(e),r.autoFocus&&this.setFocus(i),n.factTable.insert(e)},dispose:function(){for(var t in this.agendaGroups)this.agendaGroups[t].clear();var e=this.rules;for(t in e)t in e&&(e[t].tree.clear(),e[t].factTable.clear());this.rules={}}}})},{"./extended":12,events:60}],4:[function(require,module,exports){"use strict";var extd=require("../extended"),forEach=extd.forEach,isString=extd.isString;exports.modifiers=["assert","modify","retract","emit","halt","focus","getFacts"];var createFunction=function(body,defined,scope,scopeNames,definedNames){var declares=[];forEach(definedNames,function(t){-1!==body.indexOf(t)&&declares.push("var "+t+"= defined."+t+";")}),forEach(scopeNames,function(t){-1!==body.indexOf(t)&&declares.push("var "+t+"= scope."+t+";")}),body=["((function(){",declares.join(""),"\n\treturn ",body,"\n})())"].join("");try{return eval(body)}catch(e){throw new Error("Invalid action : "+body+"\n"+e.message)}},createDefined=function(t,e,n){return function(t,e,n){if(isString(t)){var r=[];extd(e).keys().forEach(function(e){-1!==t.indexOf(e)&&r.push("var "+e+"= defined."+e+";")}),extd(n).keys().forEach(function(e){-1!==t.indexOf(e)&&r.push("var "+e+"= function(){var prop = scope."+e+"; return __objToStr__.call(prop) === '[object Function]' ? prop.apply(void 0, arguments) : prop;};")}),r.length&&r.unshift("var __objToStr__ = Object.prototype.toString;"),t=[r.join(""),"return ",t,";"].join(""),t=new Function("defined","scope",t)(e,n)}var i=t.hasOwnProperty("constructor")&&"function"==typeof t.constructor?t.constructor:function(e){for(var n in e=e||{})n in t&&(this[n]=e[n])},o=i.prototype;for(var s in t)o[s]=t[s];return i}(t.properties,e,n)};exports.createFunction=createFunction,exports.createDefined=createDefined},{"../extended":12}],5:[function(t,e,n){var r=t("__browserify_Buffer").Buffer,i=t("../extended"),o=t("../parser"),s=t("../constraintMatcher.js"),a=i.indexOf,c=i.forEach,u=i.removeDuplicates,h=i.map,f=i.hash.keys,l=i.merge,p=t("../rule"),d=t("./common"),g=d.modifiers,_=d.createDefined,y=d.createFunction,v=function(){function t(n,r,i,o,s){if(n.length){var a=n[0];if("not"===a||"exists"===a){var h=[];n.shift(),e(n,i,h,o,s);var f=h[0];f.unshift(a),r.push(f)}else if("or"===a){var l=[a];n.shift(),c(n,function(e){t(e,l,i,o,s)}),r.push(l)}else e(n,i,r,o,s),i=u(i)}}var e=function(t,e,n,r,u){var h=[],f=t[0],l=t[1],p=t[2],d=t[3];if(i.isHash(p)&&(d=p,p=null),!f||!(f=r[f]))throw new Error("Invalid class "+t[0]+" for rule "+u);if(h.push(f),h.push(l,p,d),n.push(h),e.push(l),p&&c(s.getIdentifiers(o.parseConstraint(p)),function(t){e.push(t)}),i.isObject(d))for(var g in d){var _=d[g];-1===a(e,_)&&e.push(_)}};return function(e,n,r){var o=e.name;if(i.isEmpty(e))throw new Error("Rule is empty");var s=e.options||{};s.scope=r;var a=e.constraints||[];a.length||(a=["true"]);var u=e.action;if(i.isUndefined(u))throw new Error("No action was defined for rule "+o);var h=[],f=[];return c(a,function(e){t(e,h,f,n,o)}),p.createRule(o,s,h,function(t,e,n,r){var o=[];c(f,function(e){-1!==t.indexOf(e)&&o.push("var "+e+"= facts."+e+";")}),i(n).keys().forEach(function(e){-1!==t.indexOf(e)&&o.push("var "+e+"= defined."+e+";")}),i(r).keys().forEach(function(e){-1!==t.indexOf(e)&&o.push("var "+e+"= scope."+e+";")}),i(g).forEach(function(e){-1!==t.indexOf(e)&&o.push("if(!"+e+"){ var "+e+"= flow."+e+";}")});var s=["facts","flow"];/next\(.*\)/.test(t)&&s.push("next"),t=o.join("")+t;try{return new Function("defined, scope","return "+new Function(s.join(","),t).toString())(n,r)}catch(a){throw new Error("Invalid action : "+t+"\n"+a.message)}}(u,0,n,r))}}();n.parse=function(t,e){return o.parseRuleSet(t,e)},n.compile=function(t,e,n,o){i.isFunction(e)?(n=e,e={}):e=e||{};var s=t.name||e.name;if(!s)throw new Error("Name must be present in JSON or options");var a=new o(s),u=l({Array:Array,String:String,Number:Number,Boolean:Boolean,RegExp:RegExp,Date:Date,Object:Object},e.define||{});void 0!==r&&(u.Buffer=r);var p=l({console:console},e.scope);c(t.scope,function(t){p[t.name]=!0}),c(t.define,function(t){u[t.name]=_(t,u,p)}),i(u).forEach(function(t,e){a.addDefined(e,t)});var d=i(t.scope).pluck("name").union(i(p).keys().value()).value(),g=h(f(u),function(t){return t});c(t.scope,function(t){p[t.name]=y(t.body,u,p,d,g)});var m=t.rules;return m.length&&c(m,function(t){a.__rules=a.__rules.concat(v(t,u,p))}),n&&n.call(a,a),a},n.transpile=t("./transpile").transpile},{"../constraintMatcher.js":9,"../extended":12,"../parser":44,"../rule":49,"./common":4,"./transpile":6,__browserify_Buffer:63}],6:[function(t,e,n){function r(t){t=u(t)?new Function("return "+t+";")():t;var e,n=["(function(){"];for(var r in t.hasOwnProperty("constructor")&&"function"==typeof t.constructor?n.push("var Defined = "+t.constructor.toString()+";"):n.push("var Defined = function(opts){ for(var i in opts){if(opts.hasOwnProperty(i)){this[i] = opts[i];}}};"),n.push("var proto = Defined.prototype;"),t)t.hasOwnProperty(r)&&n.push("proto."+r+" = "+(o.isFunction(e=t[r])?e.toString():o.format("%j",e))+";");return n.push("return Defined;"),n.push("}())"),n.join("")}var i=t("__browserify_Buffer").Buffer,o=t("../extended"),s=o.forEach,a=o.indexOf,c=o.merge,u=o.isString,h=t("./common").modifiers,f=t("../constraintMatcher"),l=t("../parser");n.transpile=function(t,e){e=e||{};var n=[];n.push("(function(){"),n.push("return function(options){"),n.push("options = options || {};"),n.push("var bind = function(scope, fn){return function(){return fn.apply(scope, arguments);};}, defined = {Array: Array, String: String, Number: Number, Boolean: Boolean, RegExp: RegExp, Date: Date, Object: Object}, scope = options.scope || {};"),n.push("var optDefined = options.defined || {}; for(var i in optDefined){defined[i] = optDefined[i];}");var u=c({Array:Array,String:String,Number:Number,Boolean:Boolean,RegExp:RegExp,Date:Date,Object:Object},e.define||{});void 0!==i&&(u.Buffer=i);var p=c({console:console},e.scope);return n.push(["return nools.flow('",e.name,"', function(){"].join("")),n.push(o(t.define||[]).map(function(t){var e=t.name;return t[e]={},["var",e,"= defined."+e,"= this.addDefined('"+e+"',",r(t.properties)+");"].join(" ")}).value().join("\n")),n.push(o(t.scope||[]).map(function(t){var e=t.name;return p[e]={},["var",e,"= scope."+e,"= ",t.body,";"].join(" ")}).value().join("\n")),n.push("scope.console = console;\n"),n.push(o(t.rules||[]).map(function(t){var e=[],n=["this.rule('",t.name.replace(/'/g,"\\'"),"'"],r=o.merge(t.options||{},{scope:"scope"});return n.push(",",o.format("%j",[r]).replace(/(:"scope")/,":scope")),t.constraints&&!o.isEmpty(t.constraints)&&(n.push(", ["),n.push(o(t.constraints).map(function(t){return function t(e,n){var r=[];if("or"===(e=e.slice(0))[0])return r.push('["'+e.shift()+'"'),r.push(o.map(e,function(e){return t(e,n)}).join(",")+"]"),r;if(("not"===e[0]||"exists"===e[0])&&r.push('"',e.shift(),'", '),n.push(e[1]),r.push(e[0],', "'+e[1].replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'),e.splice(0,2),e.length){var i=e.shift();o.isString(i)&&i?(r.push(',"'+i.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"'),s(f.getIdentifiers(l.parseConstraint(i)),function(t){n.push(t)})):(r.push(',"true"'),e.unshift(i))}return function(t,e){if(t.length&&o.isString(t[0])){var n=t[0].match(" *(from)");if(n)switch(n=n[0]){case"from":e.push(', "',t.shift(),'"');break;default:throw new Error("Unrecognized modifier "+n)}}}(e,r),function(t,e,n){if(t.length&&o.isHash(t[0])){var r=t.shift();o(r).values().forEach(function(t){-1===a(n,t)&&n.push(t)}),e.push(","+o.format("%j",[r]))}}(e,r,n),"["+r.join("")+"]"}(t,e)}).value().join(",")),n.push("]")),n.push(",",function(t,e,n,r){var i=[],a={};s(e,function(e){-1!==t.indexOf(e)&&(a[e]=!0,i.push("var "+e+"= facts."+e+";"))}),o(n).keys().forEach(function(e){-1===t.indexOf(e)||a[e]||(a[e]=!0,i.push("var "+e+"= defined."+e+";"))}),o(r).keys().forEach(function(e){-1===t.indexOf(e)||a[e]||(a[e]=!0,i.push("var "+e+"= scope."+e+";"))}),o(h).forEach(function(e){-1===t.indexOf(e)||a[e]||i.push("var "+e+"= flow."+e+";")});var c=["facts","flow"];/next\(.*\)/.test(t)&&c.push("next"),t=i.join("")+t;try{return["function(",c.join(","),"){",t,"}"].join("")}catch(u){throw new Error("Invalid action : "+t+"\n"+u.message)}}(t.action,e,u,p)),n.push(");"),n.join("")}).value().join("")),n.push("});"),n.push("};"),n.push("}());"),n.join("")}},{"../constraintMatcher":9,"../extended":12,"../parser":44,"./common":4,__browserify_Buffer:63}],7:[function(t,e,n){var r=t("./extended").map,i={salience:function(t,e){return t.rule.priority-e.rule.priority},bucketCounter:function(t,e){return t.counter-e.counter},factRecency:function(t,e){for(var n=0,r=t.match.recency,i=e.match.recency,o=r.length-1,s=i.length-1;r[n]===i[n]&&o>n&&s>n&&n++;);var a=r[n]-i[n];return a||(a=o-s),a},activationRecency:function(t,e){return t.recency-e.recency}};n.strategies=i,n.strategy=function(t){var e=(t=r(t,function(t){return i[t]})).length;return function(n,r){var i=-1,o=0;if(n!==r&&(n.name!==r.name||n.hashCode!==r.hashCode)){for(;++i<e&&!o;)o=t[i](n,r);o=o>0?1:-1}return o}}},{"./extended":12}],8:[function(t,e,n){"use strict";var r,i=t("./extended"),o=i.deepEqual,s=i.merge,a=i.instanceOf,c=i.filter,u=0,h=(0,i.declare)({type:null,instance:{constructor:function(e){r||(r=t("./constraintMatcher")),this.id=u++,this.constraint=e,i.bindAll(this,["assert"])},assert:function(){throw new Error("not implemented")},getIndexableProperties:function(){return[]},equal:function(t){return a(t,this._static)&&this.get("alias")===t.get("alias")&&i.deepEqual(this.constraint,t.constraint)},getters:{variables:function(){return[this.get("alias")]}}}});h.extend({instance:{type:"object",constructor:function(t){this._super([t])},assert:function(t){return t instanceof this.constraint||t.constructor===this.constraint},equal:function(t){return a(t,this._static)&&this.constraint===t.constraint}}}).as(n,"ObjectConstraint");var f=h.extend({instance:{type:"equality",constructor:function(t,e){this._super([t]),this.pattern=(e=e||{}).pattern,this._matcher=r.getMatcher(t,e,!0)},assert:function(t){return this._matcher(t)}}}).as(n,"EqualityConstraint");f.extend({instance:{type:"inequality"}}).as(n,"InequalityConstraint"),f.extend({instance:{type:"comparison"}}).as(n,"ComparisonConstraint"),h.extend({instance:{type:"equality",constructor:function(){this._super([[!0]])},equal:function(t){return a(t,this._static)&&this.get("alias")===t.get("alias")},assert:function(){return!0}}}).as(n,"TrueConstraint");var l=h.extend({instance:{type:"reference",constructor:function(t,e){this.cache={},this._super([t]),e=e||{},this.values=[],this.pattern=e.pattern,this._options=e,this._matcher=r.getMatcher(t,e,!1)},assert:function(t,e){try{return this._matcher(t,e)}catch(n){throw new Error("Error with evaluating pattern "+this.pattern+" "+n.message)}},merge:function(t){var e=this;return t instanceof l&&((e=new this._static([this.constraint,t.constraint,"and"],s({},this._options,this._options)))._alias=this._alias||t._alias,e.vars=this.vars.concat(t.vars)),e},equal:function(t){return a(t,this._static)&&i.deepEqual(this.constraint,t.constraint)},getters:{variables:function(){return this.vars},alias:function(){return this._alias}},setters:{alias:function(t){this._alias=t,this.vars=c(r.getIdentifiers(this.constraint),function(e){return e!==t})}}}}).as(n,"ReferenceConstraint");l.extend({instance:{type:"reference_equality",op:"eq",getIndexableProperties:function(){return r.getIndexableProperties(this.constraint)}}}).as(n,"ReferenceEqualityConstraint").extend({instance:{type:"reference_inequality",op:"neq"}}).as(n,"ReferenceInequalityConstraint").extend({instance:{type:"reference_gt",op:"gt"}}).as(n,"ReferenceGTConstraint").extend({instance:{type:"reference_gte",op:"gte"}}).as(n,"ReferenceGTEConstraint").extend({instance:{type:"reference_lt",op:"lt"}}).as(n,"ReferenceLTConstraint").extend({instance:{type:"reference_lte",op:"lte"}}).as(n,"ReferenceLTEConstraint"),h.extend({instance:{type:"hash",constructor:function(t){this._super([t])},equal:function(t){return i.instanceOf(t,this._static)&&this.get("alias")===t.get("alias")&&i.deepEqual(this.constraint,t.constraint)},assert:function(){return!0},getters:{variables:function(){return this.constraint}}}}).as(n,"HashConstraint"),h.extend({instance:{constructor:function(t,e){this.type="from",this.constraints=r.getSourceMatcher(t,e||{},!0),i.bindAll(this,["assert"])},equal:function(t){return a(t,this._static)&&this.get("alias")===t.get("alias")&&o(this.constraints,t.constraints)},assert:function(t,e){return this.constraints(t,e)},getters:{variables:function(){return this.constraint}}}}).as(n,"FromConstraint"),h.extend({instance:{constructor:function(t,e){this.type="custom",this.fn=t,this.options=e,i.bindAll(this,["assert"])},equal:function(t){return a(t,this._static)&&this.fn===t.constraint},assert:function(t,e){return this.fn(t,e)}}}).as(n,"CustomConstraint")},{"./constraintMatcher":9,"./extended":12}],9:[function(t,e,n){"use strict";var r=t("./extended"),i=r.isArray,o=r.forEach,s=r.some,a=r.indexOf,c=r.isNumber,u=r.removeDuplicates,h=t("./constraint"),f={indexOf:r.indexOf,now:function(){return new Date},Date:function(t,e,n,r,i,o,s){var a=new Date;return c(t)&&a.setYear(t),c(e)&&a.setMonth(e),c(n)&&a.setDate(n),c(r)&&a.setHours(r),c(i)&&a.setMinutes(i),c(o)&&a.setSeconds(o),c(s)&&a.setMilliseconds(s),a},lengthOf:function(t,e){return t.length===e},isTrue:function(t){return!0===t},isFalse:function(t){return!1===t},isNotNull:function(t){return null!==t},dateCmp:function(t,e){return r.compare(t,e)}};o(["years","days","months","hours","minutes","seconds"],function(t){f[t+"FromNow"]=r[t+"FromNow"],f[t+"Ago"]=r[t+"Ago"]}),o(["isArray","isNumber","isHash","isObject","isDate","isBoolean","isString","isRegExp","isNull","isEmpty","isUndefined","isDefined","isUndefinedOrNull","isPromiseLike","isFunction","deepEqual"],function(t){var e=r[t];f[t]=function(){return e.apply(r,arguments)}});var l={equal:function(t,e){var n=!1;return t===e?n=!0:t[2]===e[2]&&(n=-1!==a(["string","number","boolean","regexp","identifier","null"],t[2])?t[0]===e[0]:"unary"===t[2]||"logicalNot"===t[2]?this.equal(t[0],e[0]):this.equal(t[0],e[0])&&this.equal(t[1],e[1])),n},__getProperties:function(t){var e=[];if(t){var n=t[2];if(!n)return e;"prop"!==n&&"identifier"!==n&&"string"!==n&&"number"!==n&&"boolean"!==n&&"regexp"!==n&&"unary"!==n&&"unary"!==n?(e[0]=this.__getProperties(t[0]),e[1]=this.__getProperties(t[1])):e="identifier"===n?[t[0]]:l.__getProperties(t[1]).concat(l.__getProperties(t[0]))}return e},getIndexableProperties:function(t){return"composite"===t[2]?this.getIndexableProperties(t[0]):/^(\w+(\['[^']*'])*) *([!=]==?|[<>]=?) (\w+(\['[^']*'])*)$/.test(this.parse(t))?function t(e){return r(e).map(function(e){return i(e)?i(e[0])?t(e).value():e.reverse().join("."):e}).flatten().filter(function(t){return!!t})}(this.__getProperties(t)).flatten().value():[]},getIdentifiers:function(t){var e=[],n=t[2];if("identifier"===n)return[t[0]];if("function"===n)e=e.concat(this.getIdentifiers(t[0])).concat(this.getIdentifiers(t[1]));else if("string"!==n&&"number"!==n&&"boolean"!==n&&"regexp"!==n&&"unary"!==n&&"unary"!==n)if("prop"===n){if(e=e.concat(this.getIdentifiers(t[0])),t[1])for(var r=t[1];i(r);){if("function"===r[2]){e=e.concat(this.getIdentifiers(r[1]));break}r=r[1]}}else t[0]&&(e=e.concat(this.getIdentifiers(t[0]))),t[1]&&(e=e.concat(this.getIdentifiers(t[1])));return u(e)},toConstraints:function(t,e){var n=[],r=e.alias,i=e.scope||{},o=t[2];if("and"===o)n=n.concat(this.toConstraints(t[0],e)).concat(this.toConstraints(t[1],e));else if("composite"===o||"or"===o||"lt"===o||"gt"===o||"lte"===o||"gte"===o||"like"===o||"notLike"===o||"eq"===o||"neq"===o||"seq"===o||"sneq"===o||"in"===o||"notIn"===o||"prop"===o||"propLookup"===o||"function"===o||"logicalNot"===o){var a=s(this.getIdentifiers(t),function(t){return!(t===r||t in f||t in i)});switch(o){case"eq":case"seq":n.push(new h[a?"ReferenceEqualityConstraint":"EqualityConstraint"](t,e));break;case"neq":case"sneq":n.push(new h[a?"ReferenceInequalityConstraint":"InequalityConstraint"](t,e));break;case"gt":n.push(new h[a?"ReferenceGTConstraint":"ComparisonConstraint"](t,e));break;case"gte":n.push(new h[a?"ReferenceGTEConstraint":"ComparisonConstraint"](t,e));break;case"lt":n.push(new h[a?"ReferenceLTConstraint":"ComparisonConstraint"](t,e));break;case"lte":n.push(new h[a?"ReferenceLTEConstraint":"ComparisonConstraint"](t,e));break;default:n.push(new h[a?"ReferenceConstraint":"ComparisonConstraint"](t,e))}}return n},parse:function(t){return this[t[2]](t[0],t[1])},composite:function(t){return this.parse(t)},and:function(t,e){return["(",this.parse(t),"&&",this.parse(e),")"].join(" ")},or:function(t,e){return["(",this.parse(t),"||",this.parse(e),")"].join(" ")},prop:function(t,e){return"function"===e[2]?[this.parse(t),this.parse(e)].join("."):[this.parse(t),"['",this.parse(e),"']"].join("")},propLookup:function(t,e){return"function"===e[2]?[this.parse(t),this.parse(e)].join("."):[this.parse(t),"[",this.parse(e),"]"].join("")},unary:function(t){return-1*this.parse(t)},plus:function(t,e){return[this.parse(t),"+",this.parse(e)].join(" ")},minus:function(t,e){return[this.parse(t),"-",this.parse(e)].join(" ")},mult:function(t,e){return[this.parse(t),"*",this.parse(e)].join(" ")},div:function(t,e){return[this.parse(t),"/",this.parse(e)].join(" ")},mod:function(t,e){return[this.parse(t),"%",this.parse(e)].join(" ")},lt:function(t,e){return[this.parse(t),"<",this.parse(e)].join(" ")},gt:function(t,e){return[this.parse(t),">",this.parse(e)].join(" ")},lte:function(t,e){return[this.parse(t),"<=",this.parse(e)].join(" ")},gte:function(t,e){return[this.parse(t),">=",this.parse(e)].join(" ")},like:function(t,e){return[this.parse(e),".test(",this.parse(t),")"].join("")},notLike:function(t,e){return["!",this.parse(e),".test(",this.parse(t),")"].join("")},eq:function(t,e){return[this.parse(t),"==",this.parse(e)].join(" ")},seq:function(t,e){return[this.parse(t),"===",this.parse(e)].join(" ")},neq:function(t,e){return[this.parse(t),"!=",this.parse(e)].join(" ")},sneq:function(t,e){return[this.parse(t),"!==",this.parse(e)].join(" ")},in:function(t,e){return["(indexOf(",this.parse(e),",",this.parse(t),")) != -1"].join("")},notIn:function(t,e){return["(indexOf(",this.parse(e),",",this.parse(t),")) == -1"].join("")},arguments:function(t,e){var n=[];return t&&n.push(this.parse(t)),e&&n.push(this.parse(e)),n.join(",")},array:function(t){var e=[];return t?(e=this.parse(t),i(e)?e:["[",e,"]"].join("")):["[",e.join(","),"]"].join("")},function:function(t,e){var n=this.parse(e);return[this.parse(t),"(",n,")"].join("")},string:function(t){return"'"+t+"'"},number:function(t){return t},boolean:function(t){return t},regexp:function(t){return t},identifier:function(t){return t},null:function(){return"null"},logicalNot:function(t){return["!(",this.parse(t),")"].join("")}},p=0,d=n.toJs=function(t,e,n,i,o){var s=l.parse(t);e=e||{};var a=l.getIdentifiers(t),c=["var indexOf = definedFuncs.indexOf; var hasOwnProperty = Object.prototype.hasOwnProperty;"],u=[];r(a).filter(function(t){var n=["var ",t," = "];if(f.hasOwnProperty(t))n.push("definedFuncs['",t,"']");else{if(!e.hasOwnProperty(t))return!0;n.push("scope['",t,"']")}return n.push(";"),c.push(n.join("")),!1}).forEach(function(t){var e=["var ",t," = "];i||t!==n?e.push("fact."+t):t===n&&e.push("hash.",t,""),e.push(";"),u.push(e.join(""))});var h=c.join("")+"return function matcher"+p+++(i?"(fact){":"(fact, hash){")+u.join("")+" return "+(o?o(s):s)+";}";return new Function("definedFuncs, scope",h)(f,e)};n.getMatcher=function(t,e,n){return d(t,(e=e||{}).scope,e.alias,n,function(t){return"!!("+t+")"})},n.getSourceMatcher=function(t,e,n){return d(t,(e=e||{}).scope,e.alias,n,function(t){return t})},n.toConstraints=function(t,e){return"function"==typeof t?[new h.CustomConstraint(t,e)]:l.toConstraints(t,e)},n.equal=function(t,e){return l.equal(t,e)},n.getIdentifiers=function(t){return l.getIdentifiers(t)},n.getIndexableProperties=function(t){return l.getIndexableProperties(t)}},{"./constraint":8,"./extended":12}],10:[function(t,e,n){"use strict";function r(t,e,n){for(var r,i=-1,o=n.length;++i<o;)t[r=n[i]]=e[r]}var i=t("./extended"),o=i.isBoolean,s=i.declare,a=i.indexOf,c=Array.prototype.push,u=s({instance:{isMatch:!0,hashCode:"",facts:null,factIds:null,factHash:null,recency:null,aliases:null,constructor:function(){this.facts=[],this.factIds=[],this.factHash={},this.recency=[],this.aliases=[]},addFact:function(t){return c.call(this.facts,t),c.call(this.recency,t.recency),c.call(this.factIds,t.id),this.hashCode=this.factIds.join(":"),this},merge:function(t){var e=new u;return e.isMatch=t.isMatch,c.apply(e.facts,this.facts),c.apply(e.facts,t.facts),c.apply(e.aliases,this.aliases),c.apply(e.aliases,t.aliases),e.hashCode=this.hashCode+":"+t.hashCode,r(e.factHash,this.factHash,this.aliases),r(e.factHash,t.factHash,t.aliases),function(t,e,n){c.apply(t,e);for(var r,i=-1,o=n.length,s=t.length;++i<o;)-1===a(t,r=n[i])&&(t[s++]=r)}(e.recency,this.recency,t.recency),e}}}),h=s({instance:{match:null,factHash:null,aliases:null,fact:null,hashCode:null,paths:null,pathsHash:null,constructor:function(t,e,n){this.fact=t,this.match=n||(new u).addFact(t),this.factHash=this.match.factHash,this.aliases=this.match.aliases,this.hashCode=this.match.hashCode,e?(this.paths=e,this.pathsHash=function(t,e){for(var n="",r=-1,i=t.length;++r<i;)n+=t[r].id+":";return n+e}(e,this.hashCode)):this.pathsHash=this.hashCode},set:function(t,e){return this.factHash[t]=e,this.aliases.push(t),this},isMatch:function(t){return o(t)?(this.match.isMatch=t,this):this.match.isMatch},mergeMatch:function(t){var e=this.match=this.match.merge(t);return this.factHash=e.factHash,this.hashCode=e.hashCode,this.aliases=e.aliases,this},clone:function(t,e,n){return new h(t||this.fact,e||this.path,n||this.match)}}}).as(e)},{"./extended":12}],11:[function(t,e,n){var r=t("./extended"),i=r.Promise,o=t("./nextTick"),s=r.isPromiseLike;i.extend({instance:{looping:!1,constructor:function(t,e){this._super([]),this.flow=t,this.agenda=t.agenda,this.rootNode=t.rootNode,this.matchUntilHalt=!!e,r.bindAll(this,["onAlter","callNext"])},halt:function(){this.__halted=!0,this.looping||this.callback()},onAlter:function(){this.flowAltered=!0,this.looping||!this.matchUntilHalt||this.__halted||this.callNext()},setup:function(){var t=this.flow;this.rootNode.resetCounter(),t.on("assert",this.onAlter),t.on("modify",this.onAlter),t.on("retract",this.onAlter)},tearDown:function(){var t=this.flow;t.removeListener("assert",this.onAlter),t.removeListener("modify",this.onAlter),t.removeListener("retract",this.onAlter)},__handleAsyncNext:function(t){var e=this,n=e.agenda;return t.then(function(){e.looping=!1,n.isEmpty()?(!e.matchUntilHalt||e.__halted)&&e.callback():(e.flowAltered&&(e.rootNode.incrementCounter(),e.flowAltered=!1),e.__halted?e.callback():e.callNext()),e=null},this.errback)},__handleSyncNext:function(t){return this.looping=!1,this.agenda.isEmpty()||this.flowAltered&&(this.rootNode.incrementCounter(),this.flowAltered=!1),t&&!this.__halted?o(this.callNext):(!this.matchUntilHalt||this.__halted)&&this.callback(),t},callback:function(){this.tearDown(),this._super(arguments)},callNext:function(){this.looping=!0;var t=this.agenda.fireNext();return s(t)?this.__handleAsyncNext(t):this.__handleSyncNext(t)},execute:function(){return this.setup(),this.callNext(),this}}}).as(e)},{"./extended":12,"./nextTick":17}],12:[function(t,e,n){function r(t){var e=t.match(/(\w+)\(\)$/);return e?(t=e[1],function(e){return e[t]()}):function(e){return e[t]}}var i=t("array-extended"),o=i.unique,s=i.indexOf,a=i.map,c=Array.prototype.slice,u=Array.prototype.splice;e.exports=t("extended")().register(t("date-extended")).register(i).register(t("object-extended")).register(t("string-extended")).register(t("promise-extended")).register(t("function-extended")).register(t("is-extended")).register("intersection",function(t,e){var n,r=-1;for(n=(t=c.call(t)).length;++r<n;)-1===s(e,t[r])&&(u.call(t,r--,1),n--);return t}).register("inPlaceIntersection",function(t,e){var n,r=-1;for(n=t.length;++r<n;)-1===s(e,t[r])&&(u.call(t,r--,1),n--);return t}).register("inPlaceDifference",function(t,e){var n,r=-1;for(n=t.length;++r<n;)-1!==s(e,t[r])&&(u.call(t,r--,1),n--);return t}).register("diffArr",function(t,e){var n,r,i,o=[],s=-1,a=e.length,c=t.length;if(a>c){for(o=t.slice();++s<a;)for(r=e[s],n=-1,c=o.length;++n<c;)if(o[n]===r){o.splice(n,1);break}}else for(;++s<c;){for(r=t[s],n=-1,i=!1;++n<a;)if(e[n]===r){i=!0;break}i||o.push(r)}return o}).register("diffHash",function(t,e){var n={};for(var r in t)hasOwnProperty.call(e,r)||(n[r]=t[r]);return n}).register("unionArr",function(t,e){return o(t.concat(e))}).register("plucker",function(t){if(1===(t=t.split(".")).length)return r(t[0]);var e=a(t,function(t){return r(t)}),n=e.length;return function(t){for(var r=-1,i=t;++r<n;)i=e[r](i);return i}}).register("HashTable",t("ht")).register("declare",t("declare.js")).register(t("leafy")).register("LinkedList",t("./linkedList"))},{"./linkedList":16,"array-extended":52,"date-extended":53,"declare.js":55,extended:56,"function-extended":59,ht:65,"is-extended":66,leafy:67,"object-extended":68,"promise-extended":69,"string-extended":70}],13:[function(t,e,n){"use strict";var r=t("./extended"),i=r.bind,o=r.declare,s=t("./nodes"),a=t("events").EventEmitter,c=t("./workingMemory").WorkingMemory,u=t("./executionStrategy"),h=t("./agenda");e.exports=o(a,{instance:{name:null,executionStrategy:null,constructor:function(t,e){this.env=null,this.name=t,this.__rules={},this.conflictResolutionStrategy=e,this.workingMemory=new c,this.agenda=new h(this,e),this.agenda.on("fire",i(this,"emit","fire")),this.agenda.on("focused",i(this,"emit","focused")),this.rootNode=new s.RootNode(this.workingMemory,this.agenda),r.bindAll(this,"halt","assert","retract","modify","focus","emit","getFacts","getFact")},getFacts:function(t){return t?this.workingMemory.getFactsByType(t):this.workingMemory.getFacts()},getFact:function(t){var e;return(e=t?this.workingMemory.getFactsByType(t):this.workingMemory.getFacts())&&e[0]},focus:function(t){return this.agenda.setFocus(t),this},halt:function(){return this.executionStrategy.halt(),this},dispose:function(){this.workingMemory.dispose(),this.agenda.dispose(),this.rootNode.dispose()},assert:function(t){return this.rootNode.assertFact(this.workingMemory.assertFact(t)),this.emit("assert",t),t},retract:function(t){return this.rootNode.retractFact(this.workingMemory.retractFact(t)),this.emit("retract",t),t},modify:function(t,e){return"function"==typeof e&&e.call(t,t),this.rootNode.modifyFact(this.workingMemory.modifyFact(t)),this.emit("modify",t),t},print:function(){this.rootNode.print()},containsRule:function(t){return this.rootNode.containsRule(t)},rule:function(t){this.rootNode.assertRule(t)},matchUntilHalt:function(t){return(this.executionStrategy=new u(this,!0)).execute().classic(t).promise()},match:function(t){return(this.executionStrategy=new u(this)).execute().classic(t).promise()}}})},{"./agenda":3,"./executionStrategy":11,"./extended":12,"./nodes":27,"./workingMemory":50,events:60}],14:[function(t,e,n){"use strict";var r=t("./extended"),i=r.instanceOf,o=r.forEach,s=r.declare,a=t("./pattern").InitialFact,c=t("./conflict"),u=c.strategy(["salience","activationRecency"]),h=t("./rule"),f=t("./flow"),l={},p=s({instance:{constructor:function(t,e){if(this.name=t,this.cb=e,this.__rules=[],this.__defined={},this.conflictResolutionStrategy=u,e&&e.call(this,this),l.hasOwnProperty(t))throw new Error("Flow with "+t+" already defined");l[t]=this},conflictResolution:function(t){return this.conflictResolutionStrategy=c.strategy(t),this},getDefined:function(t){var e=this.__defined[t.toLowerCase()];if(!e)throw new Error(t+" flow class is not defined");return e},addDefined:function(t,e){return this.__defined[t.toLowerCase()]=e,e},rule:function(){return this.__rules=this.__rules.concat(h.createRule.apply(h,arguments)),this},getSession:function(){var t=new f(this.name,this.conflictResolutionStrategy);o(this.__rules,function(e){t.rule(e)}),t.assert(new a);for(var e=0,n=arguments.length;n>e;e++)t.assert(arguments[e]);return t},containsRule:function(t){return r.some(this.__rules,function(e){return e.name===t})}},static:{getFlow:function(t){return l[t]},hasFlow:function(t){return r.has(l,t)},deleteFlow:function(t){return i(t,p)&&(t=t.name),delete l[t],p},deleteFlows:function(){for(var t in l)t in l&&delete l[t];return p},create:function(t,e){return new p(t,e)}}}).as(e)},{"./conflict":7,"./extended":12,"./flow":13,"./pattern":48,"./rule":49}],15:[function(t,e,n){"use strict";function r(t){return/\.nools$/.test(t)}function i(t){return r(t)?c.parse(s.readFileSync(t,"utf8"),t):c.parse(t)}var o=t("./extended"),s=t("fs"),a=t("path"),c=t("./compile"),u=t("./flowContainer");n.Flow=u,n.getFlow=u.getFlow,n.hasFlow=u.hasFlow,n.deleteFlow=function(t){return u.deleteFlow(t),this},n.deleteFlows=function(){return u.deleteFlows(),this},n.flow=u.create,n.compile=function(t,e,n){if(o.isFunction(e)?(n=e,e={}):e=e||{},o.isString(t)&&(e.name=e.name||(r(t)?a.basename(t,a.extname(t)):null),t=i(t)),!e.name)throw new Error("Name required when compiling nools source");return c.compile(t,e,n,u)},n.transpile=function(t,e){return e=e||{},o.isString(t)&&(e.name=e.name||(r(t)?a.basename(t,a.extname(t)):null),t=i(t)),c.transpile(t,e)},n.parse=i},{"./compile":5,"./extended":12,"./flowContainer":14,fs:61,path:62}],16:[function(t,e,n){t("declare.js")({instance:{constructor:function(){this.head=null,this.tail=null,this.length=null},push:function(t){var e=this.tail,n=this.head,r={data:t,prev:e,next:null};return e&&(this.tail.next=r),this.tail=r,n||(this.head=r),this.length++,r},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,this.length--},forEach:function(t){for(var e={next:this.head};e=e.next;)t(e.data)},toArray:function(){for(var t={next:this.head},e=[];t=t.next;)e.push(t);return e},removeByData:function(t){for(var e={next:this.head};e=e.next;)if(e.data===t){this.remove(e);break}},getByData:function(t){for(var e={next:this.head};e=e.next;)if(e.data===t)return e},clear:function(){this.head=this.tail=null,this.length=0}}}).as(e)},{"declare.js":55}],17:[function(t,e,n){var r,i=t("__browserify_process"),o=t("./extended");if("function"==typeof setImmediate)r="undefined"!=typeof window?o.bind(window,setImmediate):setImmediate;else if(void 0!==i)r=i.nextTick;else if("undefined"!=typeof MessageChannel){var s=new MessageChannel,a={},c=a;s.port1.onmessage=function(){var t=(a=a.next).task;delete a.task,t()},r=function(t){c=c.next={task:t},s.port2.postMessage(0)}}else r=function(t){setTimeout(t,0)};e.exports=r},{"./extended":12,__browserify_process:64}],18:[function(t,e,n){var r=t("./node"),i=t("../extended").intersection;r.extend({instance:{__propagatePaths:function(t,e){for(var n,r,o,s=this.__entrySet,a=s.length;--a>-1;)r=(n=s[a]).key,(o=i(n.value,e.paths)).length&&r[t](e.clone(null,o,null))},__propagateNoPaths:function(t,e){for(var n=this.__entrySet,r=n.length;--r>-1;)n[r].key[t](e)},__propagate:function(t,e){e.paths?this.__propagatePaths(t,e):this.__propagateNoPaths(t,e)}}}).as(e)},{"../extended":12,"./node":37}],19:[function(t,e,n){t("./alphaNode").extend({instance:{constructor:function(){this._super(arguments),this.alias=this.constraint.get("alias")},toString:function(){return"AliasNode"+this.__count},assert:function(t){return this.__propagate("assert",t.set(this.alias,t.fact.object))},modify:function(t){return this.__propagate("modify",t.set(this.alias,t.fact.object))},retract:function(t){return this.__propagate("retract",t.set(this.alias,t.fact.object))},equal:function(t){return t instanceof this._static&&this.alias===t.alias}}}).as(e)},{"./alphaNode":20}],20:[function(t,e,n){"use strict";t("./node").extend({instance:{constructor:function(t){this._super([]),this.constraint=t,this.constraintAssert=this.constraint.assert},toString:function(){return"AlphaNode "+this.__count},equal:function(t){return this.constraint.equal(t.constraint)}}}).as(e)},{"./node":37}],21:[function(t,e,n){var r=t("../extended").hash.keys,i=t("./node"),o=t("./misc/leftMemory"),s=t("./misc/rightMemory");i.extend({instance:{nodeType:"BetaNode",constructor:function(){this._super([]),this.leftMemory={},this.rightMemory={},this.leftTuples=new o,this.rightTuples=new s},__propagate:function(t,e){for(var n=this.__entrySet,r=n.length;--r>-1;)n[r].key[t](e)},dispose:function(){this.leftMemory={},this.rightMemory={},this.leftTuples.clear(),this.rightTuples.clear()},disposeLeft:function(t){this.leftMemory={},this.leftTuples.clear(),this.propagateDispose(t)},disposeRight:function(t){this.rightMemory={},this.rightTuples.clear(),this.propagateDispose(t)},hashCode:function(){return this.nodeType+" "+this.__count},toString:function(){return this.nodeType+" "+this.__count},retractLeft:function(t){for(var e=(t=this.removeFromLeftMemory(t).data).rightMatches,n=r(e),i=-1,o=n.length;++i<o;)this.__propagate("retract",e[n[i]].clone())},retractRight:function(t){for(var e=(t=this.removeFromRightMemory(t).data).leftMatches,n=r(e),i=-1,o=n.length;++i<o;)this.__propagate("retract",e[n[i]].clone())},assertLeft:function(t){this.__addToLeftMemory(t);for(var e=this.rightTuples.getRightMemory(t),n=-1,r=e.length;++n<r;)this.propagateFromLeft(t,e[n].data)},assertRight:function(t){this.__addToRightMemory(t);for(var e=this.leftTuples.getLeftMemory(t),n=-1,r=e.length;++n<r;)this.propagateFromRight(t,e[n].data)},modifyLeft:function(t){var e=this.removeFromLeftMemory(t).data;this.__addToLeftMemory(t);var n,r=this.rightTuples.getRightMemory(t),i=r.length,o=-1;if(i)for(n=e.rightMatches;++o<i;)this.propagateAssertModifyFromLeft(t,n,r[o].data);else this.propagateRetractModifyFromLeft(e)},modifyRight:function(t){var e=this.removeFromRightMemory(t).data;this.__addToRightMemory(t);var n=this.leftTuples.getLeftMemory(t);if(n.length)for(var r=e.leftMatches,i=-1,o=n.length;++i<o;)this.propagateAssertModifyFromRight(t,r,n[i].data);else this.propagateRetractModifyFromRight(e)},propagateFromLeft:function(t,e){this.__propagate("assert",this.__addToMemoryMatches(e,t,t.clone(null,null,t.match.merge(e.match))))},propagateFromRight:function(t,e){this.__propagate("assert",this.__addToMemoryMatches(t,e,e.clone(null,null,e.match.merge(t.match))))},propagateRetractModifyFromLeft:function(t){for(var e=t.rightMatches,n=r(e),i=n.length,o=-1;++o<i;)this.__propagate("retract",e[n[o]].clone())},propagateRetractModifyFromRight:function(t){for(var e=t.leftMatches,n=r(e),i=n.length,o=-1;++o<i;)this.__propagate("retract",e[n[o]].clone())},propagateAssertModifyFromLeft:function(t,e,n){n.hashCode in e?this.__propagate("modify",this.__addToMemoryMatches(n,t,t.clone(null,null,t.match.merge(n.match)))):this.propagateFromLeft(t,n)},propagateAssertModifyFromRight:function(t,e,n){n.hashCode in e?this.__propagate("modify",this.__addToMemoryMatches(t,n,t.clone(null,null,n.match.merge(t.match)))):this.propagateFromRight(t,n)},removeFromRightMemory:function(t){var e=t.hashCode;if(t=this.rightMemory[e]||null){var n=this.leftMemory,i=t.data.leftMatches;this.rightTuples.remove(t);for(var o=r(i),s=-1,a=o.length;++s<a;)delete n[o[s]].data.rightMatches[e];delete this.rightMemory[e]}return t},removeFromLeftMemory:function(t){var e=t.hashCode;if(t=this.leftMemory[e]||null){var n=this.rightMemory,i=t.data.rightMatches;this.leftTuples.remove(t);for(var o=r(i),s=-1,a=o.length;++s<a;)delete n[o[s]].data.leftMatches[e];delete this.leftMemory[e]}return t},getRightMemoryMatches:function(t){var e=this.leftMemory[t.hashCode],n={};return e&&(n=e.rightMatches),n},__addToMemoryMatches:function(t,e,n){var r,i=t.hashCode,o=this.rightMemory[i],s=e.hashCode;if(o){if(s in(o=o.data).leftMatches)throw new Error("Duplicate left fact entry");o.leftMatches[s]=n}if(r=this.leftMemory[s]){if(i in(r=r.data).rightMatches)throw new Error("Duplicate right fact entry");r.rightMatches[i]=n}return n},__addToRightMemory:function(t){var e=t.hashCode,n=this.rightMemory;return!(e in n||(n[e]=this.rightTuples.push(t),t.leftMatches={},0))},__addToLeftMemory:function(t){var e=t.hashCode,n=this.leftMemory;return!(e in n||(n[e]=this.leftTuples.push(t),t.rightMatches={},0))}}}).as(e)},{"../extended":12,"./misc/leftMemory":32,"./misc/rightMemory":34,"./node":37}],22:[function(t,e,n){t("./alphaNode").extend({instance:{constructor:function(){this.memory={},this._super(arguments),this.constraintAssert=this.constraint.assert},assert:function(t){(this.memory[t.pathsHash]=this.constraintAssert(t.factHash))&&this.__propagate("assert",t)},modify:function(t){var e=this.memory,n=t.pathsHash,r=e[n];(e[n]=this.constraintAssert(t.factHash))?this.__propagate(r?"modify":"assert",t):r&&this.__propagate("retract",t)},retract:function(t){var e=t.pathsHash,n=this.memory;n[e]&&this.__propagate("retract",t),delete n[e]},toString:function(){return"EqualityNode"+this.__count}}}).as(e)},{"./alphaNode":20}],23:[function(t,e,n){var r=t("./fromNotNode"),i=t("../extended"),o=t("../context"),s=i.isDefined,a=i.isArray;r.extend({instance:{nodeType:"ExistsFromNode",retractLeft:function(t){var e=this.removeFromLeftMemory(t);e&&(e=e.data).blocked&&this.__propagate("retract",e.clone())},__modify:function(t,e){var n=e.blocked,r=this.from(t.factHash);if(a(r)){for(var i=0,o=r.length;o>i;i++)if(this.__isMatch(t,r[i],!0)){t.blocked=!0;break}}else s(r)&&(t.blocked=this.__isMatch(t,r,!0));t.blocked?this.__propagate(n?"modify":"assert",t.clone()):n&&this.__propagate("retract",t.clone())},__findMatches:function(t){var e=this.from(t.factHash);if(a(e)){for(var n=0,r=e.length;r>n;n++)if(this.__isMatch(t,e[n],!0))return t.blocked=!0,void this.__propagate("assert",t.clone())}else s(e)&&this.__isMatch(t,e,!0)&&(t.blocked=!0,this.__propagate("assert",t.clone()));return!1},__isMatch:function(t,e,n){var r=!1;if(this.type(e)){var i=this.workingMemory.getFactHandle(e),s=new o(i,null,null).mergeMatch(t.match).set(this.alias,e);if(n){var a=this.fromMemory[i.id];a||(a=this.fromMemory[i.id]={}),a[t.hashCode]=t}for(var c=s.factHash,u=this.__equalityConstraints,h=0,f=u.length;f>h;h++){if(!u[h](c)){r=!1;break}r=!0}}return r},assertLeft:function(t){this.__addToLeftMemory(t),this.__findMatches(t)}}}).as(e)},{"../context":10,"../extended":12,"./fromNotNode":26}],24:[function(t,e,n){var r=t("./notNode"),i=t("../linkedList");r.extend({instance:{nodeType:"ExistsNode",blockedContext:function(t,e){t.blocker=e,this.removeFromLeftMemory(t),this.addToLeftBlockedMemory(e.blocking.push(t)),this.__propagate("assert",this.__cloneContext(t))},notBlockedContext:function(t,e){this.__addToLeftMemory(t),e&&this.__propagate("retract",this.__cloneContext(t))},propagateFromLeft:function(t){this.notBlockedContext(t,!1)},retractLeft:function(t){var e;if(!this.removeFromLeftMemory(t)){if(!(e=this.removeFromLeftBlockedMemory(t)))throw new Error;this.__propagate("retract",this.__cloneContext(e.data))}},modifyLeft:function(t){var e,n,r,i,o=this.removeFromLeftMemory(t),s=this.constraint,a=this.rightTuples,c=a.length,u=!1;if(o||(o=this.removeFromLeftBlockedMemory(t),u=!0),!o)throw new Error;if((e=o.data)&&e.blocker&&(i=this.rightMemory[e.blocker.hashCode]),i?(s.isMatch(t,r=i.data)&&(this.__propagate(u?"modify":"assert",this.__cloneContext(e)),t.blocker=r,this.addToLeftBlockedMemory(r.blocking.push(t)),t=null),t&&(n={next:i.next})):n={next:a.head},t&&c)for(n={next:a.head};n=n.next;)if(s.isMatch(t,r=n.data)){this.__propagate(u?"modify":"assert",this.__cloneContext(e)),this.addToLeftBlockedMemory(r.blocking.push(t)),t.blocker=r,t=null;break}t&&(this.__addToLeftMemory(t),u&&this.__propagate("retract",this.__cloneContext(t)))},modifyRight:function(t){var e=this.removeFromRightMemory(t);if(!e)throw new Error;var n,r,o=this.leftTuples,s=o.length,a=this.constraint,c=e.data.blocking;if(this.__addToRightMemory(t),t.blocking=new i,s||c.length){if(c.length)for(var u,h={next:c.head};h=h.next;)if((n=h.data).blocker=null,a.isMatch(n,t))n.blocker=t,this.addToLeftBlockedMemory(t.blocking.push(n)),this.__propagate("assert",this.__cloneContext(n)),n=null;else{for(n.blocker=null,r=e;r=r.next;)if(a.isMatch(n,u=r.data)){n.blocker=u,this.addToLeftBlockedMemory(u.blocking.push(n)),this.__propagate("assert",this.__cloneContext(n)),n=null;break}n&&this.__addToLeftMemory(n)}if(s)for(r={next:o.head};r=r.next;)a.isMatch(n=r.data,t)&&(this.__propagate("assert",this.__cloneContext(n)),this.removeFromLeftMemory(n),this.addToLeftBlockedMemory(t.blocking.push(n)),n.blocker=t)}}}}).as(e)},{"../linkedList":16,"./notNode":38}],25:[function(t,e,n){var r=t("./joinNode"),i=t("../extended"),o=t("../constraint"),s=o.EqualityConstraint,a=o.HashConstraint,c=o.ReferenceConstraint,u=t("../context"),h=i.isDefined,f=i.isEmpty,l=i.forEach,p=i.isArray,d={isMatch:function(){return!1}};r.extend({instance:{nodeType:"FromNode",constructor:function(t,e){this._super(arguments),this.workingMemory=e,this.fromMemory={},this.pattern=t,this.type=t.get("constraints")[0].assert,this.alias=t.get("alias"),this.from=t.from.assert;var n=this.__equalityConstraints=[],r=[];l(this.constraints=this.pattern.get("constraints").slice(1),function(t){t instanceof s||t instanceof c?n.push(t.assert):t instanceof a&&(r=r.concat(t.get("variables")))}),this.__variables=r},__createMatches:function(t){var e=this.from(t.factHash);if(p(e))for(var n=0,r=e.length;r>n;n++)this.__checkMatch(t,e[n],!0);else h(e)&&this.__checkMatch(t,e,!0)},__checkMatch:function(t,e,n){var r;return(r=this.__createMatch(t,e)).isMatch()&&n&&this.__propagate("assert",r.clone()),r},__createMatch:function(t,e){if(this.type(e)){var n,r=this.workingMemory.getFactHandle(e,!0),i=new u(r,null,null).set(this.alias,e),o=r.id,s=i.factHash,a=t.factHash;for(var c in a)s[c]=a[c];for(var h=this.__equalityConstraints,f=this.__variables,l=-1,p=h.length;++l<p;)if(!h[l](s,s)){n=d;break}var g=this.fromMemory[o];if(g||(g=this.fromMemory[o]={}),!n){var _;for(l=-1,p=f.length;++l<p;)s[_=f[l]]=e[_];t.fromMatches[r.id]=n=i.clone(r,null,t.match.merge(i.match))}return g[t.hashCode]=[t,n],n}return d},retractRight:function(){throw new Error("Shouldnt have gotten here")},removeFromFromMemory:function(t){var e=t.fact.id,n=this.fromMemory[e];if(n)for(var r in n)if(n[r][1]===t){delete n[r],f(n)&&delete this.fromMemory[e];break}},retractLeft:function(t){var e=this.removeFromLeftMemory(t);if(e){var n=(e=e.data).fromMatches;for(var r in n)this.removeFromFromMemory(n[r]),this.__propagate("retract",n[r].clone())}},modifyLeft:function(t){var e,n,r,i,o,s=this.removeFromLeftMemory(t);if(s){this.__addToLeftMemory(t);var a=s.data,c=t.fromMatches={},u=a.fromMatches,f=this.from(t.factHash);if(p(f))for(n=0,r=f.length;r>n;n++)(e=this.__checkMatch(t,f[n],!1)).isMatch()&&this.__propagate((i=e.fact.id)in u?"modify":"assert",e.clone());else h(f)&&(e=this.__checkMatch(t,f,!1)).isMatch()&&this.__propagate((i=e.fact.id)in u?"modify":"assert",e.clone());for(n in u)n in c||(this.removeFromFromMemory(u[n]),this.__propagate("retract",u[n].clone()))}else this.assertLeft(t);var l=this.fromMemory[i=(o=t.fact).id];if(this.fromMemory[i]={},l){var d,g,_,y,v=o.object;for(n in l)d=(g=l[n])[0],y=(_=g[1]).isMatch(),d.hashCode!==t.hashCode&&(e=this.__createMatch(d,v,!1),y&&this.__propagate("retract",_.clone()),e.isMatch()&&this.__propagate(y?"modify":"assert",e.clone()))}},assertLeft:function(t){this.__addToLeftMemory(t),t.fromMatches={},this.__createMatches(t)},assertRight:function(){throw new Error("Shouldnt have gotten here")}}}).as(e)},{"../constraint":8,"../context":10,"../extended":12,"./joinNode":28}],26:[function(t,e,n){var r=t("./joinNode"),i=t("../extended"),o=t("../constraint"),s=o.EqualityConstraint,a=o.HashConstraint,c=o.ReferenceConstraint,u=t("../context"),h=i.isDefined,f=i.forEach,l=i.isArray;r.extend({instance:{nodeType:"FromNotNode",constructor:function(t,e){this._super(arguments),this.workingMemory=e,this.pattern=t,this.type=t.get("constraints")[0].assert,this.alias=t.get("alias"),this.from=t.from.assert,this.fromMemory={};var n=this.__equalityConstraints=[],r=[];f(this.constraints=this.pattern.get("constraints").slice(1),function(t){t instanceof s||t instanceof c?n.push(t.assert):t instanceof a&&(r=r.concat(t.get("variables")))}),this.__variables=r},retractLeft:function(t){var e=this.removeFromLeftMemory(t);e&&((e=e.data).blocked||this.__propagate("retract",e.clone()))},__modify:function(t,e){var n=e.blocked,r=this.from(t.factHash);if(l(r)){for(var i=0,o=r.length;o>i;i++)if(this.__isMatch(t,r[i],!0)){t.blocked=!0;break}}else h(r)&&(t.blocked=this.__isMatch(t,r,!0));t.blocked?n||this.__propagate("retract",e.clone()):this.__propagate(n?"assert":"modify",t.clone())},modifyLeft:function(t){var e=this.removeFromLeftMemory(t);if(!e)throw new Error;this.__addToLeftMemory(t),this.__modify(t,e.data);var n=this.fromMemory[t.fact.id];if(this.fromMemory[t.fact.id]={},n)for(var r in n)if(r!==t.hashCode){var i=n[r];(e=this.removeFromLeftMemory(i))&&((i=i.clone()).blocked=!1,this.__addToLeftMemory(i),this.__modify(i,e.data))}},__findMatches:function(t){var e=this.from(t.factHash);if(l(e)){for(var n=0,r=e.length;r>n;n++)if(this.__isMatch(t,e[n],!0))return void(t.blocked=!0);this.__propagate("assert",t.clone())}else h(e)&&!(t.blocked=this.__isMatch(t,e,!0))&&this.__propagate("assert",t.clone());return!1},__isMatch:function(t,e,n){var r=!1;if(this.type(e)){var i=this.workingMemory.getFactHandle(e),o=new u(i,null).mergeMatch(t.match).set(this.alias,e);if(n){var s=this.fromMemory[i.id];s||(s=this.fromMemory[i.id]={}),s[t.hashCode]=t}for(var a=o.factHash,c=this.__equalityConstraints,h=0,f=c.length;f>h;h++){if(!c[h](a,a)){r=!1;break}r=!0}}return r},assertLeft:function(t){this.__addToLeftMemory(t),this.__findMatches(t)},assertRight:function(){throw new Error("Shouldnt have gotten here")},retractRight:function(){throw new Error("Shouldnt have gotten here")}}}).as(e)},{"../constraint":8,"../context":10,"../extended":12,"./joinNode":28}],27:[function(t,e,n){"use strict";function r(t){return s(t.constraints||[],function(t){return t instanceof m})}var i=t("../extended"),o=i.forEach,s=i.some,a=i.declare,c=t("../pattern.js"),u=c.ObjectPattern,h=c.FromPattern,f=c.FromNotPattern,l=c.ExistsPattern,p=c.FromExistsPattern,d=c.NotPattern,g=c.CompositePattern,_=c.InitialFactPattern,y=t("../constraint"),v=y.HashConstraint,m=y.ReferenceConstraint,E=t("./aliasNode"),w=t("./equalityNode"),b=t("./joinNode"),x=t("./betaNode"),k=t("./notNode"),T=t("./fromNode"),L=t("./fromNotNode"),M=t("./existsNode"),N=t("./existsFromNode"),I=t("./leftAdapterNode"),O=t("./rightAdapterNode"),S=t("./typeNode"),A=t("./terminalNode"),C=t("./propertyNode");a({instance:{constructor:function(t,e){this.terminalNodes=[],this.joinNodes=[],this.nodes=[],this.constraints=[],this.typeNodes=[],this.__ruleCount=0,this.bucket={counter:0,recency:0},this.agendaTree=e,this.workingMemory=t},assertRule:function(t){var e=new A(this.bucket,this.__ruleCount++,t,this.agendaTree);this.__addToNetwork(t,t.pattern,e),this.__mergeJoinNodes(),this.terminalNodes.push(e)},resetCounter:function(){this.bucket.counter=0},incrementCounter:function(){this.bucket.counter++},assertFact:function(t){for(var e=this.typeNodes,n=e.length-1;n>=0;n--)e[n].assert(t)},retractFact:function(t){for(var e=this.typeNodes,n=e.length-1;n>=0;n--)e[n].retract(t)},modifyFact:function(t){for(var e=this.typeNodes,n=e.length-1;n>=0;n--)e[n].modify(t)},containsRule:function(t){return s(this.terminalNodes,function(e){return e.rule.name===t})},dispose:function(){for(var t=this.typeNodes,e=t.length-1;e>=0;e--)t[e].dispose()},__mergeJoinNodes:function(){for(var t=this.joinNodes,e=0;e<t.length;e++){var n=t[e],r=t[e+1];n&&r&&n.constraint&&r.constraint&&n.constraint.equal(r.constraint)&&(n.merge(r),t.splice(e+1,1))}},__checkEqual:function(t){for(var e=this.constraints,n=e.length-1;n>=0;n--){var r=e[n];if(t.equal(r))return r}return e.push(t),t},__createTypeNode:function(t,e){for(var n=new S(e.get("constraints")[0]),r=this.typeNodes,i=r.length-1;i>=0;i--){var o=r[i];if(n.equal(o))return o}return r.push(n),n},__createEqualityNode:function(t,e){return this.__checkEqual(new w(e)).addRule(t)},__createPropertyNode:function(t,e){return this.__checkEqual(new C(e)).addRule(t)},__createAliasNode:function(t,e){return this.__checkEqual(new E(e)).addRule(t)},__createAdapterNode:function(t,e){return("left"===e?new I:new O).addRule(t)},__createJoinNode:function(t,e,n,i){var o;e.rightPattern instanceof d?o=new k:e.rightPattern instanceof p?o=new N(e.rightPattern,this.workingMemory):e.rightPattern instanceof l?o=new M:e.rightPattern instanceof f?o=new L(e.rightPattern,this.workingMemory):e.rightPattern instanceof h?o=new T(e.rightPattern,this.workingMemory):e instanceof g&&!r(e.leftPattern)&&!r(e.rightPattern)?(o=new x,this.joinNodes.push(o)):(o=new b,this.joinNodes.push(o)),o.__rule__=t;var s=o;if(n instanceof x){var a=this.__createAdapterNode(t,i);s.addOutNode(a,e),s=a}return s.addOutNode(n,e),o.addRule(t)},__addToNetwork:function(t,e,n,r){e instanceof u?e instanceof _||r&&"left"!==r?this.__createAlphaNode(t,e,n,r):this.__createBetaNode(t,new g(new _,e),n,r):e instanceof g&&this.__createBetaNode(t,e,n,r)},__createBetaNode:function(t,e,n,r){var i=this.__createJoinNode(t,e,n,r);return this.__addToNetwork(t,e.rightPattern,i,"right"),this.__addToNetwork(t,e.leftPattern,i,"left"),n.addParentNode(i),i},__createAlphaNode:function(t,e,n,r){var i,o;if(!(e instanceof h)){var s=e.get("constraints");i=this.__createTypeNode(t,e);var a=this.__createAliasNode(t,e);i.addOutNode(a,e),a.addParentNode(i),o=a;for(var c=s.length-1;c>0;c--){var u,f=s[c];if(f instanceof v)u=this.__createPropertyNode(t,f);else{if(f instanceof m){n.constraint.addConstraint(f);continue}u=this.__createEqualityNode(t,f)}o.addOutNode(u,e),u.addParentNode(o),o=u}if(n instanceof x){var l=this.__createAdapterNode(t,r);l.addParentNode(o),o.addOutNode(l,e),o=l}return n.addParentNode(o),o.addOutNode(n,e),i}},print:function(){o(this.terminalNodes,function(t){t.print("    ")})}}}).as(n,"RootNode")},{"../constraint":8,"../extended":12,"../pattern.js":48,"./aliasNode":19,"./betaNode":21,"./equalityNode":22,"./existsFromNode":23,"./existsNode":24,"./fromNode":25,"./fromNotNode":26,"./joinNode":28,"./leftAdapterNode":30,"./notNode":38,"./propertyNode":39,"./rightAdapterNode":40,"./terminalNode":41,"./typeNode":42}],28:[function(t,e,n){var r=t("./betaNode"),i=t("./joinReferenceNode");r.extend({instance:{constructor:function(){this._super(arguments),this.constraint=new i(this.leftTuples,this.rightTuples)},nodeType:"JoinNode",propagateFromLeft:function(t,e){var n;return(n=this.constraint.match(t,e)).isMatch&&this.__propagate("assert",this.__addToMemoryMatches(e,t,t.clone(null,null,n))),this},propagateFromRight:function(t,e){var n;return(n=this.constraint.match(e,t)).isMatch&&this.__propagate("assert",this.__addToMemoryMatches(t,e,t.clone(null,null,n))),this},propagateAssertModifyFromLeft:function(t,e,n){var r,i=n.hashCode;i in e?(r=this.constraint.match(t,n)).isMatch?this.__propagate("modify",this.__addToMemoryMatches(n,t,t.clone(null,null,r))):this.__propagate("retract",e[i].clone()):this.propagateFromLeft(t,n)},propagateAssertModifyFromRight:function(t,e,n){var r,i=n.hashCode;i in e?(r=this.constraint.match(n,t)).isMatch?this.__propagate("modify",this.__addToMemoryMatches(t,n,t.clone(null,null,r))):this.__propagate("retract",e[i].clone()):this.propagateFromRight(t,n)}}}).as(e)},{"./betaNode":21,"./joinReferenceNode":29}],29:[function(t,e,n){function r(t,e,n){return t===e[1]&&(n=c[n]),n}function i(t,e,n){return t===e[1]&&(n=c[n]),n}var o=t("./node"),s=t("../constraint").ReferenceEqualityConstraint,a={isDefault:!0,assert:function(){return!0},equal:function(){return!1}},c={gt:"lte",gte:"lte",lt:"gte",lte:"gte",eq:"eq",neq:"neq"};o.extend({instance:{constraint:a,constructor:function(t,e){this._super(arguments),this.constraint=a,this.constraintAssert=a.assert,this.rightIndexes=[],this.leftIndexes=[],this.constraintLength=0,this.leftMemory=t,this.rightMemory=e},addConstraint:function(t){if(t instanceof s){var e=t.getIndexableProperties(),n=t.get("alias");if(2===e.length&&n){for(var o,a,c=-1,u=[];++c<2;){var h=e[c];null===h.match(new RegExp("^"+n+"(\\.?)"))?(u.push(h),o=h):(u.push(h),a=h)}if(o&&a){var f=i(o,u,t.op),l=r(a,u,t.op);this.rightMemory.addIndex(a,o,l),this.leftMemory.addIndex(o,a,f)}}}this.constraint.isDefault?(this.constraint=t,this.isDefault=!1):this.constraint=this.constraint.merge(t),this.constraintAssert=this.constraint.assert},equal:function(t){return this.constraint.equal(t.constraint)},isMatch:function(t,e){return this.constraintAssert(t.factHash,e.factHash)},match:function(t,e){var n={isMatch:!1};return this.constraintAssert(t.factHash,e.factHash)&&(n=t.match.merge(e.match)),n}}}).as(e)},{"../constraint":8,"./node":37}],30:[function(t,e,n){t("./adapterNode").extend({instance:{propagateAssert:function(t){this.__propagate("assertLeft",t)},propagateRetract:function(t){this.__propagate("retractLeft",t)},propagateResolve:function(t){this.__propagate("retractResolve",t)},propagateModify:function(t){this.__propagate("modifyLeft",t)},retractResolve:function(t){this.__propagate("retractResolve",t)},dispose:function(t){this.propagateDispose(t)},toString:function(){return"LeftAdapterNode "+this.__count}}}).as(e)},{"./adapterNode":18}],31:[function(t,e,n){n.getMemory=function(){function t(t,e,n){if(h===n)r(t,e);else if(n>s)for(var i,o,a=0,f=-1;++f<n;)!c[o=(i=e[f]).hashCode]&&u[o]&&(t[a++]=i);s=0,c={},h=0,u={}}function e(e,n){var r=a;return n&&(s||h?(r=[],s?h?t(r,e,n):function(t,e,n){var r,i=0,o=-1;if(n>s)for(;++o<n;)s?c[(r=e[o]).hashCode]?s--:t[i++]=r:t[i++]=e[o];s=0,c={}}(r,e,n):function(t,e,n){var r,i=0,s=-1;if(n>h)for(;h&&++s<n;)u[(r=e[s]).hashCode]&&(t[i++]=r,h--);else o.apply(t,e);h=0,u={}}(r,e,n)):r=e),r}function n(t,e,n){var r;return"gt"===t?r=e.findGT(n):"gte"===t?r=e.findGTE(n):"lt"===t?r=e.findLT(n):"lte"===t&&(r=e.findLTE(n)),r}function r(t,e){if(e)for(var n,r=-1;++r<e;)c[n=t[r].hashCode]||(c[n]=!0,s++)}function i(t,e){if(e)for(var n,r=-1;++r<e;)u[n=t[r].hashCode]||(u[n]=!0,h++)}var o=Array.prototype.push,s=0,a=[],c={},u={},h=0;return function(t,o,s){for(var c,u,h,f,l,p,d,g=-1,_=s.length,y=t.tuples,v=y.length,m=!1,E=t.tables;++g<_&&v;)u=(c=s[g])[3](o),l=E[c[0]],"eq"===(h=c[4])||"seq"===h?(f=l.get(u))?(v=(y=(t=f).tuples).length,E=f.tables):v=(y=a).length:"neq"===h||"sneq"===h?(f=l.get(u))&&(d=(p=f.tuples).length,r(p,d)):m?(d=(p=n(h,l,u)).length)?i(p,d):(y=p,v=d):(v=(y=n(h,l,u)).length,m=!0);return e(y,v)}}()},{}],32:[function(t,e,n){t("./memory").extend({instance:{getLeftMemory:function(t){return this.getMemory(t)}}}).as(e)},{"./memory":33}],33:[function(t,e,n){var r=t("../../extended"),i=r.plucker,o=r.declare,s=t("./helpers").getMemory,a=t("./table"),c=t("./tupleEntry"),u=0;o({instance:{length:0,constructor:function(){this.head=null,this.tail=null,this.indexes=[],this.tables=new c(null,new a,!1)},push:function(t){var e=this.tail,n=this.head,r={data:t,tuples:[],hashCode:u++,prev:e,next:null};return e&&(this.tail.next=r),this.tail=r,n||(this.head=r),this.length++,this.__index(r),this.tables.addNode(r),r},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,this.tables.removeNode(t),this.__removeFromIndex(t),this.length--},forEach:function(t){for(var e={next:this.head};e=e.next;)t(e.data)},toArray:function(){return this.tables.tuples.slice()},clear:function(){this.head=this.tail=null,this.length=0,this.clearIndexes()},clearIndexes:function(){this.tables={},this.indexes.length=0},__index:function(t){for(var e,n,r,i,o,s,u,h=t.data.factHash,f=this.indexes,l=this.tables,p=-1,d=f.length;++p<d;)r=(n=f[p])[2](h),(e=(s=(o=l.tables)[i=n[0]]||(o[i]=new a)).get(r))||(e=new c(r,s,!0),s.set(r,e)),s!==u&&t.tuples.push(e.addNode(t)),u=s,"eq"===n[4]&&(l=e)},__removeFromIndex:function(t){for(var e=t.tuples,n=e.length;--n>=0;)e[n].removeNode(t);t.tuples.length=0},getMemory:function(t){return this.length?s(this.tables,t.factHash,this.indexes):[]},__createIndexTree:function(){(this.tables.tables={})[this.indexes[0][0]]=new a},addIndex:function(t,e,n){this.indexes.push([t,e,i(t),i(e),n||"eq"]),this.indexes.sort(function(t,e){var n=t[4],r=e[4];return n===r?0:n>r?1:n===r?0:-1}),this.__createIndexTree()}}}).as(e)},{"../../extended":12,"./helpers":31,"./table":35,"./tupleEntry":36}],34:[function(t,e,n){t("./memory").extend({instance:{getRightMemory:function(t){return this.getMemory(t)}}}).as(e)},{"./memory":33}],35:[function(t,e,n){function r(t,e){return(t=t.key)==(e=e.key)?0:t>e?1:e>t?-1:1}function i(t,e){return 1===r(t,e)}function o(t,e){return-1!==r(t,e)}function s(t,e){return-1===r(t,e)}function a(t,e){return 1!==r(t,e)}function c(t,e,n){d.key=e;for(var r,i=[],o=0,s=t.__root;;)if(s)s=(p[o++]=s).left;else{if(!(o>0))break;if(!n(r=(s=p[--o]).data,d))break;f.apply(i,r.value.tuples),s=s.right}return p.length=0,i}function u(t,e,n){d.key=e;for(var r,i=[],o=0,s=t.__root;;)if(s)s=(p[o++]=s).right;else{if(!(o>0))break;if(!n(r=(s=p[--o]).data,d))break;f.apply(i,r.value.tuples),s=s.left}return p.length=0,i}var h=t("../../extended"),f=Array.prototype.push,l=h.HashTable,p=[],d={key:null};h.AVLTree.extend({instance:{constructor:function(){this._super([{compare:r}]),this.gtCache=new l,this.gteCache=new l,this.ltCache=new l,this.lteCache=new l,this.hasGTCache=!1,this.hasGTECache=!1,this.hasLTCache=!1,this.hasLTECache=!1},clearCache:function(){this.hasGTCache&&this.gtCache.clear()&&(this.hasGTCache=!1),this.hasGTECache&&this.gteCache.clear()&&(this.hasGTECache=!1),this.hasLTCache&&this.ltCache.clear()&&(this.hasLTCache=!1),this.hasLTECache&&this.lteCache.clear()&&(this.hasLTECache=!1)},contains:function(t){return this._super([{key:t}])},set:function(t,e){this.insert({key:t,value:e}),this.clearCache()},get:function(t){var e=this.find({key:t});return e&&e.value},remove:function(t){return this.clearCache(),this._super([{key:t}])},findGT:function(t){var e=this.gtCache.get(t);return e||(this.hasGTCache=!0,this.gtCache.put(t,e=u(this,t,i))),e},findGTE:function(t){var e=this.gteCache.get(t);return e||(this.hasGTECache=!0,this.gteCache.put(t,e=u(this,t,o))),e},findLT:function(t){var e=this.ltCache.get(t);return e||(this.hasLTCache=!0,this.ltCache.put(t,e=c(this,t,s))),e},findLTE:function(t){var e=this.lteCache.get(t);return e||(this.hasLTECache=!0,this.lteCache.put(t,e=c(this,t,a))),e}}}).as(e)},{"../../extended":12}],36:[function(t,e,n){var r=t("../../extended"),i=r.indexOf,o=0;r.declare({instance:{tuples:null,tupleMap:null,hashCode:null,tables:null,entry:null,constructor:function(t,e,n){this.val=t,this.canRemove=n,this.tuples=[],this.tupleMap={},this.hashCode=o++,this.tables={},this.length=0,this.entry=e},addNode:function(t){return this.tuples[this.length++]=t,this.length>1&&this.entry.clearCache(),this},removeNode:function(t){var e=this.tuples,n=i(e,t);-1!==n&&(e.splice(n,1),this.length--,this.entry.clearCache()),this.canRemove&&!this.length&&this.entry.remove(this.val)}}}).as(e)},{"../../extended":12}],37:[function(t,e,n){var r=t("../extended"),i=r.forEach,o=r.indexOf,s=r.intersection,a=r.declare,c=r.HashTable,u=t("../context"),h=0;a({instance:{constructor:function(){this.nodes=new c,this.rules=[],this.parentNodes=[],this.__count=h++,this.__entrySet=[]},addRule:function(t){return-1===o(this.rules,t)&&this.rules.push(t),this},merge:function(t){t.nodes.forEach(function(e){for(var n=e.value,r=e.key,i=0,o=n.length;o>i;i++)this.addOutNode(r,n[i]);t.nodes.remove(r)},this);for(var e=t.parentNodes,n=0,r=t.parentNodes.l;r>n;n++){var i=e[n];this.addParentNode(i),i.nodes.remove(t)}return this},resolve:function(t,e){return t.hashCode===e.hashCode},print:function(t){console.log(t+this.toString()),i(this.parentNodes,function(e){e.print("    "+t)})},addOutNode:function(t,e){this.nodes.contains(t)||this.nodes.put(t,[]),this.nodes.get(t).push(e),this.__entrySet=this.nodes.entrySet()},addParentNode:function(t){-1===o(this.parentNodes,t)&&this.parentNodes.push(t)},shareable:function(){return!1},__propagate:function(t,e){for(var n,r,i,o=this.__entrySet,a=o.length;--a>-1;)r=(n=o[a]).key,(i=s(n.value,e.paths)).length&&r[t](new u(e.fact,i,e.match))},dispose:function(t){this.propagateDispose(t)},retract:function(t){this.propagateRetract(t)},propagateDispose:function(t,e){e=e||this.nodes;for(var n=this.__entrySet,r=n.length-1;r>=0;r--)n[r].key.dispose(t)},propagateAssert:function(t){this.__propagate("assert",t)},propagateRetract:function(t){this.__propagate("retract",t)},assert:function(t){this.propagateAssert(t)},modify:function(t){this.propagateModify(t)},propagateModify:function(t){this.__propagate("modify",t)}}}).as(e)},{"../context":10,"../extended":12}],38:[function(t,e,n){var r=t("./joinNode"),i=t("../linkedList"),o=t("../context"),s=t("../pattern").InitialFact;r.extend({instance:{nodeType:"NotNode",constructor:function(){this._super(arguments),this.leftTupleMemory={},this.notMatch=new o(new s).match},__cloneContext:function(t){return t.clone(null,null,t.match.merge(this.notMatch))},retractRight:function(t){var e=this.removeFromRightMemory(t).data.blocking;if(e.length){for(var n,r,i=this.constraint,o={next:e.head};o=o.next;){this.removeFromLeftBlockedMemory(n=o.data);var s,a=this.rightTuples.getRightMemory(n),c=a.length;for(s=-1;++s<c;)if(i.isMatch(n,r=a[s].data)){this.blockedContext(n,r),n=null;break}n&&this.notBlockedContext(n,!0)}e.clear()}},blockedContext:function(t,e,n){t.blocker=e,this.removeFromLeftMemory(t),this.addToLeftBlockedMemory(e.blocking.push(t)),n&&this.__propagate("retract",this.__cloneContext(t))},notBlockedContext:function(t,e){this.__addToLeftMemory(t),e&&this.__propagate("assert",this.__cloneContext(t))},propagateFromLeft:function(t){this.notBlockedContext(t,!0)},propagateFromRight:function(t){this.notBlockedContext(t,!0)},blockFromAssertRight:function(t,e){this.blockedContext(t,e,!0)},blockFromAssertLeft:function(t,e){this.blockedContext(t,e,!1)},retractLeft:function(t){var e=this.removeFromLeftMemory(t);if(e)this.__propagate("retract",this.__cloneContext(e=e.data));else if(!this.removeFromLeftBlockedMemory(t))throw new Error},assertLeft:function(t){for(var e,n=this.rightTuples.getRightMemory(t),r=this.constraint,i=-1,o=n.length;++i<o;)r.isMatch(t,e=n[i].data)&&(this.blockFromAssertLeft(t,e),t=null,i=o);t&&this.propagateFromLeft(t)},assertRight:function(t){this.__addToRightMemory(t),t.blocking=new i;for(var e,n=this.leftTuples.getLeftMemory(t).slice(),r=-1,o=n.length,s=this.constraint;++r<o;)s.isMatch(e=n[r].data,t)&&this.blockFromAssertRight(e,t)},addToLeftBlockedMemory:function(t){var e=t.data.hashCode,n=this.leftMemory[e];return this.leftTupleMemory[e]=t,n&&this.leftTuples.remove(n),this},removeFromLeftBlockedMemory:function(t){var e=this.leftTupleMemory[t.hashCode]||null;return e&&(delete this.leftTupleMemory[t.hashCode],e.data.blocker.blocking.remove(e)),e},modifyLeft:function(t){var e,n,r,i,o=this.removeFromLeftMemory(t),s=this.constraint,a=this.rightTuples.getRightMemory(t),c=a.length,u=!1;if(o||(o=this.removeFromLeftBlockedMemory(t),u=!0),!o)throw new Error;if((e=o.data)&&e.blocker&&(i=this.rightMemory[e.blocker.hashCode],e.blocker=null),i&&s.isMatch(t,r=i.data)&&(u||this.__propagate("retract",this.__cloneContext(e)),t.blocker=r,this.addToLeftBlockedMemory(r.blocking.push(t)),t=null),t&&c)for(n=-1;++n<c;)if(s.isMatch(t,r=a[n].data)){u||this.__propagate("retract",this.__cloneContext(e)),this.addToLeftBlockedMemory(r.blocking.push(t)),t.blocker=r,t=null;break}t&&(this.__addToLeftMemory(t),this.__propagate(u?"assert":"modify",this.__cloneContext(t)))},modifyRight:function(t){var e=this.removeFromRightMemory(t);if(!e)throw new Error;var n,r,o,s=e.data,a=this.leftTuples.getLeftMemory(t).slice(),c=a.length,u=this.constraint,h=s.blocking;this.__addToRightMemory(t),t.blocking=new i;for(var f,l={next:h.head};l=l.next;)if((n=l.data).blocker=null,u.isMatch(n,t))n.blocker=t,this.addToLeftBlockedMemory(t.blocking.push(n)),n=null;else{for(n.blocker=null,o=e;o=o.next;)if(u.isMatch(n,f=o.data)){n.blocker=f,this.addToLeftBlockedMemory(f.blocking.push(n)),n=null;break}n&&(this.__addToLeftMemory(n),this.__propagate("assert",this.__cloneContext(n)))}if(c)for(r=-1;++r<c;)u.isMatch(n=a[r].data,t)&&(this.__propagate("retract",this.__cloneContext(n)),this.removeFromLeftMemory(n),this.addToLeftBlockedMemory(t.blocking.push(n)),n.blocker=t)}}}).as(e)},{"../context":10,"../linkedList":16,"../pattern":48,"./joinNode":28}],39:[function(t,e,n){var r=t("./alphaNode"),i=t("../context"),o=t("../extended");r.extend({instance:{constructor:function(){this._super(arguments),this.alias=this.constraint.get("alias"),this.varLength=(this.variables=o(this.constraint.get("variables")).toArray().value()).length},assert:function(t){var e,n=new i(t.fact,t.paths),r=this.variables,o=t.fact.object;n.set(this.alias,o);for(var s=0,a=this.varLength;a>s;s++)n.set((e=r[s])[1],o[e[0]]);this.__propagate("assert",n)},retract:function(t){this.__propagate("retract",new i(t.fact,t.paths))},modify:function(t){var e,n=new i(t.fact,t.paths),r=this.variables,o=t.fact.object;n.set(this.alias,o);for(var s=0,a=this.varLength;a>s;s++)n.set((e=r[s])[1],o[e[0]]);this.__propagate("modify",n)},toString:function(){return"PropertyNode"+this.__count}}}).as(e)},{"../context":10,"../extended":12,"./alphaNode":20}],40:[function(t,e,n){t("./adapterNode").extend({instance:{retractResolve:function(t){this.__propagate("retractResolve",t)},dispose:function(t){this.propagateDispose(t)},propagateAssert:function(t){this.__propagate("assertRight",t)},propagateRetract:function(t){this.__propagate("retractRight",t)},propagateResolve:function(t){this.__propagate("retractResolve",t)},propagateModify:function(t){this.__propagate("modifyRight",t)},toString:function(){return"RightAdapterNode "+this.__count}}}).as(e)},{"./adapterNode":18}],41:[function(t,e,n){var r=t("./node"),i=t("../extended").bind;r.extend({instance:{constructor:function(t,e,n,r){this._super([]),this.resolve=i(this,this.resolve),this.rule=n,this.index=e,this.name=this.rule.name,this.agenda=r,this.bucket=t,r.register(this)},__assertModify:function(t){var e=t.match;if(e.isMatch){var n=this.rule,r=this.bucket;this.agenda.insert(this,{rule:n,hashCode:t.hashCode,index:this.index,name:n.name,recency:r.recency++,match:e,counter:r.counter})}},assert:function(t){this.__assertModify(t)},modify:function(t){this.agenda.retract(this,t),this.__assertModify(t)},retract:function(t){this.agenda.retract(this,t)},retractRight:function(t){this.agenda.retract(this,t)},retractLeft:function(t){this.agenda.retract(this,t)},assertLeft:function(t){this.__assertModify(t)},assertRight:function(t){this.__assertModify(t)},toString:function(){return"TerminalNode "+this.rule.name}}}).as(e)},{"../extended":12,"./node":37}],42:[function(t,e,n){var r=t("./alphaNode"),i=t("../context");r.extend({instance:{assert:function(t){this.constraintAssert(t.object)&&this.__propagate("assert",t)},modify:function(t){this.constraintAssert(t.object)&&this.__propagate("modify",t)},retract:function(t){this.constraintAssert(t.object)&&this.__propagate("retract",t)},toString:function(){return"TypeNode"+this.__count},dispose:function(){for(var t=this.__entrySet,e=t.length-1;e>=0;e--){var n=t[e];n.key.dispose({paths:n.value})}},__propagate:function(t,e){for(var n=this.__entrySet,r=-1,o=n.length;++r<o;){var s=n[r];s.key[t](new i(e,s.value))}}}}).as(e)},{"../context":10,"./alphaNode":20}],43:[function(t,e,n){var r=t("__browserify_process"),i=function(){function t(){this.yy={}}var e=function(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n},n=[1,29],r=[1,30],i=[1,26],o=[1,24],s=[1,16],a=[1,18],c=[1,19],u=[1,20],h=[1,21],f=[1,22],l=[5,38,49],p=[1,33],d=[5,36,38,49],g=[5,8,11,12,13,15,17,19,20,21,22,24,25,26,27,28,29,36,38,49],_=[2,2],y=[5,24,25,26,27,28,29,36,38,49],v=[1,42],m=[1,43],E=[1,44],w=[1,45],b=[5,8,11,12,13,15,17,19,20,21,22,24,25,26,27,28,29,31,33,36,38,40,46,49],x=[1,46],k=[1,47],T=[1,48],L=[5,19,20,21,22,24,25,26,27,28,29,36,38,49],M=[1,50],N=[5,8,11,12,13,15,17,19,20,21,22,24,25,26,27,28,29,31,33,36,38,40,43,44,46,48,49],I=[5,17,19,20,21,22,24,25,26,27,28,29,36,38,49],O=[1,55],S=[1,54],A=[5,8,15,17,19,20,21,22,24,25,26,27,28,29,36,38,49],C=[1,56],R=[1,57],j=[1,58],F=[1,87],D=[40,46,49],P={trace:function(){},yy:{},symbols_:{error:2,expressions:3,EXPRESSION:4,EOF:5,UNARY_EXPRESSION:6,LITERAL_EXPRESSION:7,"-":8,"!":9,MULTIPLICATIVE_EXPRESSION:10,"*":11,"/":12,"%":13,ADDITIVE_EXPRESSION:14,"+":15,EXPONENT_EXPRESSION:16,"^":17,RELATIONAL_EXPRESSION:18,"<":19,">":20,"<=":21,">=":22,EQUALITY_EXPRESSION:23,"==":24,"===":25,"!=":26,"!==":27,"=~":28,"!=~":29,IN_EXPRESSION:30,in:31,ARRAY_EXPRESSION:32,notIn:33,OBJECT_EXPRESSION:34,AND_EXPRESSION:35,"&&":36,OR_EXPRESSION:37,"||":38,ARGUMENT_LIST:39,",":40,IDENTIFIER_EXPRESSION:41,IDENTIFIER:42,".":43,"[":44,STRING_EXPRESSION:45,"]":46,NUMBER_EXPRESSION:47,"(":48,")":49,STRING:50,NUMBER:51,REGEXP_EXPRESSION:52,REGEXP:53,BOOLEAN_EXPRESSION:54,BOOLEAN:55,NULL_EXPRESSION:56,NULL:57,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"-",9:"!",11:"*",12:"/",13:"%",15:"+",17:"^",19:"<",20:">",21:"<=",22:">=",24:"==",25:"===",26:"!=",27:"!==",28:"=~",29:"!=~",31:"in",33:"notIn",36:"&&",38:"||",40:",",42:"IDENTIFIER",43:".",44:"[",46:"]",48:"(",49:")",50:"STRING",51:"NUMBER",53:"REGEXP",55:"BOOLEAN",57:"NULL"},productions_:[0,[3,2],[6,1],[6,2],[6,2],[10,1],[10,3],[10,3],[10,3],[14,1],[14,3],[14,3],[16,1],[16,3],[18,1],[18,3],[18,3],[18,3],[18,3],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[30,1],[30,3],[30,3],[30,3],[30,3],[35,1],[35,3],[37,1],[37,3],[39,1],[39,3],[41,1],[34,1],[34,3],[34,4],[34,4],[34,4],[34,3],[34,4],[45,1],[47,1],[52,1],[54,1],[56,1],[32,2],[32,3],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,3],[4,1]],performAction:function(t,e,n,r,i,o,s){var a=o.length-1;switch(i){case 1:return o[a-1];case 3:this.$=[o[a],null,"unary"];break;case 4:this.$=[o[a],null,"logicalNot"];break;case 6:this.$=[o[a-2],o[a],"mult"];break;case 7:this.$=[o[a-2],o[a],"div"];break;case 8:this.$=[o[a-2],o[a],"mod"];break;case 10:this.$=[o[a-2],o[a],"plus"];break;case 11:this.$=[o[a-2],o[a],"minus"];break;case 13:this.$=[o[a-2],o[a],"pow"];break;case 15:this.$=[o[a-2],o[a],"lt"];break;case 16:this.$=[o[a-2],o[a],"gt"];break;case 17:this.$=[o[a-2],o[a],"lte"];break;case 18:this.$=[o[a-2],o[a],"gte"];break;case 20:this.$=[o[a-2],o[a],"eq"];break;case 21:this.$=[o[a-2],o[a],"seq"];break;case 22:this.$=[o[a-2],o[a],"neq"];break;case 23:this.$=[o[a-2],o[a],"sneq"];break;case 24:this.$=[o[a-2],o[a],"like"];break;case 25:this.$=[o[a-2],o[a],"notLike"];break;case 27:case 29:this.$=[o[a-2],o[a],"in"];break;case 28:case 30:this.$=[o[a-2],o[a],"notIn"];break;case 32:this.$=[o[a-2],o[a],"and"];break;case 34:this.$=[o[a-2],o[a],"or"];break;case 36:this.$=[o[a-2],o[a],"arguments"];break;case 37:this.$=[String(t),null,"identifier"];break;case 39:this.$=[o[a-2],o[a],"prop"];break;case 40:case 41:case 42:this.$=[o[a-3],o[a-1],"propLookup"];break;case 43:this.$=[o[a-2],[null,null,"arguments"],"function"];break;case 44:this.$=[o[a-3],o[a-1],"function"];break;case 45:this.$=[String(t.replace(/^['|"]|['|"]$/g,"")),null,"string"];break;case 46:this.$=[Number(t),null,"number"];break;case 47:this.$=[t,null,"regexp"];break;case 48:this.$=["true"==t.replace(/^\s+/,""),null,"boolean"];break;case 49:this.$=[null,null,"null"];break;case 50:this.$=[null,null,"array"];break;case 51:this.$=[o[a-1],null,"array"];break;case 59:this.$=[o[a-1],null,"composite"]}},table:[{3:1,4:2,6:28,7:7,8:n,9:r,10:27,14:25,16:17,18:8,23:6,30:5,32:15,34:14,35:4,37:3,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{1:[3]},{5:[1,31]},e([5,49],[2,60],{38:[1,32]}),e(l,[2,33],{36:p}),e(d,[2,31]),e(d,[2,26],{24:[1,34],25:[1,35],26:[1,36],27:[1,37],28:[1,38],29:[1,39]}),e(g,_,{31:[1,40],33:[1,41]}),e(y,[2,19],{19:v,20:m,21:E,22:w}),e(b,[2,52]),e(b,[2,53]),e(b,[2,54]),e(b,[2,55]),e(b,[2,56]),e(b,[2,57],{43:x,44:k,48:T}),e(b,[2,58]),{4:49,6:28,7:7,8:n,9:r,10:27,14:25,16:17,18:8,23:6,30:5,32:15,34:14,35:4,37:3,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},e(L,[2,14],{17:M}),e(b,[2,45]),e(b,[2,46]),e(b,[2,47]),e(b,[2,48]),e(b,[2,49]),e(N,[2,38]),{7:53,32:15,34:14,39:52,41:23,42:i,44:o,45:9,46:[1,51],47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},e(I,[2,12],{8:O,15:S}),e(N,[2,37]),e(A,[2,9],{11:C,12:R,13:j}),e(g,[2,5]),{6:59,7:60,8:n,9:r,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:61,7:60,8:n,9:r,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{1:[2,1]},{6:28,7:7,8:n,9:r,10:27,14:25,16:17,18:8,23:6,30:5,32:15,34:14,35:62,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:7,8:n,9:r,10:27,14:25,16:17,18:8,23:6,30:63,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:17,18:64,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:17,18:65,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:17,18:66,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:17,18:67,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:17,18:68,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:17,18:69,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{32:70,34:71,41:23,42:i,44:o},{32:72,34:73,41:23,42:i,44:o},{6:28,7:60,8:n,9:r,10:27,14:25,16:74,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:75,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:76,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:27,14:25,16:77,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{41:78,42:i},{34:81,41:23,42:i,45:79,47:80,50:a,51:c},{7:53,32:15,34:14,39:83,41:23,42:i,44:o,45:9,47:10,48:s,49:[1,82],50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{49:[1,84]},{6:28,7:60,8:n,9:r,10:27,14:85,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},e(b,[2,50]),{40:F,46:[1,86]},e(D,[2,35]),{6:28,7:60,8:n,9:r,10:88,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:28,7:60,8:n,9:r,10:89,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:90,7:60,8:n,9:r,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:91,7:60,8:n,9:r,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},{6:92,7:60,8:n,9:r,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},e(g,[2,3]),e(g,_),e(g,[2,4]),e(l,[2,34],{36:p}),e(d,[2,32]),e(y,[2,20],{19:v,20:m,21:E,22:w}),e(y,[2,21],{19:v,20:m,21:E,22:w}),e(y,[2,22],{19:v,20:m,21:E,22:w}),e(y,[2,23],{19:v,20:m,21:E,22:w}),e(y,[2,24],{19:v,20:m,21:E,22:w}),e(y,[2,25],{19:v,20:m,21:E,22:w}),e(d,[2,27]),e(d,[2,29],{43:x,44:k,48:T}),e(d,[2,28]),e(d,[2,30],{43:x,44:k,48:T}),e(L,[2,15],{17:M}),e(L,[2,16],{17:M}),e(L,[2,17],{17:M}),e(L,[2,18],{17:M}),e(N,[2,39]),{46:[1,93]},{46:[1,94]},{43:x,44:k,46:[1,95],48:T},e(N,[2,43]),{40:F,49:[1,96]},e(b,[2,59]),e(I,[2,13],{8:O,15:S}),e(b,[2,51]),{7:97,32:15,34:14,41:23,42:i,44:o,45:9,47:10,48:s,50:a,51:c,52:11,53:u,54:12,55:h,56:13,57:f},e(A,[2,10],{11:C,12:R,13:j}),e(A,[2,11],{11:C,12:R,13:j}),e(g,[2,6]),e(g,[2,7]),e(g,[2,8]),e(N,[2,40]),e(N,[2,41]),e(N,[2,42]),e(N,[2,44]),e(D,[2,36])],defaultActions:{31:[2,1]},parseError:function(t,e){function n(t,e){this.message=t,this.hash=e}if(!e.recoverable)throw n.prototype=Error,new n(t,e);this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],i=[],o=this.table,s="",a=0,c=0,u=0,h=i.slice.call(arguments,1),f=Object.create(this.lexer),l={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(l.yy[p]=this.yy[p]);f.setInput(t,l.yy),l.yy.lexer=f,l.yy.parser=this,void 0===f.yylloc&&(f.yylloc={});var d=f.yylloc;i.push(d);var g=f.options&&f.options.ranges;this.parseError="function"==typeof l.yy.parseError?l.yy.parseError:Object.getPrototypeOf(this).parseError;for(var _,y,v,m,E,w,b,x,k=function(){var t;return"number"!=typeof(t=f.lex()||1)&&(t=e.symbols_[t]||t),t},T={};;){if(this.defaultActions[v=n[n.length-1]]?m=this.defaultActions[v]:(null==_&&(_=k()),m=o[v]&&o[v][_]),void 0===m||!m.length||!m[0]){var L;for(w in x=[],o[v])this.terminals_[w]&&w>2&&x.push("'"+this.terminals_[w]+"'");L=f.showPosition?"Parse error on line "+(a+1)+":\n"+f.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[_]||_)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==_?"end of input":"'"+(this.terminals_[_]||_)+"'"),this.parseError(L,{text:f.match,token:this.terminals_[_]||_,line:f.yylineno,loc:d,expected:x})}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+_);switch(m[0]){case 1:n.push(_),r.push(f.yytext),i.push(f.yylloc),n.push(m[1]),_=null,y?(_=y,y=null):(c=f.yyleng,s=f.yytext,a=f.yylineno,d=f.yylloc,u>0&&u--);break;case 2:if(T.$=r[r.length-(b=this.productions_[m[1]][1])],T._$={first_line:i[i.length-(b||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(b||1)].first_column,last_column:i[i.length-1].last_column},g&&(T._$.range=[i[i.length-(b||1)].range[0],i[i.length-1].range[1]]),void 0!==(E=this.performAction.apply(T,[s,c,a,l.yy,m[1],r,i].concat(h))))return E;b&&(n=n.slice(0,-1*b*2),r=r.slice(0,-1*b),i=i.slice(0,-1*b)),n.push(this.productions_[m[1]][0]),r.push(T.$),i.push(T._$),n.push(o[n[n.length-2]][n[n.length-1]]);break;case 3:return!0}}return!0}};return P.lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((n=this._input.match(this.rules[i[o]]))&&(!e||n[0].length>e[0].length)){if(e=n,r=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[o])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:return 31;case 1:return 33;case 2:return"from";case 3:return 24;case 4:return 25;case 5:return 26;case 6:return 27;case 7:return 21;case 8:return 19;case 9:return 22;case 10:return 20;case 11:return 28;case 12:return 29;case 13:return 36;case 14:return 38;case 15:return 57;case 16:return 55;case 17:break;case 18:return 51;case 19:case 20:return 50;case 21:return 42;case 22:return 53;case 23:return 43;case 24:return 11;case 25:return 12;case 26:return 13;case 27:return 40;case 28:return 8;case 29:return 28;case 30:return 29;case 31:return 25;case 32:return 24;case 33:return 27;case 34:return 26;case 35:return 21;case 36:return 22;case 37:return 20;case 38:return 19;case 39:return 36;case 40:return 38;case 41:return 15;case 42:return 17;case 43:return 48;case 44:return 46;case 45:return 44;case 46:return 49;case 47:return 9;case 48:return 5}},rules:[/^(?:\s+in\b)/,/^(?:\s+notIn\b)/,/^(?:\s+from\b)/,/^(?:\s+(eq|EQ)\b)/,/^(?:\s+(seq|SEQ)\b)/,/^(?:\s+(neq|NEQ)\b)/,/^(?:\s+(sneq|SNEQ)\b)/,/^(?:\s+(lte|LTE)\b)/,/^(?:\s+(lt|LT)\b)/,/^(?:\s+(gte|GTE)\b)/,/^(?:\s+(gt|GT)\b)/,/^(?:\s+(like|LIKE)\b)/,/^(?:\s+(notLike|NOT_LIKE)\b)/,/^(?:\s+(and|AND)\b)/,/^(?:\s+(or|OR)\b)/,/^(?:\s*(null)\b)/,/^(?:\s*(true|false)\b)/,/^(?:\s+)/,/^(?:-?[0-9]+(?:\.[0-9]+)?\b)/,/^(?:'[^']*')/,/^(?:"[^"]*")/,/^(?:([a-zA-Z_$][0-9a-zA-Z_$]*))/,/^(?:^\/((?![\s=])[^[\/\n\\]*(?:(?:\\[\s\S]|\[[^\]\n\\]*(?:\\[\s\S][^\]\n\\]*)*])[^[\/\n\\]*)*\/[imgy]{0,4})(?!\w))/,/^(?:\.)/,/^(?:\*)/,/^(?:\/)/,/^(?:\%)/,/^(?:,)/,/^(?:-)/,/^(?:=~)/,/^(?:!=~)/,/^(?:===)/,/^(?:==)/,/^(?:!==)/,/^(?:!=)/,/^(?:<=)/,/^(?:>=)/,/^(?:>)/,/^(?:<)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\])/,/^(?:\[)/,/^(?:\))/,/^(?:!)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48],inclusive:!0}}},t.prototype=P,P.Parser=t,new t}();void 0!==t&&void 0!==n&&(n.parser=i,n.Parser=i.Parser,n.parse=function(){return i.parse.apply(i,arguments)},n.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),r.exit(1));var i=t("fs").readFileSync(t("path").normalize(e[1]),"utf8");return n.parser.parse(i)},void 0!==e&&t.main===e&&n.main(r.argv.slice(1)))},{__browserify_process:64,fs:61,path:62}],44:[function(t,e,n){!function(){"use strict";var e=t("./constraint/parser"),r=t("./nools/nool.parser");n.parseConstraint=function(t){try{return e.parse(t)}catch(n){throw new Error("Invalid expression '"+t+"'")}},n.parseRuleSet=function(t,e){return r.parse(t,e)}}()},{"./constraint/parser":43,"./nools/nool.parser":45}],45:[function(t,e,n){"use strict";var r=t("./tokens.js"),i=t("../../extended").hash.keys,o=t("./util.js"),s=function(t,e,n){var r=t;t=t.replace(/\/\/(.*)/g,"").replace(/\r\n|\r|\n/g," ");for(var a,c=new RegExp("^("+i(e).join("|")+")");t&&-1!==(a=o.findNextTokenIndex(t));){var u=(t=t.substr(a)).match(c);if(null===u)throw new Error("Error parsing "+t);if(!((u=u[1])in e))throw new Error("Unknown token"+u);try{t=e[u](t,n,s).replace(/^\s*|\s*$/g,"")}catch(h){throw new Error("Invalid "+u+" definition \n"+h.message+"; \nstarting at : "+r)}}};n.parse=function(t,e){var n={define:[],rules:[],scope:[],loaded:[],file:e};return s(t,r,n),n}},{"../../extended":12,"./tokens.js":46,"./util.js":47}],46:[function(require,module,exports){var process=require("__browserify_process"),utils=require("./util.js"),fs=require("fs"),extd=require("../../extended"),filter=extd.filter,indexOf=extd.indexOf,predicates=["not","or","exists"],predicateRegExp=new RegExp("^("+predicates.join("|")+") *\\((.*)\\)$","m"),predicateBeginExp=new RegExp(" *("+predicates.join("|")+") *\\(","g"),isWhiteSpace=function(t){return 0===t.replace(/[\s|\n|\r|\t]/g,"").length},joinFunc=function(t,e){return"; "+e},splitRuleLineByPredicateExpressions=function(t){var e=t.replace(/,\s*(\$?\w+\s*:)/g,joinFunc),n=filter(e.split(predicateBeginExp),function(t){return""!==t}),r=n.length,i=[];if(!r)return e;for(var o=0;r>o;o++)-1!==indexOf(predicates,n[o])?i.push([n[o],"(",n[++o].replace(/, *$/,"")].join("")):i.push(n[o].replace(/, *$/,""));return i.join(";")},ruleTokens={salience:(a=/^(salience|priority)\s*:\s*(-?\d+)\s*[,;]?/,function(t,e){if(a.test(t)){var n=t.match(a),r=parseInt(n[2],10);if(isNaN(r))throw new Error("Invalid salience/priority "+n[2]);return e.options.priority=r,t.replace(n[0],"")}throw new Error("invalid format")}),agendaGroup:function(){var t=/^(agenda-group|agendaGroup)\s*:\s*([a-zA-Z_$][0-9a-zA-Z_$]*|"[^"]*"|'[^']*')\s*[,;]?/;return function(e,n){if(t.test(e)){var r=e.match(t),i=r[2];if(!i)throw new Error("Invalid agenda-group "+r[2]);return n.options.agendaGroup=i.replace(/^["']|["']$/g,""),e.replace(r[0],"")}throw new Error("invalid format")}}(),autoFocus:function(){var t=/^(auto-focus|autoFocus)\s*:\s*(true|false)\s*[,;]?/;return function(e,n){if(t.test(e)){var r=e.match(t),i=r[2];if(!i)throw new Error("Invalid auto-focus "+r[2]);return n.options.autoFocus="true"===i,e.replace(r[0],"")}throw new Error("invalid format")}}(),"agenda-group":function(){return this.agendaGroup.apply(this,arguments)},"auto-focus":function(){return this.autoFocus.apply(this,arguments)},priority:function(){return this.salience.apply(this,arguments)},when:function(){var ruleRegExp=/^(\$?\w+) *: *(\w+)(.*)/,constraintRegExp=/(\{ *(?:["']?\$?\w+["']?\s*:\s*["']?\$?\w+["']? *(?:, *["']?\$?\w+["']?\s*:\s*["']?\$?\w+["']?)*)+ *\})/,fromRegExp=/(\bfrom\s+.*)/,parseRules=function(str){for(var rules=[],ruleLines=str.split(";"),l=ruleLines.length,ruleLine,i=0;l>i&&(ruleLine=ruleLines[i].replace(/^\s*|\s*$/g,"").replace(/\n/g,""));i++)if(!isWhiteSpace(ruleLine)){var rule=[];if(predicateRegExp.test(ruleLine)){var m=ruleLine.match(predicateRegExp),pred=m[1].replace(/^\s*|\s*$/g,"");if(rule.push(pred),ruleLine=m[2].replace(/^\s*|\s*$/g,""),"or"===pred){rule=rule.concat(parseRules(splitRuleLineByPredicateExpressions(ruleLine))),rules.push(rule);continue}}var parts=ruleLine.match(ruleRegExp);if(!parts||!parts.length)throw new Error("Invalid constraint "+ruleLine);rule.push(parts[2],parts[1]);var constraints=parts[3].replace(/^\s*|\s*$/g,""),hashParts=constraints.match(constraintRegExp),from=null,fromMatch;if(hashParts){var hash=hashParts[1],constraint=constraints.replace(hash,"");fromRegExp.test(constraint)&&(fromMatch=constraint.match(fromRegExp),from=fromMatch[0],constraint=constraint.replace(fromMatch[0],"")),constraint&&rule.push(constraint.replace(/^\s*|\s*$/g,"")),hash&&rule.push(eval("("+hash.replace(/(\$?\w+)\s*:\s*(\$?\w+)/g,'"$1" : "$2"')+")"))}else constraints&&!isWhiteSpace(constraints)&&(fromRegExp.test(constraints)&&(fromMatch=constraints.match(fromRegExp),from=fromMatch[0],constraints=constraints.replace(fromMatch[0],"")),rule.push(constraints));from&&rule.push(from),rules.push(rule)}return rules};return function(t,e){var n=t.replace(/^when\s*/,"").replace(/^\s*|\s*$/g,"");if("{"===utils.findNextToken(n)){var r=utils.getTokensBetween(n,"{","}",!0).join("");return n=n.replace(r,""),e.constraints=parseRules(r.replace(/^\{\s*|\}\s*$/g,"")),n}throw new Error("unexpected token : expected : '{' found : '"+utils.findNextToken(n)+"'")}}(),then:function(t,e){if(e.action)throw new Error("action already defined for rule"+e.name);var n=t.replace(/^then\s*/,"").replace(/^\s*|\s*$/g,"");if("{"===utils.findNextToken(n)){var r=utils.getTokensBetween(n,"{","}",!0).join("");if(n=n.replace(r,""),e.action||(e.action=r.replace(/^\{\s*|\}\s*$/g,"")),!isWhiteSpace(n))throw new Error("Error parsing then block "+t);return n}throw new Error("unexpected token : expected : '{' found : '"+utils.findNextToken(n)+"'")}},topLevelTokens={"/":function(t){return t.match(/^\/\*/)?t.replace(/\/\*.*?\*\//,""):t},define:function(t,e){var n=t.replace(/^define\s*/,""),r=n.match(/^([a-zA-Z_$][0-9a-zA-Z_$]*)/);if(r){if(n=n.replace(r[0],"").replace(/^\s*|\s*$/g,""),"{"===utils.findNextToken(n)){r=r[1];var i=utils.getTokensBetween(n,"{","}",!0).join("");return n=n.replace(i,""),e.define.push({name:r,properties:"("+i+")"}),n}throw new Error("unexpected token : expected : '{' found : '"+utils.findNextToken(n)+"'")}throw new Error("missing name")},import:function(t,e,n){if("undefined"!=typeof window)throw new Error("import cannot be used in a browser");var r=t.replace(/^import\s*/,"");if("("===utils.findNextToken(r)){var i=utils.getParamList(r);if(r=r.replace(i,"").replace(/^\s*|\s*$/g,""),";"===utils.findNextToken(r)&&(r=r.replace(/\s*;/,"")),1===(i=i.replace(/[\(|\)]/g,"").split(",")).length){if(i=utils.resolve(e.file||process.cwd(),i[0].replace(/["|']/g,"")),-1===indexOf(e.loaded,i)){var o=e.file;e.file=i,n(fs.readFileSync(i,"utf8"),topLevelTokens,e),e.loaded.push(i),e.file=o}return r}throw new Error("import accepts a single file")}throw new Error("unexpected token : expected : '(' found : '"+utils.findNextToken(r)+"'")},global:function(t,e){var n=t.replace(/^global\s*/,""),r=n.match(/^([a-zA-Z_$][0-9a-zA-Z_$]*\s*)/);if(r){if(n=n.replace(r[0],"").replace(/^\s*|\s*$/g,""),"="===utils.findNextToken(n)){r=r[1].replace(/^\s+|\s+$/g,"");var i=utils.getTokensBetween(n,"=",";",!0).join(""),o=i.substring(1,i.length-1);if(o=o.replace(/^\s+|\s+$/g,""),/^require\(/.test(o)){var s=utils.getParamList(o.replace("require")).replace(/[\(|\)]/g,"").split(",");1===s.length&&(s=s[0].replace(/["|']/g,""),o=["require('",utils.resolve(e.file||process.cwd(),s),"')"].join(""))}return e.scope.push({name:r,body:o}),n.replace(i,"")}throw new Error("unexpected token : expected : '=' found : '"+utils.findNextToken(n)+"'")}throw new Error("missing name")},function:function(t,e){var n=t.replace(/^function\s*/,""),r=n.match(/^([a-zA-Z_$][0-9a-zA-Z_$]*)\s*/);if(r){if(n=n.replace(r[0],""),"("===utils.findNextToken(n)){r=r[1];var i=utils.getParamList(n);if(n=n.replace(i,"").replace(/^\s*|\s*$/g,""),"{"===utils.findNextToken(n)){var o=utils.getTokensBetween(n,"{","}",!0).join("");return n=n.replace(o,""),e.scope.push({name:r,body:"function"+i+o}),n}throw new Error("unexpected token : expected : '{' found : '"+utils.findNextToken(n)+"'")}throw new Error("unexpected token : expected : '(' found : '"+utils.findNextToken(n)+"'")}throw new Error("missing name")},rule:function(t,e,n){var r=t.replace(/^rule\s*/,""),i=r.match(/^([a-zA-Z_$][0-9a-zA-Z_$]*|"[^"]*"|'[^']*')/);if(i){if(r=r.replace(i[0],"").replace(/^\s*|\s*$/g,""),"{"===utils.findNextToken(r)){var o={name:i=i[1].replace(/^["']|["']$/g,""),options:{},constraints:null,action:null},s=utils.getTokensBetween(r,"{","}",!0).join("");return r=r.replace(s,""),n(s.replace(/^\{\s*|\}\s*$/g,""),ruleTokens,o),e.rules.push(o),r}throw new Error("unexpected token : expected : '{' found : '"+utils.findNextToken(r)+"'")}throw new Error("missing name")}},a;module.exports=topLevelTokens},{"../../extended":12,"./util.js":47,__browserify_process:64,fs:61}],47:[function(t,e,n){var r=t("__browserify_process"),i=t("path"),o=/[\s|\n|\r|\t]/,s=i.sep||("win32"===r.platform?"\\":"/"),a={"{":"}","}":"{","(":")",")":"(","[":"]"},c=n.getTokensBetween=function(t,e,n,r){var i=0,o=[];e||(e=a[n],i=1),n||(n=a[e]),t=Object(t);for(var s,c=!1,u=0,h=!1;s=t.charAt(u++);)if(s===e)i++,c?o.push(s):(c=!0,r&&o.push(s));else if(s===n&&u){if(0==--i){r&&o.push(s),h=!0;break}o.push(s)}else c&&o.push(s);if(!h)throw new Error("Unable to match "+e+" in "+t);return o};n.getParamList=function(t){return c(t,"(",")",!0).join("")},n.resolve=function(t,e){return"win32"===r.platform&&(e=e.replace(/\//g,"\\")),""!==i.extname(t)&&(t=i.dirname(t)),1===e.split(s).length?e:i.resolve(t,e).replace(/\\/g,"/")};var u=n.findNextTokenIndex=function(t,e,n){e=e||0;var r=-1,i=t.length;for((!(n=n||t.length)||n>i)&&(n=i);n>e;e++){var s=t.charAt(e);if(!o.test(s)){r=e;break}}return r};n.findNextToken=function(t,e,n){return t.charAt(u(t,e,n))}},{__browserify_process:64,path:62}],48:[function(t,e,n){"use strict";var r=t("./extended"),i=r.isEmpty,o=r.merge,s=r.forEach,a=r.declare,c=t("./constraintMatcher"),u=t("./constraint"),h=u.EqualityConstraint,f=u.FromConstraint,l=0,p=a({}),d=p.extend({instance:{constructor:function(t,e,n,r,a){a=a||{},this.id=l++,this.type=t,this.alias=e,this.conditions=n,this.pattern=a.pattern;var h=[new u.ObjectConstraint(t)],f=c.toConstraints(n,o({alias:e},a));if(f.length)h=h.concat(f);else{var p=new u.TrueConstraint;h.push(p)}if(r&&!i(r)){var d=new u.HashConstraint(r);h.push(d)}s(h,function(t){t.set("alias",e)}),this.constraints=h},getSpecificity:function(){for(var t=this.constraints,e=0,n=0,r=t.length;r>n;n++)t[n]instanceof h&&e++;return e},hasConstraint:function(t){return r.some(this.constraints,function(e){return e instanceof t})},hashCode:function(){return[this.type,this.alias,r.format("%j",this.conditions)].join(":")},toString:function(){return r.format("%j",this.constraints)}}}).as(n,"ObjectPattern"),g=d.extend({instance:{constructor:function(t,e,n,r,i,o){this._super([t,e,n,r,o]),this.from=new f(i,o)},hasConstraint:function(t){return r.some(this.constraints,function(e){return e instanceof t})},getSpecificity:function(){return this._super(arguments)+1},hashCode:function(){return[this.type,this.alias,r.format("%j",this.conditions),this.from.from].join(":")},toString:function(){return r.format("%j from %s",this.constraints,this.from.from)}}}).as(n,"FromPattern");g.extend().as(n,"FromNotPattern"),d.extend().as(n,"NotPattern"),d.extend().as(n,"ExistsPattern"),g.extend().as(n,"FromExistsPattern"),p.extend({instance:{constructor:function(t,e){this.id=l++,this.leftPattern=t,this.rightPattern=e},hashCode:function(){return[this.leftPattern.hashCode(),this.rightPattern.hashCode()].join(":")},getSpecificity:function(){return this.rightPattern.getSpecificity()+this.leftPattern.getSpecificity()},getters:{constraints:function(){return this.leftPattern.constraints.concat(this.rightPattern.constraints)}}}}).as(n,"CompositePattern");var _=a({instance:{constructor:function(){this.id=l++,this.recency=0}}}).as(n,"InitialFact");d.extend({instance:{constructor:function(){this._super([_,"__i__",[],{}])},assert:function(){return!0}}}).as(n,"InitialFactPattern")},{"./constraint":8,"./constraintMatcher":9,"./extended":12}],49:[function(t,e,n){"use strict";var r=t("./extended"),i=r.isArray,o=r.Promise,s=r.declare,a=r.isHash,c=r.isString,u=r.format,h=t("./parser"),f=t("./pattern"),l=f.ObjectPattern,p=f.FromPattern,d=f.NotPattern,g=f.ExistsPattern,_=f.FromNotPattern,y=f.FromExistsPattern,v=f.CompositePattern,m=function(t){return"function"==typeof t?t:h.parseConstraint(t)},E=r.switcher().isUndefinedOrNull(function(){return null}).isLike(/^from +/,function(t){return{from:t.replace(/^from +/,"").replace(/^\s*|\s*$/g,"")}}).def(function(t){throw new Error("invalid rule constraint option "+t)}).switcher(),w=r.switcher().isLength(1,function(t){throw new Error("invalid rule constraint "+u("%j",[t]))}).isLength(2,function(t){return t.push("true"),t}).isLength(3,function(t){if(c(t[2])&&/^from +/.test(t[2])){var e=t[2];t.splice(2,0,"true"),t[3]=null,t[4]=E(e)}else a(t[2])&&t.splice(2,0,"true");return t}).isLength(4,function(t){return c(t[3])&&(t.splice(3,0,null),t[4]=E(t[4])),t}).def(function(t){return 5===t.length&&(t[4]=E(t[4])),t}).switcher(),b=function(t,e){e=e||{};var n=r.switcher().isEq("string",function(){return String}).isEq("date",function(){return Date}).isEq("array",function(){return Array}).isEq("boolean",function(){return Boolean}).isEq("regexp",function(){return RegExp}).isEq("number",function(){return Number}).isEq("object",function(){return Object}).isEq("hash",function(){return Object}).def(function(t){throw new TypeError("invalid param type "+t)}).switcher();return r.switcher().isString(function(t){return e[t]||n(t.toLowerCase())}).isFunction(function(t){return t}).deepEqual([],function(){return Array}).def(function(t){throw new Error("invalid param type "+t)}).switcher()(t)},x=r.switcher().containsAt("or",0,function(t){return t.shift(),r(t).map(function(e){return e.scope=t.scope,x(e)}).flatten().value()}).containsAt("not",0,function(t){return t.shift(),(t=w(t))[4]&&t[4].from?[new _(b(t[0],t.scope),t[1]||"m",m(t[2]||"true"),t[3]||{},m(t[4].from),{scope:t.scope,pattern:t[2]})]:[new d(b(t[0],t.scope),t[1]||"m",m(t[2]||"true"),t[3]||{},{scope:t.scope,pattern:t[2]})]}).containsAt("exists",0,function(t){return t.shift(),(t=w(t))[4]&&t[4].from?[new y(b(t[0],t.scope),t[1]||"m",m(t[2]||"true"),t[3]||{},m(t[4].from),{scope:t.scope,pattern:t[2]})]:[new g(b(t[0],t.scope),t[1]||"m",m(t[2]||"true"),t[3]||{},{scope:t.scope,pattern:t[2]})]}).def(function(t){return"function"==typeof t?[t]:(t=w(t))[4]&&t[4].from?[new p(b(t[0],t.scope),t[1]||"m",m(t[2]||"true"),t[3]||{},m(t[4].from),{scope:t.scope,pattern:t[2]})]:[new l(b(t[0],t.scope),t[1]||"m",m(t[2]||"true"),t[3]||{},{scope:t.scope,pattern:t[2]})]}).switcher(),k=s({instance:{constructor:function(t,e,n,i){this.name=t,this.pattern=n,this.cb=i,e.agendaGroup&&(this.agendaGroup=e.agendaGroup,this.autoFocus=!!r.isBoolean(e.autoFocus)&&e.autoFocus),this.priority=e.priority||e.salience||0},fire:function(t,e){var n=new o,i=this.cb;try{3===i.length?i.call(t,e.factHash,t,n.resolve):n=i.call(t,e.factHash,t)}catch(r){n.errback(r)}return n}}});n.createRule=function(t,e,n,o){i(e)?(o=n,n=e):e=e||{};var s=r.every(n,function(t){return i(t)});s&&1===n.length&&(n=n[0],s=!1);var a=[],c=e.scope||{};if(n.scope=c,s){for(var u,h=function(t,e){l[e]?r(l).forEach(function(e){e.push(t)}):(l[e]=0===e?[]:l[e-1].slice(),0!==e&&l[e].pop(),l[e].push(t))},f=n.length,l=[],p=0;f>p;p++)(u=n[p]).scope=c,r.forEach(x(u),h);a=r.map(l,function(n){for(var r=null,i=0;i<n.length;i++)r=new v(null===r?n[i++]:r,n[i]);return new k(t,e,r,o)})}else a=r.map(x(n),function(n){return new k(t,e,n,o)});return a}},{"./extended":12,"./parser":44,"./pattern":48}],50:[function(t,e,n){"use strict";var r=t("declare.js"),i=t("./linkedList"),o=t("./pattern").InitialFact,s=0,a=r({instance:{constructor:function(t){this.object=t,this.recency=0,this.id=s++},equals:function(t){return t===this.object},hashCode:function(){return this.id}}});r({instance:{constructor:function(){this.recency=0,this.facts=new i},dispose:function(){this.facts.clear()},getFacts:function(){for(var t,e={next:this.facts.head},n=[],r=0;e=e.next;)(t=e.data.object)instanceof o||(n[r++]=t);return n},getFactsByType:function(t){for(var e={next:this.facts.head},n=[],r=0;e=e.next;){var i=e.data.object;i instanceof o||!(i instanceof t||i.constructor===t)||(n[r++]=i)}return n},getFactHandle:function(t){for(var e,n={next:this.facts.head};n=n.next;){var r=n.data;if(r.equals(t))return r}return e||((e=new a(t)).recency=this.recency++),e},modifyFact:function(t){for(var e={next:this.facts.head};e=e.next;){var n=e.data;if(n.equals(t))return n.recency=this.recency++,n}throw new Error("the fact to modify does not exist")},assertFact:function(t){var e=new a(t);return e.recency=this.recency++,this.facts.push(e),e},retractFact:function(t){for(var e=this.facts,n={next:e.head};n=n.next;){var r=n.data;if(r.equals(t))return e.remove(n),r}throw new Error("the fact to remove does not exist")}}}).as(n,"WorkingMemory")},{"./linkedList":16,"./pattern":48,"declare.js":55}],51:[function(t,e,n){(function(){"use strict";function r(t,e){function n(t,e){var n=-1,r=0,i=t.length,o=[];for(n+=e=e||0;++n<i;)o[r++]=t[n];return o}var r=(Array,e.isArguments);return t.define(r,{toArray:n}).expose({argsToArray:n})}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended"),t("is-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended"],function(t,e){return r(t,e)}):this.argumentsExtended=r(this.extended,this.isExtended)}).call(this)},{extended:56,"is-extended":66}],52:[function(t,e,n){(function(){"use strict";function r(t,e,n){function r(t,e){var n,r,o=[],s=-1;for(r=t.length;++s<r;)-1!==i(e,n=t[s])&&o.push(n);return o}function i(t,e,n){for(var r=(n||0)-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function o(t,e,n){if(t&&M&&M===t.filter)return t.filter(e,n);if(!y(t)||"function"!=typeof e)throw new TypeError;for(var r=Object(t),i=r.length>>>0,o=[],s=0;i>s;s++)if(s in r){var a=r[s];e.call(n,a,s,r)&&o.push(a)}return o}function s(t,e,n){if(!y(t)||"function"!=typeof e)throw new TypeError;if(t&&x&&x===t.forEach)return t.forEach(e,n),t;for(var r=0,i=t.length;i>r;++r)e.call(n||t,t[r],r,t);return t}function a(t,e,n){if(t&&N&&N===t.every)return t.every(e,n);if(!y(t)||"function"!=typeof e)throw new TypeError;for(var r=Object(t),i=r.length>>>0,o=0;i>o;o++)if(o in r&&!e.call(n,r[o],o,r))return!1;return!0}function c(t,e,n){if(t&&k&&k===t.map)return t.map(e,n);if(!y(t)||"function"!=typeof e)throw new TypeError;for(var r=Object(t),i=r.length>>>0,o=[],s=0;i>s;s++)s in r&&o.push(e.call(n,r[s],s,r));return o}function u(t,e,n){if(t&&T&&T===t.reduce)return arguments.length>2?t.reduce(e,n):t.reduce(e);if(!y(t)||"function"!=typeof e)throw new TypeError;var r=0,i=t.length>>0;if(arguments.length<3){if(0===i)throw new TypeError("Array length is 0 and no second argument");n=t[0],r=1}else n=arguments[2];for(;i>r;)r in t&&(n=e.call(void 0,n,t[r],r,t)),++r;return n}function h(t,e,n){if(t&&L&&L===t.reduceRight)return arguments.length>2?t.reduceRight(e,n):t.reduceRight(e);if(!y(t)||"function"!=typeof e)throw new TypeError;var r=Object(t),i=r.length>>>0;if(0===i&&2===arguments.length)throw new TypeError;var o=i-1;if(arguments.length>=3)n=arguments[2];else for(;;)if(o in t){n=t[o--];break}for(;o>=0;)o in r&&(n=e.call(void 0,n,r[o],o,r)),o--;return n}function f(t){var n=[];if(null!==t){var r=O(arguments);if(1===r.length)if(y(t))n=t;else if(e.isHash(t))for(var i in t)t.hasOwnProperty(i)&&n.push([i,t[i]]);else n.push(t);else s(r,function(t){n=n.concat(f(t))})}return n}function l(t){return(t=t||[]).length?u(t,function(t,e){return t+e}):0}function p(t){var e,n=[],r=-1,o=0;if(t)for(e=t.length;++r<e;){var s=t[r];-1===i(n,s)&&(n[o++]=s)}return n}function d(t,e){var n=t.slice();return"number"!=typeof e&&(e=1),e&&y(t)?(e>0?(n.push(n.shift()),e--):(n.unshift(n.pop()),e++),d(n,e)):n}function g(t){var e=O(arguments);return u(e.length>1?e:f(t),function(t,e){return t.concat(e)},[])}var _=e.isString,y=Array.isArray||e.isArray,v=e.isDate,m=Math.floor,E=Math.abs,w=(Math,Math.min),b=Array.prototype,x=b.forEach,k=b.map,T=b.reduce,L=b.reduceRight,M=b.filter,N=b.every,I=b.some,O=n.argsToArray,S=function(){var t=function(t,e){return a(t,e)},e=function(t,e){return t-e},n=function(t,e){return t.getTime()-e.getTime()};return function(r,i){var o=[];return y(r)&&(o=r.slice(),i?o.sort("function"==typeof i?i:function(t,e){var n=t[i],r=e[i];return _(n)&&_(r)?n>r?1:r>n?-1:0:v(n)&&v(r)?n.getTime()-r.getTime():n-r}):t(o,_)?o.sort():t(o,v)?o.sort(n):o.sort(e)),o}}(),A={toArray:f,sum:l,avg:function(t){if((t=t||[]).length){var n=l(t);if(e.isNumber(n))return n/t.length;throw new Error("Cannot average an array of non numbers.")}return 0},sort:function(t,e){return S(t,e)},min:function(t,e){return S(t,e)[0]},max:function(t,e){return S(t,e)[t.length-1]},difference:function(t){var e=t,n=g(O(arguments,1));return y(t)&&(e=o(t,function(t){return-1===i(n,t)})),e},removeDuplicates:p,unique:function(t){return p(t)},rotate:d,permutations:function(t,e){var n=[];if(y(t)){var r=t.slice(0);"number"!=typeof e&&(e=t.length),e?e<=t.length&&(n=u(t,function(t,n,i){var o;return o=e>1?function(t,e,n){for(var r=[],i=0;i<e.length;i++)r.push([t].concat(d(e,i)).slice(0,n));return r}(n,d(r,i).slice(1),e):[[n]],t.concat(o)},[])):n=[[]]}return n},zip:function(){var t=[],n=O(arguments);if(n.length>1){var r=n.shift();y(r)&&(t=u(r,function(t,r,i){for(var o=[r],s=0;s<n.length;s++){var a=n[s];y(a)&&!e.isUndefined(a[i])?o.push(a[i]):o.push(null)}return t.push(o),t},[]))}return t},transpose:function(t){var e,n=[];return y(t)&&t.length&&s(t,function(t){!y(t)||e&&t.length!==e.length||(s(t,function(t,e){n[e]||(n[e]=[]),n[e].push(t)}),e=t)}),n},valuesAt:function(t,e){var n=[];if(t=(e=O(arguments)).shift(),y(t)&&e.length)for(var r=0,i=e.length;i>r;r++)n.push(t[e[r]]||null);return n},union:function(){var t=[],e=O(arguments);if(e.length>1){for(var n=0,r=e.length;r>n;n++)t=t.concat(e[n]);t=p(t)}return t},intersect:function(){var t,e,n=[],i=-1;if(t=arguments.length>1?O(arguments):arguments[0],y(t))for(n=t[0],i=0,e=t.length;++i<e;)n=r(n,t[i]);return p(n)},powerSet:function(t){var e=[];return y(t)&&t.length&&(e=u(t,function(t,e){var n=c(t,function(t){return t.concat(e)});return t.concat(n)},[[]])),e},cartesian:function t(e,n){var r=[];return y(e)&&y(n)&&e.length&&n.length&&(r=function(t,e){return h(e,function(e,n){return y(n)||(n=[n]),n.unshift(t),e.unshift(n),e},[])}(e[0],n).concat(t(e.slice(1),n))),r},compact:function(t){var n=[];return y(t)&&t.length&&(n=o(t,function(t){return!e.isUndefinedOrNull(t)})),n},multiply:function(t,n){(n=e.isNumber(n)?n:1)||(n=1),t=f(t||[]);for(var r=[],i=0;++i<=n;)r=r.concat(t);return r},flatten:g,pluck:function(t,e){e=e.split(".");var n=t.slice(0);return s(e,function(t){var e=t.match(/(\w+)\(\)$/);n=c(n,function(n){return e?n[e[1]]():n[t]})}),n},invoke:function(t,e,n){return n=O(arguments,2),c(t,function(t){return(_(e)?t[e]:e).apply(t,n)})},forEach:s,map:c,filter:o,reduce:u,reduceRight:h,some:function(t,e,n){if(t&&I&&I===t.some)return t.some(e,n);if(!y(t)||"function"!=typeof e)throw new TypeError;for(var r=Object(t),i=r.length>>>0,o=0;i>o;o++)if(o in r&&e.call(n,r[o],o,r))return!0;return!1},every:a,indexOf:i,lastIndexOf:function(t,e,n){if(!y(t))throw new TypeError;var r=Object(t),i=r.length>>>0;if(0===i)return-1;var o=i;arguments.length>2&&((o=Number(arguments[2]))!=o?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(o>0||-1)*m(E(o))));for(var s=o>=0?w(o,i-1):i-E(o);s>=0;s--)if(s in r&&r[s]===e)return s;return-1}};return t.define(y,A).expose(A)}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended"),t("is-extended"),t("arguments-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended","arguments-extended"],function(t,e,n){return r(t,e,n)}):this.arrayExtended=r(this.extended,this.isExtended,this.argumentsExtended)}).call(this)},{"arguments-extended":51,extended:56,"is-extended":66}],53:[function(t,e,n){(function(){"use strict";function r(t,e,n){function r(t,e,n,r){n=n||" ";for(var i=(t=""+t).length;e>i;)r?t+=n:t=n+t,i++;return t}function i(t,n,r){var o=t;if(e.isString(o)){if(t.length>n)if(r){var s=t.length;o=t.substring(s-n,s)}else o=t.substring(0,n)}else o=i(""+o,n);return o}function o(t,n,r){if(!e.isArray(t)||"function"!=typeof n)throw new TypeError;for(var i=Object(t),o=i.length>>>0,s=0;o>s;s++)if(s in i&&!n.call(r,i[s],s,i))return!1;return!0}function s(t,e){return k.difference(new Date(t.getFullYear(),0,1,t.getHours()),t,null,e)+1}function a(t){var e=t.toString(),n="",r=e.indexOf("(");return r>-1&&(n=e.substring(++r,e.indexOf(")"))),n}function c(t){T[t+"sFromNow"]=function(e){return k.add(new Date,t,e)},T[t+"sAgo"]=function(e){return k.add(new Date,t,-e)}}for(var u=function(){function t(t,e,r,o){return t=t.replace(/s$/,""),n(i[t](e,r,o))}var e=Math.floor,n=Math.round,r={day:function(t,e){return[e,"Date",!1]},weekday:function(t,e){var n,r,i=e%5,o=t.getDay(),s=0;i?(n=i,r=parseInt(e/5,10)):(n=e>0?5:-5,r=e>0?(e-5)/5:(e+5)/5),6===o&&e>0?s=1:0===o&&0>e&&(s=-1);var a=o+n;return(0===a||6===a)&&(s=e>0?2:-2),[7*r+n+s,"Date",!1]},year:function(t,e){return[e,"FullYear",!0]},week:function(t,e){return[7*e,"Date",!1]},quarter:function(t,e){return[3*e,"Month",!0]},month:function(t,e){return[e,"Month",!0]}},i={quarter:function(t,n,r){var i=n.getFullYear()-t.getFullYear(),o=t[r?"getUTCMonth":"getMonth"](),s=n[r?"getUTCMonth":"getMonth"](),a=e(o/3)+1,c=e(s/3)+1;return(c+=4*i)-a},weekday:function(e,n,r){var i,o=t("day",e,n,r),s=o%7;if(0===s)o=5*t("week",e,n,r);else{var a=0,c=e[r?"getUTCDay":"getDay"](),u=n[r?"getUTCDay":"getDay"]();i=parseInt(o/7,10);var h=new Date(+e);h.setDate(h[r?"getUTCDate":"getDate"]()+7*i);var f=h[r?"getUTCDay":"getDay"]();o>0?6===c||6===u?a=-1:0===c?a=0:(0===u||f+s>5)&&(a=-2):0>o&&(6===c?a=0:0===c||0===u?a=1:(6===u||0>f+s)&&(a=2)),o+=a,o-=2*i}return o},year:function(t,e){return e.getFullYear()-t.getFullYear()},month:function(t,e,n){var r=t[n?"getUTCMonth":"getMonth"]();return e[n?"getUTCMonth":"getMonth"]()-r+12*(e.getFullYear()-t.getFullYear())},week:function(e,r,i){return n(t("day",e,r,i)/7)},day:function(t,e){return 1.1574074074074074e-8*(e.getTime()-t.getTime())},hour:function(t,e){return 2.7777777777777776e-7*(e.getTime()-t.getTime())},minute:function(t,e){return 16666666666666667e-21*(e.getTime()-t.getTime())},second:function(t,e){return.001*(e.getTime()-t.getTime())},millisecond:function(t,e){return e.getTime()-t.getTime()}};return{addTransform:function(t,e,n){return t=t.replace(/s$/,""),r.hasOwnProperty(t)?r[t](e,n):[n,"UTC"+t.charAt(0).toUpperCase()+t.substring(1)+"s",!1]},differenceTransform:t}}(),h=u.addTransform,f=u.differenceTransform,l=Math.floor,p=Math.round,d=Math.min,g=Math.pow,_=Math.ceil,y=Math.abs,v=["January","February","March","April","May","June","July","August","September","October","November","December"],m=["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."],E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],b=["Before Christ","Anno Domini"],x=["BC","AD"],k={getDaysInMonth:function(t){var e=t.getMonth();return 1===e&&k.isLeapYear(t)?29:[31,28,31,30,31,30,31,31,30,31,30,31][e]},isLeapYear:function(t,e){var n=t[e?"getUTCFullYear":"getFullYear"]();return n%400==0||n%4==0&&n%100!=0},isWeekend:function(t,e){var n=(t||new Date)[e?"getUTCDay":"getDay"]();return 0===n||6===n},getTimezoneName:a,compare:function(t,e,n){return t=new Date(+t),e=new Date(+(e||new Date)),"date"===n?(t.setHours(0,0,0,0),e.setHours(0,0,0,0)):"time"===n&&(t.setFullYear(0,0,0),e.setFullYear(0,0,0)),t>e?1:e>t?-1:0},add:function(t,e,n){var r=h(e,t,n||0);n=r[0];var i=r[1],o=new Date(+t),s=r[2];return i&&o["set"+i](o["get"+i]()+n),s&&o.getDate()<t.getDate()&&o.setDate(0),o},difference:function(t,e,n,r){return e=e||new Date,f(n=n||"day",t,e,r)},format:function(t,e,n){var o,c,u,h,f,d,k,T;return(n=n||!1)?(o=t.getUTCFullYear(),c=t.getUTCMonth(),u=t.getUTCDay(),h=t.getUTCDate(),f=t.getUTCHours(),d=t.getUTCMinutes(),k=t.getUTCSeconds(),T=t.getUTCMilliseconds()):(o=t.getFullYear(),c=t.getMonth(),h=t.getDate(),u=t.getDay(),f=t.getHours(),d=t.getMinutes(),k=t.getSeconds(),T=t.getMilliseconds()),e.replace(/([A-Za-z])\1*/g,function(e){var L,M,N=e.charAt(0),I=e.length;if("d"===N)L=""+h,M=!0;else if("H"!==N||L)if("m"!==N||L)if("s"===N)L||(L=""+k),M=!0;else if("G"===N)L=(4>I?x:b)[0>o?0:1];else if("y"===N)L=o,I>1&&(2===I?L=i(""+L,2,!0):M=!0);else if("Q"===N.toUpperCase())L=_((c+1)/3),M=!0;else if("M"===N)3>I?(L=c+1,M=!0):L=(3===I?m:v)[c];else if("w"===N)L=function(t,e,n){e=e||0;var r=t[n?"getUTCFullYear":"getFullYear"](),i=new Date(r,0,1).getDay(),o=(i-e+7)%7,a=l((s(t)+o-1)/7);return i===e&&a++,a}(t,0,n),M=!0;else if("D"===N)L=s(t,n),M=!0;else if("E"===N)3>I?(L=u+1,M=!0):L=(-3===I?w:E)[u];else if("a"===N)L=12>f?"AM":"PM";else if("h"===N)L=f%12||12,M=!0;else if("K"===N)L=f%12,M=!0;else if("k"===N)L=f||24,M=!0;else if("S"===N)L=p(T*g(10,I-3)),M=!0;else if("z"===N||"v"===N||"Z"===N){if(L=a(t),"z"!==N&&"v"!==N||L||(I=4),!L||"Z"===N){var O=t.getTimezoneOffset(),S=[O>=0?"-":"+",r(l(y(O)/60),2,"0"),r(y(O)%60,2,"0")];4===I&&(S.splice(0,0,"GMT"),S.splice(3,0,":")),L=S.join("")}}else L=e;else L=""+d,M=!0;else L=""+f,M=!0;return M&&(L=r(L,I,"0")),L})}},T={},L=["year","month","day","hour","minute","second"],M=0,N=L.length;N>M;M++)c(L[M]);var I={parseDate:function(t,e){if(!e)throw new Error("format required when calling dateExtender.parse");var r=[],i=function(t,e){return t.replace(/([a-z])\1*/gi,function(t){var n,r=t.charAt(0),i=t.length;if("y"===r)n="\\d{2,4}";else if("M"===r)n=i>2?"\\S+?":"1[0-2]|0?[1-9]";else if("D"===r)n="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|0{0,2}[1-9][0-9]|0?[1-9]";else if("d"===r)n="3[01]|[12]\\d|0?[1-9]";else if("w"===r)n="[1-4][0-9]|5[0-3]|0?[1-9]";else if("E"===r)n="\\S+";else if("h"===r)n="1[0-2]|0?[1-9]";else if("K"===r)n="1[01]|0?\\d";else if("H"===r)n="1\\d|2[0-3]|0?\\d";else if("k"===r)n="1\\d|2[0-4]|0?[1-9]";else if("m"===r||"s"===r)n="[0-5]\\d";else if("S"===r)n="\\d{"+i+"}";else if("a"===r){var o="AM",s="PM";n="AM|PM",o!==o.toLowerCase()&&(n+="|"+o.toLowerCase()),s!==s.toLowerCase()&&(n+="|"+s.toLowerCase()),n=n.replace(/\./g,"\\.")}else n="v"===r||"z"===r||"Z"===r||"G"===r||"q"===r||"Q"===r?".*":" "===r?"\\s*":r+"*";return e&&e.push(t),"("+n+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}(e,r),s=new RegExp("^"+i+"$","i").exec(t);if(!s)return null;var a=[1970,0,1,0,0,0,0],c="";if(o(s,function(t,e){if(e){var i=r[e-1],o=i.length,s=i.charAt(0);if("y"===s)if(100>t){t=parseInt(t,10);var u=""+(new Date).getFullYear(),h=100*u.substring(0,2),f=d(u.substring(2,4)+20,99);a[0]=f>t?h+t:h-100+t}else a[0]=t;else if("M"===s){if(o>2){var l,p,g=v;3===o&&(g=m),t=t.replace(".","").toLowerCase();var _=!1;for(l=0,p=g.length;p>l&&!_;l++)g[l].replace(".","").toLocaleLowerCase()===t&&(t=l,_=!0);if(!_)return!1}else t--;a[1]=t}else if("E"===s||"e"===s){var y=E;3===o&&(y=w),t=t.toLowerCase(),y=n.map(y,function(t){return t.toLowerCase()});var b=n.indexOf(y,t);if(-1===b){if(t=parseInt(t,10),isNaN(t)||t>y.length)return!1}else t=b}else"D"===s||"d"===s?("D"===s&&(a[1]=0),a[2]=t):"a"===s?(t=t.replace(/\./g,"").toLowerCase(),c="pm"===t?"p":"am"===t?"a":""):"k"===s||"h"===s||"H"===s||"K"===s?("k"===s&&24==+t&&(t=0),a[3]=t):"m"===s?a[4]=t:"s"===s?a[5]=t:"S"===s&&(a[6]=t)}return!0})){var u=+a[3];"p"===c&&12>u?a[3]=u+12:"a"===c&&12===u&&(a[3]=0);var h=new Date(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),f=-1!==n.indexOf(r,"d"),l=-1!==n.indexOf(r,"M"),p=a[1],g=a[2],_=h.getMonth(),y=h.getDate();return l&&_>p||f&&y>g?null:h}return null}},O=t.define(e.isDate,k).define(e.isString,I).define(e.isNumber,T);for(M in k)k.hasOwnProperty(M)&&(O[M]=k[M]);for(M in I)I.hasOwnProperty(M)&&(O[M]=I[M]);for(M in T)T.hasOwnProperty(M)&&(O[M]=T[M]);return O}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended"),t("is-extended"),t("array-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended","array-extended"],function(t,e,n){return r(t,e,n)}):this.dateExtended=r(this.extended,this.isExtended,this.arrayExtended)}).call(this)},{"array-extended":52,extended:56,"is-extended":66}],54:[function(t,e,n){!function(){function t(){function t(t,e){return m.call(t,e=e||0)}function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return function(t){return null!=t&&"object"==typeof t}(t)&&t.constructor===Object}function r(t,e){if(t&&t.length)for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function i(t,e,n){var i,o;for(i in e)e.hasOwnProperty(i)&&-1===r(n,i)&&(o=e[i],i in t&&t[i]===o||(t[i]=o));return t}function o(t,n){var r=this.__meta,i=r.supers,o=i.length,s=r.superMeta,a=s.pos;if(o>a){t=t?x(t)||e(t)?t:[t]:[];var c,u=s.name,h=s.f;do{if("function"==typeof(c=i[a][u])&&(c=c._f||c)!==h)return s.pos=1+a,c.apply(this,t)}while(o>++a)}return null}function s(){var t=this.__meta,e=t.supers,n=e.length,r=t.superMeta,i=r.pos;if(n>i){var o,s=r.name,a=r.f;do{if("function"==typeof(o=e[i][s])&&(o=o._f||o)!==a)return r.pos=1+i,o.bind(this)}while(n>++i)}return null}function a(t){var e=this.__getters__;return e.hasOwnProperty(t)?e[t].apply(this):this[t]}function c(e,r){var i=this.__setters__;if(!n(e))return i.hasOwnProperty(e)?i[e].apply(this,t(arguments,1)):this[e]=r;for(var o in e){var s=e[o];i.hasOwnProperty(o)?i[e].call(this,s):this[o]=s}}function u(){var t=this.__meta||{},e=t.supers,n=e.length,r=t.superMeta,i=r.pos;if(n>i){var o,s=r.name,a=r.f;do{if("function"==typeof(o=e[i][s])&&(o=o._f||o)!==a)return r.pos=1+i,o.apply(this,arguments)}while(n>++i)}return null}function h(t,e){if(t.toString().match(b)){var n=function(){var n,r=this.__meta||{},i=r.superMeta;switch(r.superMeta={f:t,pos:0,name:e},arguments.length){case 0:n=t.call(this);break;case 1:n=t.call(this,arguments[0]);break;case 2:n=t.call(this,arguments[0],arguments[1]);break;case 3:n=t.call(this,arguments[0],arguments[1],arguments[2]);break;default:n=t.apply(this,arguments)}return r.superMeta=i,n};return n._f=t,n}return t._f=t,t}function f(t,e){var n=e.setters||{},r=t.__setters__,i=t.__getters__;for(var o in n)r.hasOwnProperty(o)||(r[o]=n[o]);for(o in n=e.getters||{})i.hasOwnProperty(o)||(i[o]=n[o]);for(var s in e)if("getters"!==s&&"setters"!==s){var a=e[s];"function"==typeof a?t.hasOwnProperty(s)||(t[s]=h(u,s)):t[s]=a}}function l(){for(var e=t(arguments),n=e.length,r=this.prototype,i=r.__meta,o=this.__meta,s=r.__meta.bases,a=s.slice(),c=o.supers||[],u=i.supers||[],h=0;n>h;h++){var l=e[h],d=l.prototype,g=d.__meta,_=l.__meta;!g&&(g=d.__meta={proto:d||{}}),!_&&(_=l.__meta={proto:l.__proto__||{}}),f(r,g.proto||{}),f(this,_.proto||{}),p(l.prototype,u,s),p(l,c,a)}return this}function p(t,e,n){var i=t.__meta;!i&&(i=t.__meta={});var o=t.__meta.unique;if(!o&&(i.unique="declare"+ ++E),-1===r(n,o)){n.push(o);for(var s=t.__meta.supers||[],a=s.length-1||0;a>=0;)p(s[a--],e,n);e.unshift(t)}}function d(t,e){var n=e.setters,r=t.__setters__,i=t.__getters__;if(n)for(var o in n)r[o]=n[o];if(n=e.getters||{})for(o in n)i[o]=n[o];for(o in e)if("getters"!=o&&"setters"!=o){var s=e[o];t[o]="function"==typeof s?(s.__meta||{}).isConstructor?s:h(s,o):s}}function g(t){w.prototype=t.prototype;var e=new w;return w.prototype=null,e}function _(t,r,a){var c={},f=[],_="declare"+ ++E,y=[],m=[],w=[],b=[],x={supers:w,unique:_,bases:y,superMeta:{f:null,pos:0,name:null}},k={supers:b,unique:_,bases:m,isConstructor:!0,superMeta:{f:null,pos:0,name:null}};if(n(r)&&!a&&(a=r,r=v),"function"==typeof r||e(r)?(r=(f=e(r)?r:[r]).shift(),t.__meta=k,(c=g(r)).__meta=x,c.__getters__=i({},c.__getters__||{}),c.__setters__=i({},c.__setters__||{}),t.__getters__=i({},t.__getters__||{}),t.__setters__=i({},t.__setters__||{}),p(r.prototype,w,y),p(r,b,m)):(t.__meta=k,c.__meta=x,c.__getters__=c.__getters__||{},c.__setters__=c.__setters__||{},t.__getters__=t.__getters__||{},t.__setters__=t.__setters__||{}),t.prototype=c,a){var T=x.proto=a.instance||{},L=k.proto=a.static||{};L.init=L.init||u,d(c,T),d(t,L),c.constructor=T.hasOwnProperty("constructor")?h(T.constructor,"constructor"):T.constructor=h(u,"constructor")}else x.proto={},k.proto={},t.init=h(u,"init"),c.constructor=h(u,"constructor");f.length&&l.apply(t,f),r&&i(t,i(i({},r),t)),c._super=t._super=o,c._getSuper=t._getSuper=s,c._static=t}function y(t,e){function n(){switch(arguments.length){case 0:this.constructor.call(this);break;case 1:this.constructor.call(this,arguments[0]);break;case 2:this.constructor.call(this,arguments[0],arguments[1]);break;case 3:this.constructor.call(this,arguments[0],arguments[1],arguments[2]);break;default:this.constructor.apply(this,arguments)}}return _(n,t,e),n.init()||n}var v,m=Array.prototype.slice,E=0,w=new Function,b=/(super)/g,x=function(t){return"[object Arguments]"===Object.prototype.toString.call(t)};return x(arguments)||(x=function(t){return!(!t||!t.hasOwnProperty("callee"))}),v=y({instance:{get:a,set:c},static:{get:a,set:c,mixin:l,extend:function(t){return y(this,t)},as:function(t,e){return t&&e?t[e]=this:t.exports=t=this,this}}}),y.singleton=function(t,e){function n(){return r||(this.constructor.apply(this,arguments),r=this),r}var r;return _(n,t,e),n.init()||n},y}void 0!==n?void 0!==e&&e.exports&&(e.exports=t()):"function"==typeof define&&define.amd?define(t):this.declare=t()}()},{}],55:[function(t,e,n){e.exports=t("./declare.js")},{"./declare.js":54}],56:[function(t,e,n){(function(){"use strict";function r(t){function e(){return function(){var e=t.define();return e.expose({register:function(t,n){n||(n=t,t=null);var r=typeof n;if(t)e[t]=n;else if(n&&"function"===r)e.extend(n);else{if("object"!==r)throw new TypeError("extended.register must be called with an extender function");e.expose(n)}return e},define:function(){return t.define.apply(t,arguments)}}),e}()}return e.define=function(){return t.define.apply(t,arguments)},e}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extender"))):"function"==typeof define&&define.amd?define(["extender"],function(t){return r(t)}):this.extended=r(this.extender)}).call(this)},{extender:58}],57:[function(t,e,n){(function(){function r(t){function e(t,e){if(t&&t.length)for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function n(e){function n(t,e,n){if("function"!=typeof n)throw new TypeError("when extending type you must provide a function");var o;o="constructor"===e?function(){this._super(arguments),n.apply(this,arguments)}:function(){var t=i.call(arguments);t.unshift(this._value);var e=n.apply(this,t);return e!==r?this.__extender__(e):this},t[e]=o}function s(t,e,n){if("function"!=typeof n)throw new TypeError("when extending type you must provide a function");var r;r="constructor"===e?function(){this._super(arguments),n.apply(this,arguments)}:function(){var t=i.call(arguments);return t.unshift(this._value),n.apply(this,t)},t[e]=r}function a(t,e,r){for(var i in e)e.hasOwnProperty(i)&&("getters"!==i&&"setters"!==i?"noWrap"===i?a(t,e[i],!0):r?s(t,i,e[i]):n(t,i,e[i]):t[i]=e[i])}function c(t){var e,n,r=t;if(!(t instanceof h)){var i=h;for(e=0,n=f.length;n>e;e++){var o=f[e];o[0](t)&&(i=i.extend({instance:o[1]}))}(r=new i(t)).__extender__=c}return r}function u(){return!0}e=e||[];var h=t({instance:{constructor:function(t){this._value=t},value:function(){return this._value},eq:function(t){return this.__extender__(this._value===t)},neq:function(t){return this.__extender__(this._value!==t)},print:function(){return console.log(this._value),this}}}),f=[];return c.define=function(t,e){if(arguments.length){"object"==typeof t&&(e=t,t=u);var r={};a(r,e=e||{}),r.hasOwnProperty("constructor")||(e.hasOwnProperty("constructor")?n(r,"constructor",e.constructor):r.constructor=function(){this._super(arguments)}),f.push([t,r])}return c},c.extend=function(t){return t&&t.hasOwnProperty("__defined__")&&(c.__defined__=f=f.concat(t.__defined__)),o(c,t,["define","extend","expose","__defined__"]),c},c.expose=function(){for(var t,e=0,n=arguments.length;n>e;e++)"object"==typeof(t=arguments[e])&&o(c,t,["define","extend","expose","__defined__"]);return c},c.__defined__=f,c}var r,i=Array.prototype.slice,o=function(){function t(t,n,r){var i,o;for(i in n)n.hasOwnProperty(i)&&-1===e(r,i)&&(o=n[i],i in t&&t[i]===o||(t[i]=o));return t}return function(e){e||(e={});var n=arguments.length,r=arguments[arguments.length-1];"[object Array]"!==Object.prototype.toString.call(r)?r=[]:n--;for(var i=1;n>i;i++)t(e,arguments[i],r);return e}}();return{define:function(){return n().define.apply(n,arguments)},extend:function(t){return n().define().extend(t)}}}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("declare.js"))):"function"==typeof define&&define.amd?define(["declare"],function(t){return r(t)}):this.extender=r(this.declare)}).call(this)},{"declare.js":55}],58:[function(t,e,n){e.exports=t("./extender.js")},{"./extender.js":57}],59:[function(t,e,n){(function(){"use strict";function r(t,e,n){function r(t,e,n){var r;switch((e||[]).length){case 0:r=t.call(n);break;case 1:r=t.call(n,e[0]);break;case 2:r=t.call(n,e[0],e[1]);break;case 3:r=t.call(n,e[0],e[1],e[2]);break;default:r=t.apply(n,e)}return r}function i(t,e,n){if(n=g(arguments,2),p(e)&&!(e in t))throw new Error(e+" property not defined in scope");if(!p(e)&&!d(e))throw new Error(e+" is not a function");return p(e)?function(){var i=t[e];return d(i)?r(i,n.concat(g(arguments)),t):i}:n.length?function(){return r(e,n.concat(g(arguments)),t)}:function(){return r(e,arguments,t)}}function o(t,e){if(e=g(arguments,1),!p(t)&&!d(t))throw new Error(t+" must be the name of a property or function to execute");return p(t)?function(){var n=g(arguments),i=n.shift(),o=i[t];return d(o)?r(o,n=e.concat(n),i):o}:function(){var n=g(arguments),i=n.shift();return n=e.concat(n),r(t,n,i)}}function s(t,e,n){if(n=g(arguments,2),p(e)&&!(e in t))throw new Error(e+" property not defined in scope");if(!p(e)&&!d(e))throw new Error(e+" is not a function");return p(e)?function(){var i=t[e];return d(i)?r(i,n,t):i}:function(){return r(e,n,t)}}function a(t){var e=g(arguments,1);if(!l(t)&&!d(t))throw new TypeError("scope must be an object");if(1===e.length&&f(e[0])&&(e=e[0]),!e.length)for(var n in e=[],t)t.hasOwnProperty(n)&&d(t[n])&&e.push(n);for(var r=0,o=e.length;o>r;r++)t[e[r]]=i(t,t[e[r]]);return t}function c(t,e){if(e=g(arguments,1),!p(t)&&!d(t))throw new Error(t+" must be the name of a property or function to execute");return p(t)?function(){var n=this[t];return d(n)?r(n,e.concat(g(arguments)),this):n}:function(){var n=e.concat(g(arguments));return r(t,n,this)}}function u(t,e){return function(){var n=g(arguments);return e?r(t,arguments,this):function(){return r(t,n.concat(g(arguments)),this)}}}function h(t,e,n){var r;if(r=n?i(n,e):e,t)for(var o=t-1,s=o;s>=0;s--)r=u(r,s===o);return r}var f=e.isArray,l=e.isObject,p=e.isString,d=e.isFunction,g=n.argsToArray;return t.define(l,{bind:i,bindAll:a,bindIgnore:s,curry:function(t,e,n){return h(e,n,t)}}).define(d,{bind:function(t,e){return r(i,[e,t].concat(g(arguments,2)),this)},bindIgnore:function(t,e){return r(s,[e,t].concat(g(arguments,2)),this)},partial:c,applyFirst:o,curry:function(t,e,n){return h(e,t,n)},noWrap:{f:function(){return this.value()}}}).define(p,{bind:function(t,e){return i(e,t)},bindIgnore:function(t,e){return s(e,t)},partial:c,applyFirst:o,curry:function(t,e,n){return h(e,t,n)}}).expose({bind:i,bindAll:a,bindIgnore:s,partial:c,applyFirst:o,curry:h})}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended"),t("is-extended"),t("arguments-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended","arguments-extended"],function(t,e,n){return r(t,e,n)}):this.functionExtended=r(this.extended,this.isExtended,this.argumentsExtended)}).call(this)},{"arguments-extended":51,extended:56,"is-extended":66}],60:[function(t,e,n){var r=t("__browserify_process");r.EventEmitter||(r.EventEmitter=function(){});var i=n.EventEmitter=r.EventEmitter,o="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};i.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},i.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||o(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(o(e)){n=Array.prototype.slice.call(arguments,1);for(var r=e.slice(),i=0,s=r.length;s>i;i++)r[i].apply(this,n);return!0}return!1},i.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(o(this._events[t])){var n;this._events[t].warned||(n=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace()),this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},i.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(o(n)){var r=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}(n,e);if(0>r)return this;n.splice(r,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},i.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},i.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),o(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},i.listenerCount=function(t,e){return t._events&&t._events[e]?"function"==typeof t._events[e]?1:t._events[e].length:0}},{__browserify_process:64}],61:[function(t,e,n){},{}],62:[function(t,e,n){function r(t,e){for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}function i(t,e){for(var n=0,r=t.length;r>=0;r--){var i=t[r];"."==i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var o=t("__browserify_process"),s=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){for(var t="",e=!1,n=arguments.length;n>=-1&&!e;n--){var s=n>=0?arguments[n]:o.cwd();"string"==typeof s&&s&&(t=s+"/"+t,e="/"===s.charAt(0))}return(e?"/":"")+(t=i(r(t.split("/"),function(t){return!!t}),!e).join("/"))||"."},n.normalize=function(t){var e="/"===t.charAt(0),n="/"===t.slice(-1);return(t=i(r(t.split("/"),function(t){return!!t}),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){return t&&"string"==typeof t}).join("/"))},n.dirname=function(t){var e=s.exec(t)[1]||"";return e?1===e.length?e:e.substring(0,e.length-1):"."},n.basename=function(t,e){var n=s.exec(t)[2]||"";return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return s.exec(t)[3]||""},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),s=Math.min(i.length,o.length),a=s,c=0;s>c;c++)if(i[c]!==o[c]){a=c;break}var u=[];for(c=a;c<i.length;c++)u.push("..");return(u=u.concat(o.slice(a))).join("/")},n.sep="/"},{__browserify_process:64}],63:[function(t,e,n){t=function(t,e,n,r){function i(r){if(!n[r]){if(!e[r]){if(t)return t(r);throw new Error("Cannot find module '"+r+"'")}var o=n[r]={exports:{}};e[r][0](function(t){return i(e[r][1][t]||t)},o,o.exports)}return n[r].exports}for(var o=0;o<r.length;o++)i(r[o]);return i}(void 0!==t&&t,{1:[function(t,e,n){function r(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}function i(t,e){return void 0===e?""+e:"number"!=typeof e||!isNaN(e)&&isFinite(e)?"function"==typeof e||e instanceof RegExp?e.toString():e:e.toString()}function o(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function s(t,e,n,r,i){throw new _.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function a(t,e){t||s(t,!0,e,"==",_.ok)}function c(t,e){if(t===e)return!0;if(d.isBuffer(t)&&d.isBuffer(e)){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():"object"!=typeof t&&"object"!=typeof e?t==e:function(t,e){if(u(t)||u(e))return!1;if(t.prototype!==e.prototype)return!1;if(h(t))return!!h(e)&&c(t=g.call(t),e=g.call(e));try{var n,i,o=r(t),s=r(e)}catch(a){return!1}if(o.length!=s.length)return!1;for(o.sort(),s.sort(),i=o.length-1;i>=0;i--)if(o[i]!=s[i])return!1;for(i=o.length-1;i>=0;i--)if(!c(t[n=o[i]],e[n]))return!1;return!0}(t,e)}function u(t){return null==t}function h(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function f(t,e){return!(!t||!e)&&(e instanceof RegExp?e.test(t):t instanceof e||!0===e.call({},t))}function l(t,e,n,r){var i;"string"==typeof n&&(r=n,n=null);try{e()}catch(o){i=o}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&s("Missing expected exception"+r),!t&&f(i,n)&&s("Got unwanted exception"+r),t&&i&&n&&!f(i,n)||!t&&i)throw i}var p=t("util"),d=t("buffer").Buffer,g=Array.prototype.slice,_=e.exports=a;_.AssertionError=function(t){this.name="AssertionError",this.message=t.message,this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,Error.captureStackTrace&&Error.captureStackTrace(this,t.stackStartFunction||s)},p.inherits(_.AssertionError,Error),_.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",o(JSON.stringify(this.actual,i),128),this.operator,o(JSON.stringify(this.expected,i),128)].join(" ")},_.AssertionError.__proto__=Error.prototype,_.fail=s,_.ok=a,_.equal=function(t,e,n){t!=e&&s(t,e,n,"==",_.equal)},_.notEqual=function(t,e,n){t==e&&s(t,e,n,"!=",_.notEqual)},_.deepEqual=function(t,e,n){c(t,e)||s(t,e,n,"deepEqual",_.deepEqual)},_.notDeepEqual=function(t,e,n){c(t,e)&&s(t,e,n,"notDeepEqual",_.notDeepEqual)},_.strictEqual=function(t,e,n){t!==e&&s(t,e,n,"===",_.strictEqual)},_.notStrictEqual=function(t,e,n){t===e&&s(t,e,n,"!==",_.notStrictEqual)},_.throws=function(t,e,n){l.apply(this,[!0].concat(g.call(arguments)))},_.doesNotThrow=function(t,e,n){l.apply(this,[!1].concat(g.call(arguments)))},_.ifError=function(t){if(t)throw t}},{util:2,buffer:3}],2:[function(t,e,n){function r(t){return t instanceof Array||Array.isArray(t)||t&&t!==Object.prototype&&r(t.__proto__)}function i(t){return t instanceof RegExp||"object"==typeof t&&"[object RegExp]"===Object.prototype.toString.call(t)}function o(t){if(t instanceof Date)return!0;if("object"!=typeof t)return!1;var e=Date.prototype&&a(Date.prototype),n=t.__proto__&&a(t.__proto__);return JSON.stringify(n)===JSON.stringify(e)}t("events"),n.isArray=r,n.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},n.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(t,e,c,u){var h=[],f=function(t,e){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r={special:"cyan",number:"blue",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"}[e];return r?"\x1b["+n[r][0]+"m"+t+"\x1b["+n[r][1]+"m":t};return u||(f=function(t,e){return t}),function t(c,u){if(c&&"function"==typeof c.inspect&&c!==n&&(!c.constructor||c.constructor.prototype!==c))return c.inspect(u);switch(typeof c){case"undefined":return f("undefined","undefined");case"string":var l="'"+JSON.stringify(c).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return f(l,"string");case"number":return f(""+c,"number");case"boolean":return f(""+c,"boolean")}if(null===c)return f("null","null");var p,d,g,_=s(c),y=e?a(c):_;if("function"==typeof c&&0===y.length)return i(c)?f(""+c,"regexp"):f("[Function"+(c.name?": "+c.name:"")+"]","special");if(o(c)&&0===y.length)return f(c.toUTCString(),"date");if(r(c)?(d="Array",g=["[","]"]):(d="Object",g=["{","}"]),"function"==typeof c){var v=c.name?": "+c.name:"";p=i(c)?" "+c:" [Function"+v+"]"}else p="";if(o(c)&&(p=" "+c.toUTCString()),0===y.length)return g[0]+p+g[1];if(0>u)return i(c)?f(""+c,"regexp"):f("[Object]","special");h.push(c);var m=y.map(function(e){var n,i;if(c.__lookupGetter__&&(c.__lookupGetter__(e)?i=c.__lookupSetter__(e)?f("[Getter/Setter]","special"):f("[Getter]","special"):c.__lookupSetter__(e)&&(i=f("[Setter]","special"))),_.indexOf(e)<0&&(n="["+e+"]"),i||(h.indexOf(c[e])<0?(i=null===u?t(c[e]):t(c[e],u-1)).indexOf("\n")>-1&&(i=r(c)?i.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+i.split("\n").map(function(t){return"   "+t}).join("\n")):i=f("[Circular]","special")),void 0===n){if("Array"===d&&e.match(/^\d+$/))return i;(n=JSON.stringify(""+e)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=f(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=f(n,"string"))}return n+": "+i});return h.pop(),m.reduce(function(t,e){return e.indexOf("\n"),t+e.length+1},0)>50?g[0]+(""===p?"":p+"\n ")+" "+m.join(",\n  ")+" "+g[1]:g[0]+p+" "+m.join(", ")+" "+g[1]}(t,void 0===c?2:c)},n.log=function(t){},n.pump=null;var s=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},a=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.hasOwnProperty.call(t,n)&&e.push(n);return e},c=Object.create||function(t,e){var n;if(null===t)n={__proto__:null};else{if("object"!=typeof t)throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var r=function(){};r.prototype=t,(n=new r).__proto__=t}return void 0!==e&&Object.defineProperties&&Object.defineProperties(n,e),n};n.inherits=function(t,e){t.super_=e,t.prototype=c(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})};var u=/%[sdj%]/g;n.format=function(t){if("string"!=typeof t){for(var e=[],r=0;r<arguments.length;r++)e.push(n.inspect(arguments[r]));return e.join(" ")}r=1;for(var i=arguments,o=i.length,s=String(t).replace(u,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":return JSON.stringify(i[r++]);default:return t}}),a=i[r];o>r;a=i[++r])s+=null===a||"object"!=typeof a?" "+a:" "+n.inspect(a);return s}},{events:4}],5:[function(t,e,n){n.readIEEE754=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,h=-7,f=n?0:i-1,l=n?1:-1,p=t[e+f];for(f+=l,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+t[e+f],f+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+f],f+=l,h-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},n.writeIEEE754=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?o-1:0,d=r?-1:1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+f>=1?l/c:l*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=h?(a=0,s=h):s+f>=1?(a=(e*c-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+p]=255&s,p+=d,s/=256,u-=8);t[n+p-d]|=128*g}},{}],6:[function(t,e,n){var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){t.source===window&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)&&n.shift()()},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e,n){!function(t){t.EventEmitter||(t.EventEmitter=function(){});var e=n.EventEmitter=t.EventEmitter,r="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},e.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(r(e)){n=Array.prototype.slice.call(arguments,1);for(var i=e.slice(),o=0,s=i.length;s>o;o++)i[o].apply(this,n);return!0}return!1},e.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(r(this._events[t])){var n;this._events[t].warned||(n=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace()),this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},e.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(r(n)){var i=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}(n,e);if(0>i)return this;n.splice(i,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},e.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},e.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),r(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}}(t("__browserify_process"))},{__browserify_process:6}],"buffer-browserify":[function(t,e,n){e.exports=t("q9TxCC")},{}],q9TxCC:[function(t,e,n){function r(t){this.length=t}function i(t){return 16>t?"0"+t.toString(16):t.toString(16)}function o(t){for(var e=[],n=0;n<t.length;n++)if(t.charCodeAt(n)<=127)e.push(t.charCodeAt(n));else for(var r=encodeURIComponent(t.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)e.push(parseInt(r[i],16));return e}function s(e){return t("base64-js").toByteArray(e)}function a(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);)e[i+n]=t[i],i++;return i}function c(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function u(t){return 0>(t=~~Math.ceil(+t))?0:t}function h(t,e,n){if(!(this instanceof h))return new h(t,e,n);var i;if("number"==typeof n)this.length=u(e),this.parent=t,this.offset=n;else{switch(i=typeof t){case"number":this.length=u(t);break;case"string":this.length=h.byteLength(t,e);break;case"object":this.length=u(t.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(this.length>h.poolSize?(this.parent=new r(this.length),this.offset=0):((!L||L.length-L.used<this.length)&&((L=new r(h.poolSize)).used=0),this.parent=L,this.offset=L.used,L.used+=this.length),function(t){return Array.isArray(t)||h.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}(t))for(var o=0;o<this.length;o++)this.parent[o+this.offset]=t instanceof h?t.readUInt8(o):t[o];else"string"==i&&(this.length=this.write(t,0,e))}}function f(t,e,n,r){var i=0;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+1<t.length,"Trying to read beyond buffer length")),e>=t.length?0:(n?(i=t.parent[t.offset+e]<<8,e+1<t.length&&(i|=t.parent[t.offset+e+1])):(i=t.parent[t.offset+e],e+1<t.length&&(i|=t.parent[t.offset+e+1]<<8)),i)}function l(t,e,n,r){var i=0;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+3<t.length,"Trying to read beyond buffer length")),e>=t.length?0:(n?(e+1<t.length&&(i=t.parent[t.offset+e+1]<<16),e+2<t.length&&(i|=t.parent[t.offset+e+2]<<8),e+3<t.length&&(i|=t.parent[t.offset+e+3]),i+=t.parent[t.offset+e]<<24>>>0):(e+2<t.length&&(i=t.parent[t.offset+e+2]<<16),e+1<t.length&&(i|=t.parent[t.offset+e+1]<<8),i|=t.parent[t.offset+e],e+3<t.length&&(i+=t.parent[t.offset+e+3]<<24>>>0)),i)}function p(t,e,n,r){var i;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+1<t.length,"Trying to read beyond buffer length")),32768&(i=f(t,e,n,r))?-1*(65535-i+1):i}function d(t,e,n,r){var i;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+3<t.length,"Trying to read beyond buffer length")),2147483648&(i=l(t,e,n,r))?-1*(4294967295-i+1):i}function g(e,n,r,i){return i||(M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(n+3<e.length,"Trying to read beyond buffer length")),t("./buffer_ieee754").readIEEE754(e,n,r,23,4)}function _(e,n,r,i){return i||(M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(n+7<e.length,"Trying to read beyond buffer length")),t("./buffer_ieee754").readIEEE754(e,n,r,52,8)}function y(t,e){M.ok("number"==typeof t,"cannot write a non-number as a number"),M.ok(t>=0,"specified a negative value for writing an unsigned value"),M.ok(e>=t,"value is larger than maximum value for type"),M.ok(Math.floor(t)===t,"value has a fractional component")}function v(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+1<t.length,"trying to write beyond buffer length"),y(e,65535));for(var o=0;o<Math.min(t.length-n,2);o++)t.parent[t.offset+n+o]=(e&255<<8*(r?1-o:o))>>>8*(r?1-o:o)}function m(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+3<t.length,"trying to write beyond buffer length"),y(e,4294967295));for(var o=0;o<Math.min(t.length-n,4);o++)t.parent[t.offset+n+o]=e>>>8*(r?3-o:o)&255}function E(t,e,n){M.ok("number"==typeof t,"cannot write a non-number as a number"),M.ok(e>=t,"value larger than maximum allowed value"),M.ok(t>=n,"value smaller than minimum allowed value"),M.ok(Math.floor(t)===t,"value has a fractional component")}function w(t,e,n){M.ok("number"==typeof t,"cannot write a non-number as a number"),M.ok(e>=t,"value larger than maximum allowed value"),M.ok(t>=n,"value smaller than minimum allowed value")}function b(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+1<t.length,"Trying to write beyond buffer length"),E(e,32767,-32768)),v(t,e>=0?e:65535+e+1,n,r,i)}function x(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+3<t.length,"Trying to write beyond buffer length"),E(e,2147483647,-2147483648)),m(t,e>=0?e:4294967295+e+1,n,r,i)}function k(e,n,r,i,o){o||(M.ok(null!=n,"missing value"),M.ok("boolean"==typeof i,"missing or invalid endian"),M.ok(null!=r,"missing offset"),M.ok(r+3<e.length,"Trying to write beyond buffer length"),w(n,3.4028234663852886e38,-3.4028234663852886e38)),t("./buffer_ieee754").writeIEEE754(e,n,r,i,23,4)}function T(e,n,r,i,o){o||(M.ok(null!=n,"missing value"),M.ok("boolean"==typeof i,"missing or invalid endian"),M.ok(null!=r,"missing offset"),M.ok(r+7<e.length,"Trying to write beyond buffer length"),w(n,1.7976931348623157e308,-1.7976931348623157e308)),t("./buffer_ieee754").writeIEEE754(e,n,r,i,52,8)}var L,M=t("assert");n.INSPECT_MAX_BYTES=50,r.byteLength=function(t,e){switch(e||"utf8"){case"hex":return t.length/2;case"utf8":case"utf-8":return o(t).length;case"ascii":case"binary":return t.length;case"base64":return s(t).length;default:throw new Error("Unknown encoding")}},r.prototype.utf8Write=function(t,e,n){return r._charsWritten=a(o(t),this,e,n)},r.prototype.asciiWrite=function(t,e,n){return r._charsWritten=a(function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}(t),this,e,n)},r.prototype.binaryWrite=r.prototype.asciiWrite,r.prototype.base64Write=function(t,e,n){return r._charsWritten=a(s(t),this,e,n)},r.prototype.base64Slice=function(e,n){var r=Array.prototype.slice.apply(this,arguments);return t("base64-js").fromByteArray(r)},r.prototype.utf8Slice=function(){for(var t=Array.prototype.slice.apply(this,arguments),e="",n="",r=0;r<t.length;)t[r]<=127?(e+=c(n)+String.fromCharCode(t[r]),n=""):n+="%"+t[r].toString(16),r++;return e+c(n)},r.prototype.binarySlice=r.prototype.asciiSlice=function(){for(var t=Array.prototype.slice.apply(this,arguments),e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=i(this[r]),r==n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<SlowBuffer "+t.join(" ")+">"},r.prototype.hexSlice=function(t,e){var n=this.length;(!t||0>t)&&(t=0),(!e||0>e||e>n)&&(e=n);for(var r="",o=t;e>o;o++)r+=i(this[o]);return r},r.prototype.toString=function(t,e,n){if(t=String(t||"utf8").toLowerCase(),void 0===n&&(n=this.length),+n==(e=+e||0))return"";switch(t){case"hex":return this.hexSlice(e,n);case"utf8":case"utf-8":return this.utf8Slice(e,n);case"ascii":return this.asciiSlice(e,n);case"binary":return this.binarySlice(e,n);case"base64":return this.base64Slice(e,n);case"ucs2":case"ucs-2":return this.ucs2Slice(e,n);default:throw new Error("Unknown encoding")}},r.prototype.hexWrite=function(t,e,n){var i=this.length-(e=+e||0);n?(n=+n)>i&&(n=i):n=i;var o=t.length;if(o%2)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[e+s]=a}return r._charsWritten=2*s,s},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var i=r;r=e,e=n,n=i}var o=this.length-(e=+e||0);switch(n?(n=+n)>o&&(n=o):n=o,r=String(r||"utf8").toLowerCase()){case"hex":return this.hexWrite(t,e,n);case"utf8":case"utf-8":return this.utf8Write(t,e,n);case"ascii":return this.asciiWrite(t,e,n);case"binary":return this.binaryWrite(t,e,n);case"base64":return this.base64Write(t,e,n);case"ucs2":case"ucs-2":return this.ucs2Write(t,e,n);default:throw new Error("Unknown encoding")}},r.prototype.slice=function(t,e){if(void 0===e&&(e=this.length),e>this.length)throw new Error("oob");if(t>e)throw new Error("oob");return new h(this,e-t,+t)},r.prototype.copy=function(t,e,n,r){for(var i=[],o=n;r>o;o++)M.ok(void 0!==this[o],"copying undefined buffer bytes!"),i.push(this[o]);for(o=e;o<e+i.length;o++)t[o]=i[o-e]},r.prototype.fill=function(t,e,n){if(n>this.length)throw new Error("oob");if(e>n)throw new Error("oob");for(var r=e;n>r;r++)this[r]=t},n.SlowBuffer=r,n.Buffer=h,h.poolSize=8192,h.isBuffer=function(t){return t instanceof h||t instanceof r},h.concat=function(t,e){if(!Array.isArray(t))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===t.length)return new h(0);if(1===t.length)return t[0];if("number"!=typeof e){e=0;for(var n=0;n<t.length;n++)e+=(o=t[n]).length}var r=new h(e),i=0;for(n=0;n<t.length;n++){var o;(o=t[n]).copy(r,i),i+=o.length}return r},h.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=i(this.parent[r+this.offset]),r==n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"},h.prototype.get=function(t){if(0>t||t>=this.length)throw new Error("oob");return this.parent[this.offset+t]},h.prototype.set=function(t,e){if(0>t||t>=this.length)throw new Error("oob");return this.parent[this.offset+t]=e},h.prototype.write=function(t,e,n,i){if(isFinite(e))isFinite(n)||(i=n,n=void 0);else{var o=i;i=e,e=n,n=o}var s,a=this.length-(e=+e||0);switch(n?(n=+n)>a&&(n=a):n=a,i=String(i||"utf8").toLowerCase()){case"hex":s=this.parent.hexWrite(t,this.offset+e,n);break;case"utf8":case"utf-8":s=this.parent.utf8Write(t,this.offset+e,n);break;case"ascii":s=this.parent.asciiWrite(t,this.offset+e,n);break;case"binary":s=this.parent.binaryWrite(t,this.offset+e,n);break;case"base64":s=this.parent.base64Write(t,this.offset+e,n);break;case"ucs2":case"ucs-2":s=this.parent.ucs2Write(t,this.offset+e,n);break;default:throw new Error("Unknown encoding")}return h._charsWritten=r._charsWritten,s},h.prototype.toString=function(t,e,n){switch(t=String(t||"utf8").toLowerCase(),void 0===e||0>e?e=0:e>this.length&&(e=this.length),void 0===n||n>this.length?n=this.length:0>n&&(n=0),e+=this.offset,n+=this.offset,t){case"hex":return this.parent.hexSlice(e,n);case"utf8":case"utf-8":return this.parent.utf8Slice(e,n);case"ascii":return this.parent.asciiSlice(e,n);case"binary":return this.parent.binarySlice(e,n);case"base64":return this.parent.base64Slice(e,n);case"ucs2":case"ucs-2":return this.parent.ucs2Slice(e,n);default:throw new Error("Unknown encoding")}},h.byteLength=r.byteLength,h.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),"number"!=typeof t||isNaN(t))throw new Error("value is not a number");if(e>n)throw new Error("end < start");if(n===e)return 0;if(0==this.length)return 0;if(0>e||e>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");return this.parent.fill(t,e+this.offset,n+this.offset)},h.prototype.copy=function(t,e,n,r){var i=this;if(n||(n=0),r||(r=this.length),e||(e=0),n>r)throw new Error("sourceEnd < sourceStart");if(r===n)return 0;if(0==t.length||0==i.length)return 0;if(0>e||e>=t.length)throw new Error("targetStart out of bounds");if(0>n||n>=i.length)throw new Error("sourceStart out of bounds");if(0>r||r>i.length)throw new Error("sourceEnd out of bounds");return r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n),this.parent.copy(t.parent,e+t.offset,n+this.offset,r+this.offset)},h.prototype.slice=function(t,e){if(void 0===e&&(e=this.length),e>this.length)throw new Error("oob");if(t>e)throw new Error("oob");return new h(this.parent,e-t,+t+this.offset)},h.prototype.utf8Slice=function(t,e){return this.toString("utf8",t,e)},h.prototype.binarySlice=function(t,e){return this.toString("binary",t,e)},h.prototype.asciiSlice=function(t,e){return this.toString("ascii",t,e)},h.prototype.utf8Write=function(t,e){return this.write(t,e,"utf8")},h.prototype.binaryWrite=function(t,e){return this.write(t,e,"binary")},h.prototype.asciiWrite=function(t,e){return this.write(t,e,"ascii")},h.prototype.readUInt8=function(t,e){var n=this;return e||(M.ok(null!=t,"missing offset"),M.ok(t<n.length,"Trying to read beyond buffer length")),t>=n.length?void 0:n.parent[n.offset+t]},h.prototype.readUInt16LE=function(t,e){return f(this,t,!1,e)},h.prototype.readUInt16BE=function(t,e){return f(this,t,!0,e)},h.prototype.readUInt32LE=function(t,e){return l(this,t,!1,e)},h.prototype.readUInt32BE=function(t,e){return l(this,t,!0,e)},h.prototype.readInt8=function(t,e){var n=this;return e||(M.ok(null!=t,"missing offset"),M.ok(t<n.length,"Trying to read beyond buffer length")),t>=n.length?void 0:128&n.parent[n.offset+t]?-1*(255-n.parent[n.offset+t]+1):n.parent[n.offset+t]},h.prototype.readInt16LE=function(t,e){return p(this,t,!1,e)},h.prototype.readInt16BE=function(t,e){return p(this,t,!0,e)},h.prototype.readInt32LE=function(t,e){return d(this,t,!1,e)},h.prototype.readInt32BE=function(t,e){return d(this,t,!0,e)},h.prototype.readFloatLE=function(t,e){return g(this,t,!1,e)},h.prototype.readFloatBE=function(t,e){return g(this,t,!0,e)},h.prototype.readDoubleLE=function(t,e){return _(this,t,!1,e)},h.prototype.readDoubleBE=function(t,e){return _(this,t,!0,e)},h.prototype.writeUInt8=function(t,e,n){var r=this;n||(M.ok(null!=t,"missing value"),M.ok(null!=e,"missing offset"),M.ok(e<r.length,"trying to write beyond buffer length"),y(t,255)),e<r.length&&(r.parent[r.offset+e]=t)},h.prototype.writeUInt16LE=function(t,e,n){v(this,t,e,!1,n)},h.prototype.writeUInt16BE=function(t,e,n){v(this,t,e,!0,n)},h.prototype.writeUInt32LE=function(t,e,n){m(this,t,e,!1,n)},h.prototype.writeUInt32BE=function(t,e,n){m(this,t,e,!0,n)},h.prototype.writeInt8=function(t,e,n){n||(M.ok(null!=t,"missing value"),M.ok(null!=e,"missing offset"),M.ok(e<this.length,"Trying to write beyond buffer length"),E(t,127,-128)),this.writeUInt8(t>=0?t:255+t+1,e,n)},h.prototype.writeInt16LE=function(t,e,n){b(this,t,e,!1,n)},h.prototype.writeInt16BE=function(t,e,n){b(this,t,e,!0,n)},h.prototype.writeInt32LE=function(t,e,n){x(this,t,e,!1,n)},h.prototype.writeInt32BE=function(t,e,n){x(this,t,e,!0,n)},h.prototype.writeFloatLE=function(t,e,n){k(this,t,e,!1,n)},h.prototype.writeFloatBE=function(t,e,n){k(this,t,e,!0,n)},h.prototype.writeDoubleLE=function(t,e,n){T(this,t,e,!1,n)},h.prototype.writeDoubleBE=function(t,e,n){T(this,t,e,!0,n)},r.prototype.readUInt8=h.prototype.readUInt8,r.prototype.readUInt16LE=h.prototype.readUInt16LE,r.prototype.readUInt16BE=h.prototype.readUInt16BE,r.prototype.readUInt32LE=h.prototype.readUInt32LE,r.prototype.readUInt32BE=h.prototype.readUInt32BE,r.prototype.readInt8=h.prototype.readInt8,r.prototype.readInt16LE=h.prototype.readInt16LE,r.prototype.readInt16BE=h.prototype.readInt16BE,r.prototype.readInt32LE=h.prototype.readInt32LE,r.prototype.readInt32BE=h.prototype.readInt32BE,r.prototype.readFloatLE=h.prototype.readFloatLE,r.prototype.readFloatBE=h.prototype.readFloatBE,r.prototype.readDoubleLE=h.prototype.readDoubleLE,r.prototype.readDoubleBE=h.prototype.readDoubleBE,r.prototype.writeUInt8=h.prototype.writeUInt8,r.prototype.writeUInt16LE=h.prototype.writeUInt16LE,r.prototype.writeUInt16BE=h.prototype.writeUInt16BE,r.prototype.writeUInt32LE=h.prototype.writeUInt32LE,r.prototype.writeUInt32BE=h.prototype.writeUInt32BE,r.prototype.writeInt8=h.prototype.writeInt8,r.prototype.writeInt16LE=h.prototype.writeInt16LE,r.prototype.writeInt16BE=h.prototype.writeInt16BE,r.prototype.writeInt32LE=h.prototype.writeInt32LE,r.prototype.writeInt32BE=h.prototype.writeInt32BE,r.prototype.writeFloatLE=h.prototype.writeFloatLE,r.prototype.writeFloatBE=h.prototype.writeFloatBE,r.prototype.writeDoubleLE=h.prototype.writeDoubleLE,r.prototype.writeDoubleBE=h.prototype.writeDoubleBE},{assert:1,"./buffer_ieee754":5,"base64-js":7}],7:[function(t,e,n){!function(t){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";e.exports.toByteArray=function(t){var e,r,i,o,s,a;if(t.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(a=[],i=(s=(s=t.indexOf("="))>0?t.length-s:0)>0?t.length-4:t.length,e=0,r=0;i>e;e+=4,r+=3)o=n.indexOf(t[e])<<18|n.indexOf(t[e+1])<<12|n.indexOf(t[e+2])<<6|n.indexOf(t[e+3]),a.push((16711680&o)>>16),a.push((65280&o)>>8),a.push(255&o);return 2===s?(o=n.indexOf(t[e])<<2|n.indexOf(t[e+1])>>4,a.push(255&o)):1===s&&(o=n.indexOf(t[e])<<10|n.indexOf(t[e+1])<<4|n.indexOf(t[e+2])>>2,a.push(o>>8&255),a.push(255&o)),a},e.exports.fromByteArray=function(t){function e(t){return n[t>>18&63]+n[t>>12&63]+n[t>>6&63]+n[63&t]}var r,i,o,s=t.length%3,a="";for(r=0,o=t.length-s;o>r;r+=3)a+=e(i=(t[r]<<16)+(t[r+1]<<8)+t[r+2]);switch(s){case 1:a+=n[(i=t[t.length-1])>>2],a+=n[i<<4&63],a+="==";break;case 2:a+=n[(i=(t[t.length-2]<<8)+t[t.length-1])>>10],a+=n[i>>4&63],a+=n[i<<2&63],a+="="}return a}}()},{}],8:[function(t,e,n){n.readIEEE754=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,h=-7,f=n?0:i-1,l=n?1:-1,p=t[e+f];for(f+=l,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+t[e+f],f+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+f],f+=l,h-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},n.writeIEEE754=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?o-1:0,d=r?-1:1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+f>=1?l/c:l*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=h?(a=0,s=h):s+f>=1?(a=(e*c-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+p]=255&s,p+=d,s/=256,u-=8);t[n+p-d]|=128*g}},{}],3:[function(t,e,n){function r(t){this.length=t}function i(t){return 16>t?"0"+t.toString(16):t.toString(16)}function o(t){for(var e=[],n=0;n<t.length;n++)if(t.charCodeAt(n)<=127)e.push(t.charCodeAt(n));else for(var r=encodeURIComponent(t.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)e.push(parseInt(r[i],16));return e}function s(e){return t("base64-js").toByteArray(e)}function a(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);)e[i+n]=t[i],i++;return i}function c(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function u(t){return 0>(t=~~Math.ceil(+t))?0:t}function h(t,e,n){if(!(this instanceof h))return new h(t,e,n);var i;if("number"==typeof n)this.length=u(e),this.parent=t,this.offset=n;else{switch(i=typeof t){case"number":this.length=u(t);break;case"string":this.length=h.byteLength(t,e);break;case"object":this.length=u(t.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(this.length>h.poolSize?(this.parent=new r(this.length),this.offset=0):((!L||L.length-L.used<this.length)&&((L=new r(h.poolSize)).used=0),this.parent=L,this.offset=L.used,L.used+=this.length),function(t){return Array.isArray(t)||h.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}(t))for(var o=0;o<this.length;o++)this.parent[o+this.offset]=t[o];else"string"==i&&(this.length=this.write(t,0,e))}}function f(t,e,n,r){var i=0;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+1<t.length,"Trying to read beyond buffer length")),n?(i=t.parent[t.offset+e]<<8,i|=t.parent[t.offset+e+1]):(i=t.parent[t.offset+e],i|=t.parent[t.offset+e+1]<<8),i}function l(t,e,n,r){var i=0;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+3<t.length,"Trying to read beyond buffer length")),n?(i=t.parent[t.offset+e+1]<<16,i|=t.parent[t.offset+e+2]<<8,i|=t.parent[t.offset+e+3],i+=t.parent[t.offset+e]<<24>>>0):(i=t.parent[t.offset+e+2]<<16,i|=t.parent[t.offset+e+1]<<8,i|=t.parent[t.offset+e],i+=t.parent[t.offset+e+3]<<24>>>0),i}function p(t,e,n,r){var i;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+1<t.length,"Trying to read beyond buffer length")),32768&(i=f(t,e,n,r))?-1*(65535-i+1):i}function d(t,e,n,r){var i;return r||(M.ok("boolean"==typeof n,"missing or invalid endian"),M.ok(null!=e,"missing offset"),M.ok(e+3<t.length,"Trying to read beyond buffer length")),2147483648&(i=l(t,e,n,r))?-1*(4294967295-i+1):i}function g(e,n,r,i){return i||(M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(n+3<e.length,"Trying to read beyond buffer length")),t("./buffer_ieee754").readIEEE754(e,n,r,23,4)}function _(e,n,r,i){return i||(M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(n+7<e.length,"Trying to read beyond buffer length")),t("./buffer_ieee754").readIEEE754(e,n,r,52,8)}function y(t,e){M.ok("number"==typeof t,"cannot write a non-number as a number"),M.ok(t>=0,"specified a negative value for writing an unsigned value"),M.ok(e>=t,"value is larger than maximum value for type"),M.ok(Math.floor(t)===t,"value has a fractional component")}function v(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+1<t.length,"trying to write beyond buffer length"),y(e,65535)),r?(t.parent[t.offset+n]=(65280&e)>>>8,t.parent[t.offset+n+1]=255&e):(t.parent[t.offset+n+1]=(65280&e)>>>8,t.parent[t.offset+n]=255&e)}function m(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+3<t.length,"trying to write beyond buffer length"),y(e,4294967295)),r?(t.parent[t.offset+n]=e>>>24&255,t.parent[t.offset+n+1]=e>>>16&255,t.parent[t.offset+n+2]=e>>>8&255,t.parent[t.offset+n+3]=255&e):(t.parent[t.offset+n+3]=e>>>24&255,t.parent[t.offset+n+2]=e>>>16&255,t.parent[t.offset+n+1]=e>>>8&255,t.parent[t.offset+n]=255&e)}function E(t,e,n){M.ok("number"==typeof t,"cannot write a non-number as a number"),M.ok(e>=t,"value larger than maximum allowed value"),M.ok(t>=n,"value smaller than minimum allowed value"),M.ok(Math.floor(t)===t,"value has a fractional component")}function w(t,e,n){M.ok("number"==typeof t,"cannot write a non-number as a number"),M.ok(e>=t,"value larger than maximum allowed value"),M.ok(t>=n,"value smaller than minimum allowed value")}function b(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+1<t.length,"Trying to write beyond buffer length"),E(e,32767,-32768)),v(t,e>=0?e:65535+e+1,n,r,i)}function x(t,e,n,r,i){i||(M.ok(null!=e,"missing value"),M.ok("boolean"==typeof r,"missing or invalid endian"),M.ok(null!=n,"missing offset"),M.ok(n+3<t.length,"Trying to write beyond buffer length"),E(e,2147483647,-2147483648)),m(t,e>=0?e:4294967295+e+1,n,r,i)}function k(e,n,r,i,o){o||(M.ok(null!=n,"missing value"),M.ok("boolean"==typeof i,"missing or invalid endian"),M.ok(null!=r,"missing offset"),M.ok(r+3<e.length,"Trying to write beyond buffer length"),w(n,3.4028234663852886e38,-3.4028234663852886e38)),t("./buffer_ieee754").writeIEEE754(e,n,r,i,23,4)}function T(e,n,r,i,o){o||(M.ok(null!=n,"missing value"),M.ok("boolean"==typeof i,"missing or invalid endian"),M.ok(null!=r,"missing offset"),M.ok(r+7<e.length,"Trying to write beyond buffer length"),w(n,1.7976931348623157e308,-1.7976931348623157e308)),t("./buffer_ieee754").writeIEEE754(e,n,r,i,52,8)}var L,M=t("assert");n.INSPECT_MAX_BYTES=50,r.byteLength=function(t,e){switch(e||"utf8"){case"hex":return t.length/2;case"utf8":case"utf-8":return o(t).length;case"ascii":return t.length;case"base64":return s(t).length;default:throw new Error("Unknown encoding")}},r.prototype.utf8Write=function(t,e,n){return r._charsWritten=a(o(t),this,e,n)},r.prototype.asciiWrite=function(t,e,n){return r._charsWritten=a(function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}(t),this,e,n)},r.prototype.base64Write=function(t,e,n){return r._charsWritten=a(s(t),this,e,n)},r.prototype.base64Slice=function(e,n){var r=Array.prototype.slice.apply(this,arguments);return t("base64-js").fromByteArray(r)},r.prototype.utf8Slice=function(){for(var t=Array.prototype.slice.apply(this,arguments),e="",n="",r=0;r<t.length;)t[r]<=127?(e+=c(n)+String.fromCharCode(t[r]),n=""):n+="%"+t[r].toString(16),r++;return e+c(n)},r.prototype.asciiSlice=function(){for(var t=Array.prototype.slice.apply(this,arguments),e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=i(this[r]),r==n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<SlowBuffer "+t.join(" ")+">"},r.prototype.hexSlice=function(t,e){var n=this.length;(!t||0>t)&&(t=0),(!e||0>e||e>n)&&(e=n);for(var r="",o=t;e>o;o++)r+=i(this[o]);return r},r.prototype.toString=function(t,e,n){if(t=String(t||"utf8").toLowerCase(),void 0===n&&(n=this.length),+n==(e=+e||0))return"";switch(t){case"hex":return this.hexSlice(e,n);case"utf8":case"utf-8":return this.utf8Slice(e,n);case"ascii":return this.asciiSlice(e,n);case"binary":return this.binarySlice(e,n);case"base64":return this.base64Slice(e,n);case"ucs2":case"ucs-2":return this.ucs2Slice(e,n);default:throw new Error("Unknown encoding")}},r.prototype.hexWrite=function(t,e,n){var i=this.length-(e=+e||0);n?(n=+n)>i&&(n=i):n=i;var o=t.length;if(o%2)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[e+s]=a}return r._charsWritten=2*s,s},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var i=r;r=e,e=n,n=i}var o=this.length-(e=+e||0);switch(n?(n=+n)>o&&(n=o):n=o,r=String(r||"utf8").toLowerCase()){case"hex":return this.hexWrite(t,e,n);case"utf8":case"utf-8":return this.utf8Write(t,e,n);case"ascii":return this.asciiWrite(t,e,n);case"binary":return this.binaryWrite(t,e,n);case"base64":return this.base64Write(t,e,n);case"ucs2":case"ucs-2":return this.ucs2Write(t,e,n);default:throw new Error("Unknown encoding")}},r.prototype.slice=function(t,e){if(void 0===e&&(e=this.length),e>this.length)throw new Error("oob");if(t>e)throw new Error("oob");return new h(this,e-t,+t)},r.prototype.copy=function(t,e,n,r){for(var i=[],o=n;r>o;o++)M.ok(void 0!==this[o],"copying undefined buffer bytes!"),i.push(this[o]);for(o=e;o<e+i.length;o++)t[o]=i[o-e]},n.SlowBuffer=r,n.Buffer=h,h.poolSize=8192,h.isBuffer=function(t){return t instanceof h||t instanceof r},h.concat=function(t,e){if(!Array.isArray(t))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===t.length)return new h(0);if(1===t.length)return t[0];if("number"!=typeof e){e=0;for(var n=0;n<t.length;n++)e+=(o=t[n]).length}var r=new h(e),i=0;for(n=0;n<t.length;n++){var o;(o=t[n]).copy(r,i),i+=o.length}return r},h.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=i(this.parent[r+this.offset]),r==n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"},h.prototype.get=function(t){if(0>t||t>=this.length)throw new Error("oob");return this.parent[this.offset+t]},h.prototype.set=function(t,e){if(0>t||t>=this.length)throw new Error("oob");return this.parent[this.offset+t]=e},h.prototype.write=function(t,e,n,i){if(isFinite(e))isFinite(n)||(i=n,n=void 0);else{var o=i;i=e,e=n,n=o}var s,a=this.length-(e=+e||0);switch(n?(n=+n)>a&&(n=a):n=a,i=String(i||"utf8").toLowerCase()){case"hex":s=this.parent.hexWrite(t,this.offset+e,n);break;case"utf8":case"utf-8":s=this.parent.utf8Write(t,this.offset+e,n);break;case"ascii":s=this.parent.asciiWrite(t,this.offset+e,n);break;case"binary":s=this.parent.binaryWrite(t,this.offset+e,n);break;case"base64":s=this.parent.base64Write(t,this.offset+e,n);break;case"ucs2":case"ucs-2":s=this.parent.ucs2Write(t,this.offset+e,n);break;default:throw new Error("Unknown encoding")}return h._charsWritten=r._charsWritten,s},h.prototype.toString=function(t,e,n){switch(t=String(t||"utf8").toLowerCase(),void 0===e||0>e?e=0:e>this.length&&(e=this.length),void 0===n||n>this.length?n=this.length:0>n&&(n=0),e+=this.offset,n+=this.offset,t){case"hex":return this.parent.hexSlice(e,n);case"utf8":case"utf-8":return this.parent.utf8Slice(e,n);case"ascii":return this.parent.asciiSlice(e,n);case"binary":return this.parent.binarySlice(e,n);case"base64":return this.parent.base64Slice(e,n);case"ucs2":case"ucs-2":return this.parent.ucs2Slice(e,n);default:throw new Error("Unknown encoding")}},h.byteLength=r.byteLength,h.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),"number"!=typeof t||isNaN(t))throw new Error("value is not a number");if(e>n)throw new Error("end < start");if(n===e)return 0;if(0==this.length)return 0;if(0>e||e>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");return this.parent.fill(t,e+this.offset,n+this.offset)},h.prototype.copy=function(t,e,n,r){var i=this;if(n||(n=0),r||(r=this.length),e||(e=0),n>r)throw new Error("sourceEnd < sourceStart");if(r===n)return 0;if(0==t.length||0==i.length)return 0;if(0>e||e>=t.length)throw new Error("targetStart out of bounds");if(0>n||n>=i.length)throw new Error("sourceStart out of bounds");if(0>r||r>i.length)throw new Error("sourceEnd out of bounds");return r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n),this.parent.copy(t.parent,e+t.offset,n+this.offset,r+this.offset)},h.prototype.slice=function(t,e){if(void 0===e&&(e=this.length),e>this.length)throw new Error("oob");if(t>e)throw new Error("oob");return new h(this.parent,e-t,+t+this.offset)},h.prototype.utf8Slice=function(t,e){return this.toString("utf8",t,e)},h.prototype.binarySlice=function(t,e){return this.toString("binary",t,e)},h.prototype.asciiSlice=function(t,e){return this.toString("ascii",t,e)},h.prototype.utf8Write=function(t,e){return this.write(t,e,"utf8")},h.prototype.binaryWrite=function(t,e){return this.write(t,e,"binary")},h.prototype.asciiWrite=function(t,e){return this.write(t,e,"ascii")},h.prototype.readUInt8=function(t,e){var n=this;return e||(M.ok(null!=t,"missing offset"),M.ok(t<n.length,"Trying to read beyond buffer length")),n.parent[n.offset+t]},h.prototype.readUInt16LE=function(t,e){return f(this,t,!1,e)},h.prototype.readUInt16BE=function(t,e){return f(this,t,!0,e)},h.prototype.readUInt32LE=function(t,e){return l(this,t,!1,e)},h.prototype.readUInt32BE=function(t,e){return l(this,t,!0,e)},h.prototype.readInt8=function(t,e){var n=this;return e||(M.ok(null!=t,"missing offset"),M.ok(t<n.length,"Trying to read beyond buffer length")),128&n.parent[n.offset+t]?-1*(255-n.parent[n.offset+t]+1):n.parent[n.offset+t]},h.prototype.readInt16LE=function(t,e){return p(this,t,!1,e)},h.prototype.readInt16BE=function(t,e){return p(this,t,!0,e)},h.prototype.readInt32LE=function(t,e){return d(this,t,!1,e)},h.prototype.readInt32BE=function(t,e){return d(this,t,!0,e)},h.prototype.readFloatLE=function(t,e){return g(this,t,!1,e)},h.prototype.readFloatBE=function(t,e){return g(this,t,!0,e)},h.prototype.readDoubleLE=function(t,e){return _(this,t,!1,e)},h.prototype.readDoubleBE=function(t,e){return _(this,t,!0,e)},h.prototype.writeUInt8=function(t,e,n){var r=this;n||(M.ok(null!=t,"missing value"),M.ok(null!=e,"missing offset"),M.ok(e<r.length,"trying to write beyond buffer length"),y(t,255)),r.parent[r.offset+e]=t},h.prototype.writeUInt16LE=function(t,e,n){v(this,t,e,!1,n)},h.prototype.writeUInt16BE=function(t,e,n){v(this,t,e,!0,n)},h.prototype.writeUInt32LE=function(t,e,n){m(this,t,e,!1,n)},h.prototype.writeUInt32BE=function(t,e,n){m(this,t,e,!0,n)},h.prototype.writeInt8=function(t,e,n){n||(M.ok(null!=t,"missing value"),M.ok(null!=e,"missing offset"),M.ok(e<this.length,"Trying to write beyond buffer length"),E(t,127,-128)),this.writeUInt8(t>=0?t:255+t+1,e,n)},h.prototype.writeInt16LE=function(t,e,n){b(this,t,e,!1,n)},h.prototype.writeInt16BE=function(t,e,n){b(this,t,e,!0,n)},h.prototype.writeInt32LE=function(t,e,n){x(this,t,e,!1,n)},h.prototype.writeInt32BE=function(t,e,n){x(this,t,e,!0,n)},h.prototype.writeFloatLE=function(t,e,n){k(this,t,e,!1,n)},h.prototype.writeFloatBE=function(t,e,n){k(this,t,e,!0,n)},h.prototype.writeDoubleLE=function(t,e,n){T(this,t,e,!1,n)},h.prototype.writeDoubleBE=function(t,e,n){T(this,t,e,!0,n)},r.prototype.readUInt8=h.prototype.readUInt8,r.prototype.readUInt16LE=h.prototype.readUInt16LE,r.prototype.readUInt16BE=h.prototype.readUInt16BE,r.prototype.readUInt32LE=h.prototype.readUInt32LE,r.prototype.readUInt32BE=h.prototype.readUInt32BE,r.prototype.readInt8=h.prototype.readInt8,r.prototype.readInt16LE=h.prototype.readInt16LE,r.prototype.readInt16BE=h.prototype.readInt16BE,r.prototype.readInt32LE=h.prototype.readInt32LE,r.prototype.readInt32BE=h.prototype.readInt32BE,r.prototype.readFloatLE=h.prototype.readFloatLE,r.prototype.readFloatBE=h.prototype.readFloatBE,r.prototype.readDoubleLE=h.prototype.readDoubleLE,r.prototype.readDoubleBE=h.prototype.readDoubleBE,r.prototype.writeUInt8=h.prototype.writeUInt8,r.prototype.writeUInt16LE=h.prototype.writeUInt16LE,r.prototype.writeUInt16BE=h.prototype.writeUInt16BE,r.prototype.writeUInt32LE=h.prototype.writeUInt32LE,r.prototype.writeUInt32BE=h.prototype.writeUInt32BE,r.prototype.writeInt8=h.prototype.writeInt8,r.prototype.writeInt16LE=h.prototype.writeInt16LE,r.prototype.writeInt16BE=h.prototype.writeInt16BE,r.prototype.writeInt32LE=h.prototype.writeInt32LE,r.prototype.writeInt32BE=h.prototype.writeInt32BE,r.prototype.writeFloatLE=h.prototype.writeFloatLE,r.prototype.writeFloatBE=h.prototype.writeFloatBE,r.prototype.writeDoubleLE=h.prototype.writeDoubleLE,r.prototype.writeDoubleBE=h.prototype.writeDoubleBE},{assert:1,"./buffer_ieee754":8,"base64-js":9}],9:[function(t,e,n){!function(t){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";e.exports.toByteArray=function(t){var e,r,i,o,s,a;if(t.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(a=[],i=(s=(s=t.indexOf("="))>0?t.length-s:0)>0?t.length-4:t.length,e=0,r=0;i>e;e+=4,r+=3)o=n.indexOf(t[e])<<18|n.indexOf(t[e+1])<<12|n.indexOf(t[e+2])<<6|n.indexOf(t[e+3]),a.push((16711680&o)>>16),a.push((65280&o)>>8),a.push(255&o);return 2===s?(o=n.indexOf(t[e])<<2|n.indexOf(t[e+1])>>4,a.push(255&o)):1===s&&(o=n.indexOf(t[e])<<10|n.indexOf(t[e+1])<<4|n.indexOf(t[e+2])>>2,a.push(o>>8&255),a.push(255&o)),a},e.exports.fromByteArray=function(t){function e(t){return n[t>>18&63]+n[t>>12&63]+n[t>>6&63]+n[63&t]}var r,i,o,s=t.length%3,a="";for(r=0,o=t.length-s;o>r;r+=3)a+=e(i=(t[r]<<16)+(t[r+1]<<8)+t[r+2]);switch(s){case 1:a+=n[(i=t[t.length-1])>>2],a+=n[i<<4&63],a+="==";break;case 2:a+=n[(i=(t[t.length-2]<<8)+t[t.length-1])>>10],a+=n[i>>4&63],a+=n[i<<2&63],a+="="}return a}}()},{}]},{},[]),e.exports=t("buffer-browserify")},{}],64:[function(t,e,n){var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;(e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)&&n.shift()()},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],65:[function(t,e,n){(function(){"use strict";function r(t){var e=function(t){return"string"==typeof t?t:"object"==typeof t&&t.hashCode?t.hashCode():""+t},n=t.declare({instance:{constructor:function(){this.__entries=[],this.__keys=[],this.__values=[]},pushValue:function(t,e){return this.__keys.push(t),this.__values.push(e),this.__entries.push({key:t,value:e}),e},remove:function(t){for(var e,n=this.__entries,r=this.__keys,i=this.__values,o=n.length-1;o>=0;o--)if((e=n[o])&&e.key===t)return n.splice(o,1),r.splice(o,1),i.splice(o,1),e.value;return null},set:function(t,e){for(var n=null,r=this.__entries,i=this.__values,o=r.length-1;o>=0;o--){var s=r[o];if(s&&t===s.key){i[o]=e,s.value=e,n=e;break}}return n||r.push({key:t,value:e}),n},find:function(t){for(var e,n=null,r=this.__entries,i=r.length-1;i>=0;i--)if((e=r[i])&&t===e.key){n=e.value;break}return n},getEntrySet:function(){return this.__entries},getKeys:function(){return this.__keys},getValues:function(t){return this.__values}}});return t.declare({instance:{constructor:function(){this.__map={}},entrySet:function(){var t=[],e=this.__map;for(var n in e)e.hasOwnProperty(n)&&(t=t.concat(e[n].getEntrySet()));return t},put:function(t,r){var i=e(t),o=null;return(o=this.__map[i])||(o=this.__map[i]=new n),o.pushValue(t,r),r},remove:function(t){var n=e(t),r=null,i=this.__map[n];return i&&(r=i.remove(t)),r},get:function(t){var n,r=e(t),i=null;return(n=this.__map[r])&&(i=n.find(t)),i},set:function(t,r){var i=e(t),o=null,s=this.__map;return(o=s[i])?o.set(t,r):(s[i]=new n).pushValue(t,r)},contains:function(t){var n=e(t),r=!1,i=null;return(i=this.__map[n])&&(r=!!i.find(t)),r},concat:function(t){if(t instanceof this._static){for(var e=new this._static,n=t.entrySet().concat(this.entrySet()),r=n.length-1;r>=0;r--){var i=n[r];e.put(i.key,i.value)}return e}throw new TypeError("When joining hashtables the joining arg must be a HashTable")},filter:function(e,n){for(var r=this.entrySet(),i=new this._static,o=(r=t.filter(r,e,n)).length-1;o>=0;o--){var s=r[o];i.put(s.key,s.value)}return i},forEach:function(e,n){var r=this.entrySet();t.forEach(r,e,n)},every:function(e,n){var r=this.entrySet();return t.every(r,e,n)},map:function(e,n){var r=this.entrySet();return t.map(r,e,n)},some:function(e,n){var r=this.entrySet();return t.some(r,e,n)},reduce:function(e,n){var r=this.entrySet();return t.reduce(r,e,n)},reduceRight:function(e,n){var r=this.entrySet();return t.reduceRight(r,e,n)},clear:function(){this.__map={}},keys:function(){var t=[],e=this.__map;for(var n in e)t=t.concat(e[n].getKeys());return t},values:function(){var t=[],e=this.__map;for(var n in e)t=t.concat(e[n].getValues());return t},isEmpty:function(){return 0===this.keys().length}}})}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended")().register("declare",t("declare.js")).register(t("is-extended")).register(t("array-extended")))):"function"==typeof define?define(["extended","declare","is-extended","array-extended"],function(t,e,n,i){return r(t().register("declare",e).register(n).register(i))}):this.Ht=r(this.extended().register("declare",this.declare).register(this.isExtended).register(this.arrayExtended))}).call(this)},{"array-extended":52,"declare.js":55,extended:56,"is-extended":66}],66:[function(t,e,n){var r=t("__browserify_Buffer").Buffer;(function(){"use strict";function i(t){function e(t,e){var n=-1,r=0,i=t.length,o=[];for(n+=e=e||0;++n<i;)o[r++]=t[n];return o}function n(t){var e=[];for(var n in t)w.call(t,n)&&e.push(n);return e}function i(t,e){if(t===e)return!0;if(void 0!==r&&r.isBuffer(t)&&r.isBuffer(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return l(t)&&l(e)?t.getTime()===e.getTime():f(t)&&f(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:(!p(t)||!p(e)||t===e)&&("object"!=typeof t&&"object"!=typeof e?t===e:o(t,e))}function o(t,e){var r;if(u(t)||u(e))return!1;if(t.prototype!==e.prototype)return!1;if(k(t))return!!k(e)&&i(t=E.call(t),e=E.call(e));try{var o,s=n(t),a=n(e);if(s.length!==a.length)return!1;for(s.sort(),a.sort(),o=s.length-1;o>=0;o--)if(s[o]!==a[o])return!1;for(o=s.length-1;o>=0;o--)if(!i(t[r=s[o]],e[r]))return!1}catch(c){return!1}return!0}function s(t){return null!==t&&"object"==typeof t}function a(t){return!0===t||!1===t||"[object Boolean]"===b.call(t)}function c(t){return void 0===t}function u(t){return c(t)||h(t)}function h(t){return null===t}function f(t){return"[object RegExp]"===b.call(t)}function l(t){return"[object Date]"===b.call(t)}function p(t){return"[object String]"===b.call(t)}function d(t,e){return t==e}function g(t,e){if(T(e)&&Array.prototype.indexOf||p(e))return e.indexOf(t)>-1;if(T(e))for(var n=0,r=e.length;r>n;n++)if(d(t,e[n]))return!0;return!1}function _(t,e){return p(e)?null!==(""+t).match(e):!!f(e)&&e.test(t)}function y(t,e){return w.call(t,e)}function v(t){M[t]=function(){this._testers.push(L[t])}}function m(t){N[t]=function(){var n,r=e(arguments,1),i=L[t],o=!0;if(r.length<=i.length-1)throw new TypeError("A handler must be defined when calling using switch");if(a(n=r.pop())&&(o=n,n=r.pop()),!x(n))throw new TypeError("handler must be defined");this._cases.push(function(t){return i.apply(L,t.concat(r))?[o,n.apply(this,t)]:[!1]})}}var E=Array.prototype.slice,w=Object.prototype.hasOwnProperty,b=Object.prototype.toString,x=function(t){return"[object Function]"===b.call(t)};"undefined"==typeof window||x(window.alert)||function(t){x=function(e){return"[object Function]"===b.call(e)||e===t}}(window.alert);var k=function(t){return"[object Arguments]"===b.call(t)};k(arguments)||(k=function(t){return!(!t||!w.call(t,"callee"))});var T=Array.isArray||function(t){return"[object Array]"===b.call(t)},L={isFunction:x,isObject:s,isEmpty:function(t){return k(t)?0===t.length:s(t)?0===n(t).length:!p(t)&&!T(t)||0===t.length},isHash:function(t){return s(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},isNumber:function(t){return"[object Number]"===b.call(t)},isString:p,isDate:l,isArray:T,isBoolean:a,isUndefined:c,isDefined:function(t){return!c(t)},isUndefinedOrNull:u,isNull:h,isArguments:k,instanceOf:function(t,e){return!!x(e)&&t instanceof e},isRegExp:f,deepEqual:i,isTrue:function(t){return!0===t},isFalse:function(t){return!1===t},isNotNull:function(t){return!h(t)},isEq:d,isNeq:function(t,e){return t!=e},isSeq:function(t,e){return t===e},isSneq:function(t,e){return t!==e},isIn:g,isNotIn:function(t,e){return!g(t,e)},isLt:function(t,e){return e>t},isLte:function(t,e){return e>=t},isGt:function(t,e){return t>e},isGte:function(t,e){return t>=e},isLike:_,isNotLike:function(t,e){return!_(t,e)},contains:function(t,e){return g(e,t)},notContains:function(t,e){return!g(e,t)},has:y,notHas:function(t,e){return!y(t,e)},isLength:function(t,e){return!!y(t,"length")&&t.length===e},isNotLength:function(t,e){return!!y(t,"length")&&t.length!==e},containsAt:function(t,e,n){return!!(T(t)&&t.length>n)&&d(t[n],e)},notContainsAt:function(t,e,n){return!!T(t)&&!d(t[n],e)}},M={constructor:function(){this._testers=[]},noWrap:{tester:function(){var t=this._testers;return function(e){for(var n=!1,r=0,i=t.length;i>r&&!n;r++)n=t[r](e);return n}}}},N={constructor:function(){this._cases=[],this.__default=null},def:function(t,e){this.__default=e},noWrap:{switcher:function(){var t=this._cases,n=this.__default;return function(){for(var r,i=e(arguments),o=0,s=t.length;s>o;o++)if((r=t[o](i)).length>1&&(r[1]||r[0]))return r[1];return n?n.apply(this,i):void 0}}}};for(var I in L)w.call(L,I)&&(m(I),v(I));var O=t.define(L).expose(L);return O.tester=t.define(M),O.switcher=t.define(N),O}void 0!==n?void 0!==e&&e.exports&&(e.exports=i(t("extended"))):"function"==typeof define&&define.amd?define(["extended"],function(t){return i(t)}):this.isExtended=i(this.extended)}).call(this)},{__browserify_Buffer:63,extended:56}],67:[function(t,e,n){(function(){"use strict";function r(t){function e(t,e){return t>e?1:e>t?-1:e?0:1}var n=t.multiply,r=t.declare({instance:{__printNode:function(e,r){var i=[];t.isUndefinedOrNull(e)?(i.push(n("\t",r)),i.push("~"),console.log(i.join(""))):(this.__printNode(e.right,r+1),i.push(n("\t",r)),i.push(e.data+"\n"),console.log(i.join("")),this.__printNode(e.left,r+1))},constructor:function(t){this.compare=(t=t||{}).compare||e,this.__root=null},insert:function(){throw new Error("Not Implemented")},remove:function(){throw new Error("Not Implemented")},clear:function(){this.__root=null},isEmpty:function(){return!this.__root},traverseWithCondition:function(t,e,n){var i=!0;return t&&((e=e||r.PRE_ORDER)===r.PRE_ORDER?(i=n(t.data))&&(i=this.traverseWithCondition(t.left,e,n))&&(i=this.traverseWithCondition(t.right,e,n)):e===r.IN_ORDER?(i=this.traverseWithCondition(t.left,e,n))&&(i=n(t.data))&&(i=this.traverseWithCondition(t.right,e,n)):e===r.POST_ORDER?(i=this.traverseWithCondition(t.left,e,n))&&(i&&(i=this.traverseWithCondition(t.right,e,n)),i&&(i=n(t.data))):e===r.REVERSE_ORDER&&(i=this.traverseWithCondition(t.right,e,n))&&(i=n(t.data))&&(i=this.traverseWithCondition(t.left,e,n))),i},traverse:function(t,e,n){t&&((e=e||r.PRE_ORDER)===r.PRE_ORDER?(n(t.data),this.traverse(t.left,e,n),this.traverse(t.right,e,n)):e===r.IN_ORDER?(this.traverse(t.left,e,n),n(t.data),this.traverse(t.right,e,n)):e===r.POST_ORDER?(this.traverse(t.left,e,n),this.traverse(t.right,e,n),n(t.data)):e===r.REVERSE_ORDER&&(this.traverse(t.right,e,n),n(t.data),this.traverse(t.left,e,n)))},forEach:function(t,e,n){if("function"!=typeof t)throw new TypeError;e=e||this,this.traverse(this.__root,n=n||r.IN_ORDER,function(n){t.call(e,n,this)})},map:function(t,e,n){if("function"!=typeof t)throw new TypeError;n=n||r.IN_ORDER,e=e||this;var i=new this._static;return this.traverse(this.__root,n,function(n){i.insert(t.call(e,n,this))}),i},filter:function(t,e,n){if("function"!=typeof t)throw new TypeError;n=n||r.IN_ORDER,e=e||this;var i=new this._static;return this.traverse(this.__root,n,function(n){t.call(e,n,this)&&i.insert(n)}),i},reduce:function(e,n,r){var i=[this.toArray(r),e];return t.isUndefinedOrNull(n)||i.push(n),t.reduce.apply(t,i)},reduceRight:function(e,n,r){var i=[this.toArray(r),e];return t.isUndefinedOrNull(n)||i.push(n),t.reduceRight.apply(t,i)},every:function(t,e,n){if("function"!=typeof t)throw new TypeError;e=e||this;var i=!1;return this.traverseWithCondition(this.__root,n=n||r.IN_ORDER,function(n){return i=t.call(e,n,this)}),i},some:function(t,e,n){if("function"!=typeof t)throw new TypeError;var i;return e=e||this,this.traverseWithCondition(this.__root,n=n||r.IN_ORDER,function(n){return!(i=t.call(e,n,this))}),i},toArray:function(t){var e=[];return this.traverse(this.__root,t=t||r.IN_ORDER,function(t){e.push(t)}),e},contains:function(t){for(var e=!1,n=this.__root;null!==n;){var r=this.compare(t,n.data);r?n=n[-1===r?"left":"right"]:(e=!0,n=null)}return e},find:function(t){for(var e,n=this.__root;n;){var r=this.compare(t,n.data);if(!r){e=n.data;break}n=n[-1===r?"left":"right"]}return e},findLessThan:function(t,e){var n=[],i=this.compare;return this.traverseWithCondition(this.__root,r.IN_ORDER,function(r){var o=i(t,r);return(!e&&0===o||1===o)&&(n.push(r),!0)}),n},findGreaterThan:function(t,e){var n=[],i=this.compare;return this.traverse(this.__root,r.REVERSE_ORDER,function(r){var o=i(t,r);return(!e&&0===o||-1===o)&&(n.push(r),!0)}),n},print:function(){this.__printNode(this.__root,0)}},static:{PRE_ORDER:"pre_order",IN_ORDER:"in_order",POST_ORDER:"post_order",REVERSE_ORDER:"reverse_order"}}),i=function(){var t=Math.abs,e=function(t){return{data:t,balance:0,left:null,right:null}},i=function(t,e,n){var r=t[n];return t[n]=r[e],r[e]=t,r},o=function(t,e,n){return t[n]=i(t[n],n,e),i(t,e,n)},s=function(t,e,n){var r=t[e],i=r["left"===e?"right":"left"];0===i.balance?t.balance=r.balance=0:i.balance===n?(t.balance=-n,r.balance=0):(t.balance=0,r.balance=n),i.balance=0},a=function(t,e){var n="left"===e?"right":"left",r=t[e],a="right"===e?-1:1;return r.balance===a?(t.balance=r.balance=0,t=i(t,n,e)):(s(t,e,a),t=o(t,n,e)),t},c=function(t,e,n){var r="left"===e?"right":"left",a=t[r],c="right"===e?-1:1;return a.balance===-c?(t.balance=a.balance=0,t=i(t,e,r)):a.balance===c?(s(t,r,-c),t=o(t,e,r)):(t.balance=-c,a.balance=c,t=i(t,e,r),n.done=!0),t};return r.extend({instance:{insert:function(n){!function(n,r,i){var o=n.__root;if(null==o)n.__root=e(r);else{for(var s,c=o,u=[],h=[],f=0;;){if(s=u[f]=-1===i(r,c.data)?"left":"right",h[f++]=c,!c[s]){c[s]=e(r);break}c=c[s]}if(!c[s])return null;for(;--f>=0&&(h[f].balance+="right"===u[f]?-1:1,0!==h[f].balance);)if(t(h[f].balance)>1){h[f]=a(h[f],u[f]),0!==f?h[f-1][u[f-1]]=h[f]:n.__root=h[0];break}}}(this,n,this.compare)},remove:function(e){!function(e,n,r){var i=e.__root;if(null!=i){for(var o,s,a=i,u=0,h=[],f=[],l={done:!1};;){if(!a)return;if(0===(s=r(n,a.data)))break;o=f[u]=-1===s?"left":"right",h[u++]=a,a=a[o]}var p=a.left;if(p&&a.right){var d=p;for(f[u]="left",h[u++]=a;d.right;)f[u]="right",h[u++]=d,d=d.right;a.data=d.data,h[u-1][h[u-1]===a?"left":"right"]=d.left}else o=p?"left":"right",0!==u?h[u-1][f[u-1]]=a[o]:e.__root=a[o];for(;--u>=0&&!l.done&&(h[u].balance+="left"===f[u]?-1:1,1!==t(h[u].balance));)t(h[u].balance)>1&&(h[u]=c(h[u],f[u],l),0!==u?h[u-1][f[u-1]]=h[u]:e.__root=h[0])}}(this,e,this.compare)},__printNode:function(t,e){var r=[];t?(this.__printNode(t.right,e+1),r.push(n("\t",e)),r.push(t.data+":"+t.balance+"\n"),console.log(r.join("")),this.__printNode(t.left,e+1)):(r.push(n("\t",e)),r.push("~"),console.log(r.join("")))}}})}(),o=function(){function t(t){if(0!==t.level&&t.left.level===t.level){var e=t.left;t.left=e.right,e.right=t,t=e}return t}function e(t){if(0!==t.level&&t.right.right.level===t.level){var e=t.right;t.right=e.left,e.left=t,(t=e).level++}return t}var i={level:0,data:null},o=function(n,r,s){var a;if(n!==i){var c=s(r,n.data);if(0===c)if((a=n.left)!==i&&n.right!==i){for(var u=a;u.right!==i;)u=u.right;n.data=u.data,n.left=o(a,u.data,s)}else n=n[a===i?"right":"left"];else{var h=-1===c?"left":"right";n[h]=o(n[h],r,s)}}if(n!==i){var f=n.level,l=n.right.level;(f-1>n.left.level||f-1>l)&&(l>--n.level&&(n.right.level=n.level),n=e(n=t(n)))}return n};return r.extend({instance:{isEmpty:function(){return this.__root===i||this._super(arguments)},insert:function(n){this.__root||(this.__root=i),this.__root=function n(r,o,s){if(r===i)r={data:o,level:1,left:i,right:i};else{var a=-1===s(o,r.data)?"left":"right";r[a]=n(r[a],o,s),r=e(r=t(r))}return r}(this.__root,n,this.compare)},remove:function(t){this.__root=o(this.__root,t,this.compare)},traverseWithCondition:function(t){return t===i||this._super(arguments)},traverse:function(t){t!==i&&this._super(arguments)},contains:function(){return this.__root!==i&&this._super(arguments)},__printNode:function(t,e){var r=[];t&&t.data?(this.__printNode(t.right,e+1),r.push(n("\t",e)),r.push(t.data+":"+t.level+"\n"),console.log(r.join("")),this.__printNode(t.left,e+1)):(r.push(n("\t",e)),r.push("~"),console.log(r.join("")))}}})}(),s=r.extend({instance:{insert:function(t){if(!this.__root)return this.__root={data:t,parent:null,left:null,right:null},this.__root;for(var e=this.compare,n=this.__root;null!==n;){var r=e(t,n.data);if(!r)return;var i=-1===r?"left":"right",o=n[i];if(!o)return n[i]={data:t,parent:n,left:null,right:null};n=o}},remove:function(t){if(null!==this.__root){for(var e,n={right:this.__root},r=n,i=null,o="right";null!==r[o];){e=r;var s=this.compare(t,(r=r[o]).data);s||(i=r),o=-1===s?"left":"right"}null!==i&&(i.data=r.data,e[e.right===r?"right":"left"]=r[null===r.left?"right":"left"]),this.__root=n.right}}}}),a=function(){var t=function(t){return null!==t&&t.red},e=function(n,r,s){if(!n)return{data:r,red:!0,left:null,right:null};var a=s(r,n.data);if(a){var c=-1===a?"left":"right",u="left"===c?"right":"left";n[c]=e(n[c],r,s);var h=n[c];if(t(h)){var f=n[u];t(f)?(n.red=!0,h.red=!1,f.red=!1):t(h[c])?n=i(n,u):t(h[u])&&(n=o(n,u))}}return n},i=function(t,e){var n="left"===e?"right":"left",r=t[n];return t[n]=r[e],r[e]=t,t.red=!0,r.red=!1,r},o=function(t,e){var n="left"===e?"right":"left";return t[n]=i(t[n],n),i(t,e)},s=function(e,n,r,i){if(e){var o;if(0===i(n,e.data)){if(!e.left||!e.right){var c=e[e.left?"left":"right"];return t(e)?r.done=!0:t(c)&&(c.red=!1,r.done=!0),c}for(var u,h=e.right;null!==h.left;)u=h,h=h.left;u&&(u.left=null),e.data=h.data,n=h.data}e[o=-1===i(n,e.data)?"left":"right"]=s(e[o],n,r,i),r.done||(e=a(e,o,r))}else r.done=!0;return e},a=function(e,n,r){var s="left"===n?"right":"left",a=e,c=a[s];if(t(c)&&(e=i(e,n),c=a[s]),null!==c)if(t(c.left)||t(c.right)){var u=a.red,h=e===a;(a=(t(c[s])?i:o)(a,n)).red=u,a.left.red=a.right.red=0,h?e=a:e[n]=a,r.done=!0}else t(a)&&(r.done=!0),a.red=0,c.red=1;return e};return r.extend({instance:{insert:function(t){this.__root=e(this.__root,t,this.compare),this.__root.red=!1},remove:function(t){var e=s(this.__root,t,{done:!1},this.compare);return null!==e&&(e.red=0),this.__root=e,t},__printNode:function(t,e){var r=[];t?(this.__printNode(t.right,e+1),r.push(n("\t",e)),r.push((t.red?"RED":"BLACK")+":"+t.data+"\n"),console.log(r.join("")),this.__printNode(t.left,e+1)):(r.push(n("\t",e)),r.push("~"),console.log(r.join("")))}}})}();return{Tree:r,AVLTree:i,AnderssonTree:o,BinaryTree:s,RedBlackTree:a,IN_ORDER:r.IN_ORDER,PRE_ORDER:r.PRE_ORDER,POST_ORDER:r.POST_ORDER,REVERSE_ORDER:r.REVERSE_ORDER}}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended")().register("declare",t("declare.js")).register(t("is-extended")).register(t("array-extended")).register(t("string-extended")))):"function"==typeof define?define(["extended","declare.js","is-extended","array-extended","string-extended"],function(t,e,n,i,o){return r(t().register("declare",e).register(n).register(i).register(o))}):this.leafy=r(this.extended().register("declare",this.declare).register(this.isExtended).register(this.arrayExtended).register(this.stringExtended))}).call(this)},{"array-extended":52,"declare.js":55,extended:56,"is-extended":66,"string-extended":70}],68:[function(t,e,n){(function(){"use strict";function r(t,e,n){function r(t,e){var n,r;for(n in e)p.call(e,n)&&(r=e[n],n in t&&t[n]===r||(t[n]=r));return t}function i(t,e){var n,r,o;for(n in e)p.call(e,n)&&(u(o=t[n],r=e[n])||(t[n]=f(o)&&f(r)?i(o,r):f(r)?i({},r):r));return t}function o(t){t||(t={});for(var e=1,n=arguments.length;n>e;e++)r(t,arguments[e]);return t}function s(t,e){return o(t.prototype||t,e),t}function a(t){if(!f(t))throw new TypeError;var e=[];for(var n in t)p.call(t,n)&&e.push(n);return e}function c(t,e){if(!f(t))throw new TypeError;h(e)&&(e=[e]);for(var n,r=l(a(t),e),i={},o=0,s=r.length;s>o;++o)i[n=r[o]]=t[n];return i}var u=e.deepEqual,h=e.isString,f=e.isHash,l=n.difference,p=Object.prototype.hasOwnProperty,d=e.isFunction,g={forEach:function(t,e,n){if(!f(t)||!d(e))throw new TypeError;for(var r,i=a(t),o=0,s=i.length;s>o;++o)e.call(n||t,t[r=i[o]],r,t);return t},filter:function(t,e,n){if(!f(t)||!d(e))throw new TypeError;for(var r,i,o=a(t),s={},c=0,u=o.length;u>c;++c)e.call(n||t,i=t[r=o[c]],r,t)&&(s[r]=i);return s},invert:function(t){if(!f(t))throw new TypeError;for(var e,n=a(t),r={},i=0,o=n.length;o>i;++i)r[t[e=n[i]]]=e;return r},values:function(t){if(!f(t))throw new TypeError;for(var e=a(t),n=[],r=0,i=e.length;i>r;++r)n.push(t[e[r]]);return n},toArray:function(t){if(!f(t))throw new TypeError;for(var e,n=a(t),r=[],i=0,o=n.length;o>i;++i)r.push([e=n[i],t[e]]);return r},keys:a,omit:c},_={extend:s,merge:o,deepMerge:function(t){t||(t={});for(var e=1,n=arguments.length;n>e;e++)i(t,arguments[e]);return t},omit:c},y=t.define(e.isObject,_).define(f,g).define(e.isFunction,{extend:s}).expose({hash:g}).expose(_),v=y.extend;return y.extend=function(){return 1===arguments.length?v.extend.apply(y,arguments):void s.apply(null,arguments)},y}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended"),t("is-extended"),t("array-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended","array-extended"],function(t,e,n){return r(t,e,n)}):this.objectExtended=r(this.extended,this.isExtended,this.arrayExtended)}).call(this)},{"array-extended":52,extended:56,"is-extended":66}],69:[function(t,e,n){var r=t("__browserify_process");(function(){"use strict";function i(t,e,n,i,o,s){function a(t,e){return function(){try{h(t.apply(null,arguments)).addCallback(e).addErrback(e)}catch(n){e.errback(n)}}}function c(t,e,n){var r=(new k).callback();return p(t,function(t){r=r.then(n?t:m(null,t)),n||(r=r.then(function(t){return e.push(t),e}))}),r}function u(t){return!d(t)&&_(t.then)}function h(t){var e;return(t=E(arguments)).length?1===t.length?u(t=t.pop())?t.addCallback&&t.addErrback?(e=new k,t.addCallback(e.callback),t.addErrback(e.errback)):e=function(t){var e=new k;return t.then(v(e,"callback"),v(e,"errback")),e.promise()}(t):e=g(t)&&n.every(t,u)?new T(t,!0).promise():(new k).callback(t):e=new T(n.map(t,function(t){return h(t)}),!0).promise():e=(new k).callback(t).promise(),e}function f(){return new k}var l,p=n.forEach,d=i.isUndefinedOrNull,g=i.isArray,_=i.isFunction,y=i.isBoolean,v=o.bind,m=o.bindIgnore,E=s.argsToArray;if("function"==typeof setImmediate)l="undefined"!=typeof window?setImmediate.bind(window):setImmediate;else if(void 0!==r)l=function(t){r.nextTick(t)};else if("undefined"!=typeof MessageChannel){var w=new MessageChannel,b={},x=b;w.port1.onmessage=function(){var t=(b=b.next).task;delete b.task,t()},l=function(t){x=x.next={task:t},w.port2.postMessage(0)}}else l=function(t){setTimeout(t,0)};var k=t({instance:{__fired:!1,__results:null,__error:null,__errorCbs:null,__cbs:null,constructor:function(){this.__errorCbs=[],this.__cbs=[],o.bindAll(this,["callback","errback","resolve","classic","__resolve","addCallback","addErrback"])},__resolve:function(){if(!this.__fired){this.__fired=!0;var t,e=this.__error?this.__errorCbs:this.__cbs,n=e.length,r=this.__error||this.__results;for(t=0;n>t;t++)this.__callNextTick(e[t],r)}},__callNextTick:function(t,e){l(function(){t.apply(this,e)})},addCallback:function(t){return t&&(u(t)&&t.callback&&(t=t.callback),this.__fired&&this.__results?this.__callNextTick(t,this.__results):this.__cbs.push(t)),this},addErrback:function(t){return t&&(u(t)&&t.errback&&(t=t.errback),this.__fired&&this.__error?this.__callNextTick(t,this.__error):this.__errorCbs.push(t)),this},callback:function(t){return this.__fired||(this.__results=arguments,this.__resolve()),this.promise()},errback:function(t){return this.__fired||(this.__error=arguments,this.__resolve()),this.promise()},resolve:function(t,e){return t?this.errback(t):this.callback.apply(this,E(arguments,1)),this},classic:function(t){return"function"==typeof t&&(this.addErrback(function(e){t(e)}),this.addCallback(function(){t.apply(this,[null].concat(E(arguments)))})),this},then:function(t,e){var n=new k,r=n;return _(e)&&(r=a(e,n)),this.addErrback(r),_(t)?this.addCallback(a(t,n)):this.addCallback(n),n.promise()},both:function(t){return this.then(t,t)},promise:function(){var t={then:v(this,"then"),both:v(this,"both"),promise:function(){return t}};return p(["addCallback","addErrback","classic"],function(e){t[e]=v(this,function(){return this[e].apply(this,arguments),t})},this),t}}}),T=k.extend({instance:{__results:null,__errors:null,__promiseLength:0,__defLength:0,__firedLength:0,normalizeResults:!1,constructor:function(t,e){this.__errors=[],this.__results=[],this.normalizeResults=!!y(e)&&e,this._super(arguments),t&&t.length?(this.__defLength=t.length,p(t,this.__addPromise,this)):this.__resolve()},__addPromise:function(t,e){t.then(v(this,function(){var t=E(arguments);t.unshift(e),this.callback.apply(this,t)}),v(this,function(){var t=E(arguments);t.unshift(e),this.errback.apply(this,t)}))},__resolve:function(){if(!this.__fired){this.__fired=!0;var t,e=this.__errors.length?this.__errorCbs:this.__cbs,n=e.length,r=this.__errors.length?this.__errors:this.__results;for(t=0;n>t;t++)this.__callNextTick(e[t],r)}},__callNextTick:function(t,e){l(function(){t.apply(null,[e])})},addCallback:function(t){return t&&(u(t)&&t.callback&&(t=v(t,"callback")),this.__fired&&!this.__errors.length?this.__callNextTick(t,this.__results):this.__cbs.push(t)),this},addErrback:function(t){return t&&(u(t)&&t.errback&&(t=v(t,"errback")),this.__fired&&this.__errors.length?this.__callNextTick(t,this.__errors):this.__errorCbs.push(t)),this},callback:function(t){if(this.__fired)throw new Error("Already fired!");var e=E(arguments);return this.normalizeResults&&(e=1===(e=e.slice(1)).length?e.pop():e),this.__results[t]=e,this.__firedLength++,this.__firedLength===this.__defLength&&this.__resolve(),this.promise()},errback:function(t){if(this.__fired)throw new Error("Already fired!");var e=E(arguments);return this.normalizeResults&&(e=1===(e=e.slice(1)).length?e.pop():e),this.__errors[t]=e,this.__firedLength++,this.__firedLength===this.__defLength&&this.__resolve(),this.promise()}}});return e.define({isPromiseLike:u}).expose({isPromiseLike:u,when:h,wrap:function(t,e){return function(){var n=new k,r=E(arguments);return r.push(n.resolve),t.apply(e||this,r),n.promise()}},wait:function(t,e){t=E(arguments);var n=!1;e=t.pop();var r=h(t);return function(){return n?h(e.apply(this,arguments)):(t=arguments,r.then(v(this,function(){return n=!0,e.apply(this,t)})))}},serial:function(t){if(g(t))return c(t,[],!1);throw new Error("When calling promise.serial the first argument must be an array")},chain:function(t){if(g(t))return c(t,[],!0);throw new Error("When calling promise.serial the first argument must be an array")},Promise:k,PromiseList:T,promise:f,defer:f,deferredList:function(t){return new T(t,!0).promise()},reject:function(t){return f().errback(t)},resolve:function(t){return f().callback(t)}})}void 0!==n?void 0!==e&&e.exports&&(e.exports=i(t("declare.js"),t("extended"),t("array-extended"),t("is-extended"),t("function-extended"),t("arguments-extended"))):"function"==typeof define&&define.amd?define(["declare","extended","array-extended","is-extended","function-extended","arguments-extended"],function(t,e,n,r,o,s){return i(t,e,n,r,o,s)}):this.promiseExtended=i(this.declare,this.extended,this.arrayExtended,this.isExtended,this.functionExtended,this.argumentsExtended)}).call(this)},{__browserify_process:64,"arguments-extended":51,"array-extended":52,"declare.js":55,extended:56,"function-extended":59,"is-extended":66}],70:[function(t,e,n){(function(){"use strict";function r(t,e,n,r){function i(t,e){var n=t;if(g.test(e)){var r=e.match(g),i=r[1],o=r[3],s=r[4];s&&(s=parseInt(s,10),n=n.length<s?a(n,s,o,i):c(n,s))}return n}function o(t,n){var r;if(!e.isNumber(t))throw new Error("stringExtended.format : when using %d the parameter must be a number!");if(r=""+t,g.test(n)){var i=n.match(g),o=i[1],s=i[3],u=i[4];i[2]&&(r=(t>0?"+":"")+r),u&&(u=parseInt(u,10),r=r.length<u?a(r,u,s||"0",o):c(r,u))}return r}function s(t,e){var n,r=e.match(_),i=0;r&&(i=parseInt(r[0],10),isNaN(i)&&(i=0));try{n=h(t,null,i)}catch(o){throw new Error("stringExtended.format : Unable to parse json from ",t)}return n}function a(t,e,n,r){n=n||" ";for(var i=(t=""+t).length;e>i;)r?t+=n:t=n+t,i++;return t}function c(t,n,r){var i=t;if(e.isString(i)){if(t.length>n)if(r){var o=t.length;i=t.substring(o-n,o)}else i=t.substring(0,n)}else i=c(""+i,n);return i}function u(t,n){var r,i,o;if(n)if(e.isArray(t))for(r=[],i=0,o=t.length;o>i;i++)r.push(u(t[i],n));else if(n instanceof Array)for(r=t,i=0,o=n.length;o>i;i++)r=u(r,n[i]);else n in y&&(r="\x1b["+y[n]+"m"+t+"\x1b[0m");return r}var h;"undefined"==typeof JSON?function(){function t(t){return 10>t?"0"+t:t}function n(n){return e.isDate(n)?isFinite(n.valueOf())?n.getUTCFullYear()+"-"+t(n.getUTCMonth()+1)+"-"+t(n.getUTCDate())+"T"+t(n.getUTCHours())+":"+t(n.getUTCMinutes())+":"+t(n.getUTCSeconds())+"Z":null:c(n)?n.valueOf():n}function r(t){return u.lastIndex=0,u.test(t)?'"'+t.replace(u,function(t){var e=f[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function i(t,e){var c,u,h,f,l,p=o,d=e[t];switch(d&&(d=n(d)),"function"==typeof a&&(d=a.call(e,t,d)),typeof d){case"string":return r(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(o+=s,l=[],"[object Array]"===Object.prototype.toString.apply(d)){for(f=d.length,c=0;f>c;c+=1)l[c]=i(c,d)||"null";return h=0===l.length?"[]":o?"[\n"+o+l.join(",\n"+o)+"\n"+p+"]":"["+l.join(",")+"]",o=p,h}if(a&&"object"==typeof a)for(f=a.length,c=0;f>c;c+=1)"string"==typeof a[c]&&(h=i(u=a[c],d))&&l.push(r(u)+(o?": ":":")+h);else for(u in d)Object.prototype.hasOwnProperty.call(d,u)&&(h=i(u,d))&&l.push(r(u)+(o?": ":":")+h);return h=0===l.length?"{}":o?"{\n"+o+l.join(",\n"+o)+"\n"+p+"}":"{"+l.join(",")+"}",o=p,h}}var o,s,a,c=e.tester().isString().isNumber().isBoolean().tester(),u=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};h=function(t,e,n){var r;if(o="",s="","number"==typeof n)for(r=0;n>r;r+=1)s+=" ";else"string"==typeof n&&(s=n);if(a=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return i("",{"":t})}}():h=JSON.stringify;var f=e.isHash,l=Array.prototype.slice,p=/%((?:-?\+?.?\d*)?|(?:\[[^\[|\]]*\]))?([sjdDZ])/g,d=/\{(?:\[([^\[|\]]*)\])?(\w+)\}/g,g=/(-?)(\+?)([A-Z|a-z|\W]?)([1-9][0-9]*)?$/,_=/([1-9][0-9]*)$/g,y={bold:1,bright:1,italic:3,underline:4,blink:5,inverse:7,crossedOut:9,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,redBackground:41,greenBackground:42,yellowBackground:43,blueBackground:44,magentaBackground:45,cyanBackground:46,whiteBackground:47,encircled:52,overlined:53,grey:90,black:90},v={toArray:function(t,e){var n=[];return t&&(t.indexOf(e)>0?n=t.replace(/\s+/g,"").split(e):n.push(t)),n},pad:a,truncate:c,multiply:function(t,e){var n=[];if(e)for(var r=0;e>r;r++)n.push(t);return n.join("")},format:function t(r,a){if(a instanceof Array){var c=0,g=a.length;return r.replace(p,function(t,e,r){var f,l;if(!(g>c))return t;if(f=a[c++],"%s"===t||"%d"===t||"%D"===t)l=f+"";else if("%Z"===t)l=f.toUTCString();else if("%j"===t)try{l=h(f)}catch(u){throw new Error("stringExtended.format : Unable to parse json from ",f)}else switch(e=e.replace(/^\[|\]$/g,""),r){case"s":l=i(f,e);break;case"d":l=o(f,e);break;case"j":l=s(f,e);break;case"D":l=n.format(f,e);break;case"Z":l=n.format(f,e,!0)}return l})}return f(a)?r.replace(d,function(t,r,c){if(!e.isUndefined(c=a[c])){if(!r)return""+c;if(e.isString(c))return i(c,r);if(e.isNumber(c))return o(c,r);if(e.isDate(c))return n.format(c,r);if(e.isObject(c))return s(c,r)}return t}):t(r,l.call(arguments).slice(1))},style:u,escape:function(t,e){return t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(t){return e&&-1!==r.indexOf(e,t)?t:"\\"+t})},trim:function(t){return t.replace(/^\s*|\s*$/g,"")},trimLeft:function(t){return t.replace(/^\s*/,"")},trimRight:function(t){return t.replace(/\s*$/,"")},isEmpty:function(t){return 0===t.length}};return t.define(e.isString,v).define(e.isArray,{style:u}).expose(v).expose({characters:{SMILEY:"\u263a",SOLID_SMILEY:"\u263b",HEART:"\u2665",DIAMOND:"\u2666",CLOVE:"\u2663",SPADE:"\u2660",DOT:"\u2022",SQUARE_CIRCLE:"\u25d8",CIRCLE:"\u25cb",FILLED_SQUARE_CIRCLE:"\u25d9",MALE:"\u2642",FEMALE:"\u2640",EIGHT_NOTE:"\u266a",DOUBLE_EIGHTH_NOTE:"\u266b",SUN:"\u263c",PLAY:"\u25ba",REWIND:"\u25c4",UP_DOWN:"\u2195",PILCROW:"\xb6",SECTION:"\xa7",THICK_MINUS:"\u25ac",SMALL_UP_DOWN:"\u21a8",UP_ARROW:"\u2191",DOWN_ARROW:"\u2193",RIGHT_ARROW:"\u2192",LEFT_ARROW:"\u2190",RIGHT_ANGLE:"\u221f",LEFT_RIGHT_ARROW:"\u2194",TRIANGLE:"\u25b2",DOWN_TRIANGLE:"\u25bc",HOUSE:"\u2302",C_CEDILLA:"\xc7",U_UMLAUT:"\xfc",E_ACCENT:"\xe9",A_LOWER_CIRCUMFLEX:"\xe2",A_LOWER_UMLAUT:"\xe4",A_LOWER_GRAVE_ACCENT:"\xe0",A_LOWER_CIRCLE_OVER:"\xe5",C_LOWER_CIRCUMFLEX:"\xe7",E_LOWER_CIRCUMFLEX:"\xea",E_LOWER_UMLAUT:"\xeb",E_LOWER_GRAVE_ACCENT:"\xe8",I_LOWER_UMLAUT:"\xef",I_LOWER_CIRCUMFLEX:"\xee",I_LOWER_GRAVE_ACCENT:"\xec",A_UPPER_UMLAUT:"\xc4",A_UPPER_CIRCLE:"\xc5",E_UPPER_ACCENT:"\xc9",A_E_LOWER:"\xe6",A_E_UPPER:"\xc6",O_LOWER_CIRCUMFLEX:"\xf4",O_LOWER_UMLAUT:"\xf6",O_LOWER_GRAVE_ACCENT:"\xf2",U_LOWER_CIRCUMFLEX:"\xfb",U_LOWER_GRAVE_ACCENT:"\xf9",Y_LOWER_UMLAUT:"\xff",O_UPPER_UMLAUT:"\xd6",U_UPPER_UMLAUT:"\xdc",CENTS:"\xa2",POUND:"\xa3",YEN:"\xa5",CURRENCY:"\xa4",PTS:"\u20a7",FUNCTION:"\u0192",A_LOWER_ACCENT:"\xe1",I_LOWER_ACCENT:"\xed",O_LOWER_ACCENT:"\xf3",U_LOWER_ACCENT:"\xfa",N_LOWER_TILDE:"\xf1",N_UPPER_TILDE:"\xd1",A_SUPER:"\xaa",O_SUPER:"\xba",UPSIDEDOWN_QUESTION:"\xbf",SIDEWAYS_L:"\u2310",NEGATION:"\xac",ONE_HALF:"\xbd",ONE_FOURTH:"\xbc",UPSIDEDOWN_EXCLAMATION:"\xa1",DOUBLE_LEFT:"\xab",DOUBLE_RIGHT:"\xbb",LIGHT_SHADED_BOX:"\u2591",MEDIUM_SHADED_BOX:"\u2592",DARK_SHADED_BOX:"\u2593",VERTICAL_LINE:"\u2502",MAZE__SINGLE_RIGHT_T:"\u2524",MAZE_SINGLE_RIGHT_TOP:"\u2510",MAZE_SINGLE_RIGHT_BOTTOM_SMALL:"\u2518",MAZE_SINGLE_LEFT_TOP_SMALL:"\u250c",MAZE_SINGLE_LEFT_BOTTOM_SMALL:"\u2514",MAZE_SINGLE_LEFT_T:"\u251c",MAZE_SINGLE_BOTTOM_T:"\u2534",MAZE_SINGLE_TOP_T:"\u252c",MAZE_SINGLE_CENTER:"\u253c",MAZE_SINGLE_HORIZONTAL_LINE:"\u2500",MAZE_SINGLE_RIGHT_DOUBLECENTER_T:"\u2561",MAZE_SINGLE_RIGHT_DOUBLE_BL:"\u255b",MAZE_SINGLE_RIGHT_DOUBLE_T:"\u2562",MAZE_SINGLE_RIGHT_DOUBLEBOTTOM_TOP:"\u2556",MAZE_SINGLE_RIGHT_DOUBLELEFT_TOP:"\u2555",MAZE_SINGLE_LEFT_DOUBLE_T:"\u255e",MAZE_SINGLE_BOTTOM_DOUBLE_T:"\u2567",MAZE_SINGLE_TOP_DOUBLE_T:"\u2564",MAZE_SINGLE_TOP_DOUBLECENTER_T:"\u2565",MAZE_SINGLE_BOTTOM_DOUBLECENTER_T:"\u2568",MAZE_SINGLE_LEFT_DOUBLERIGHT_BOTTOM:"\u2558",MAZE_SINGLE_LEFT_DOUBLERIGHT_TOP:"\u2552",MAZE_SINGLE_LEFT_DOUBLEBOTTOM_TOP:"\u2553",MAZE_SINGLE_LEFT_DOUBLETOP_BOTTOM:"\u2559",MAZE_SINGLE_LEFT_TOP:"\u0393",MAZE_SINGLE_RIGHT_BOTTOM:"\u255c",MAZE_SINGLE_LEFT_CENTER:"\u255f",MAZE_SINGLE_DOUBLECENTER_CENTER:"\u256b",MAZE_SINGLE_DOUBLECROSS_CENTER:"\u256a",MAZE_DOUBLE_LEFT_CENTER:"\u2563",MAZE_DOUBLE_VERTICAL:"\u2551",MAZE_DOUBLE_RIGHT_TOP:"\u2557",MAZE_DOUBLE_RIGHT_BOTTOM:"\u255d",MAZE_DOUBLE_LEFT_BOTTOM:"\u255a",MAZE_DOUBLE_LEFT_TOP:"\u2554",MAZE_DOUBLE_BOTTOM_T:"\u2569",MAZE_DOUBLE_TOP_T:"\u2566",MAZE_DOUBLE_LEFT_T:"\u2560",MAZE_DOUBLE_HORIZONTAL:"\u2550",MAZE_DOUBLE_CROSS:"\u256c",SOLID_RECTANGLE:"\u2588",THICK_LEFT_VERTICAL:"\u258c",THICK_RIGHT_VERTICAL:"\u2590",SOLID_SMALL_RECTANGLE_BOTTOM:"\u2584",SOLID_SMALL_RECTANGLE_TOP:"\u2580",PHI_UPPER:"\u03a6",INFINITY:"\u221e",INTERSECTION:"\u2229",DEFINITION:"\u2261",PLUS_MINUS:"\xb1",GT_EQ:"\u2265",LT_EQ:"\u2264",THEREFORE:"\u2320",SINCE:"\u2235",DOESNOT_EXIST:"\u2204",EXISTS:"\u2203",FOR_ALL:"\u2200",EXCLUSIVE_OR:"\u2295",BECAUSE:"\u2321",DIVIDE:"\xf7",APPROX:"\u2248",DEGREE:"\xb0",BOLD_DOT:"\u2219",DOT_SMALL:"\xb7",CHECK:"\u221a",ITALIC_X:"\u2717",SUPER_N:"\u207f",SQUARED:"\xb2",CUBED:"\xb3",SOLID_BOX:"\u25a0",PERMILE:"\u2030",REGISTERED_TM:"\xae",COPYRIGHT:"\xa9",TRADEMARK:"\u2122",BETA:"\u03b2",GAMMA:"\u03b3",ZETA:"\u03b6",ETA:"\u03b7",IOTA:"\u03b9",KAPPA:"\u03ba",LAMBDA:"\u03bb",NU:"\u03bd",XI:"\u03be",OMICRON:"\u03bf",RHO:"\u03c1",UPSILON:"\u03c5",CHI_LOWER:"\u03c6",CHI_UPPER:"\u03c7",PSI:"\u03c8",ALPHA:"\u03b1",ESZETT:"\xdf",PI:"\u03c0",SIGMA_UPPER:"\u03a3",SIGMA_LOWER:"\u03c3",MU:"\xb5",TAU:"\u03c4",THETA:"\u0398",OMEGA:"\u03a9",DELTA:"\u03b4",PHI_LOWER:"\u03c6",EPSILON:"\u03b5"}})}void 0!==n?void 0!==e&&e.exports&&(e.exports=r(t("extended"),t("is-extended"),t("date-extended"),t("array-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended","date-extended","array-extended"],function(t,e,n,i){return r(t,e,n,i)}):this.stringExtended=r(this.extended,this.isExtended,this.dateExtended,this.arrayExtended)}).call(this)},{"array-extended":52,"date-extended":53,extended:56,"is-extended":66}]},{},[1]),"function"!=typeof JSON.decycle&&(JSON.decycle=function(t,e){"use strict";var n=new WeakMap;return function t(r,i){var o,s;return void 0!==e&&(r=e(r)),"object"!=typeof r||null===r||r instanceof Boolean||r instanceof Date||r instanceof Number||r instanceof RegExp||r instanceof String?r:void 0!==(o=n.get(r))?{$ref:o}:(n.set(r,i),Array.isArray(r)?(s=[],r.forEach(function(e,n){s[n]=t(e,i+"["+n+"]")})):(s={},Object.keys(r).forEach(function(e){s[e]=t(r[e],i+"["+JSON.stringify(e)+"]")})),s)}(t,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){"use strict";var px=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\(?:[\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*")\])*$/;return function rez(value){value&&"object"==typeof value&&(Array.isArray(value)?value.forEach(function(element,i){if("object"==typeof element&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}}):Object.keys(value).forEach(function(name){var item=value[name];if("object"==typeof item&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}}))}($),$});